{"ast":null,"code":"\"use strict\";\n\nvar _Reflect$construct = require(\"@babel/runtime-corejs2/core-js/reflect/construct\");\n\nvar _Object$defineProperty = require(\"@babel/runtime-corejs2/core-js/object/define-property\");\n\nvar _interopRequireDefault = require(\"@babel/runtime-corejs2/helpers/interopRequireDefault\");\n\n_Object$defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nexports.default = void 0;\n\nvar _defineProperties = _interopRequireDefault(require(\"@babel/runtime-corejs2/core-js/object/define-properties\"));\n\nvar _promise = _interopRequireDefault(require(\"@babel/runtime-corejs2/core-js/promise\"));\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime-corejs2/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime-corejs2/helpers/createClass\"));\n\nvar _assertThisInitialized2 = _interopRequireDefault(require(\"@babel/runtime-corejs2/helpers/assertThisInitialized\"));\n\nvar _inherits2 = _interopRequireDefault(require(\"@babel/runtime-corejs2/helpers/inherits\"));\n\nvar _possibleConstructorReturn2 = _interopRequireDefault(require(\"@babel/runtime-corejs2/helpers/possibleConstructorReturn\"));\n\nvar _getPrototypeOf2 = _interopRequireDefault(require(\"@babel/runtime-corejs2/helpers/getPrototypeOf\"));\n\nvar _httpError = _interopRequireDefault(require(\"../http-error\"));\n\nvar _interceptor = _interopRequireDefault(require(\"../lib/interceptor\"));\n\nfunction _createSuper(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct();\n\n  return function _createSuperInternal() {\n    var Super = (0, _getPrototypeOf2.default)(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = (0, _getPrototypeOf2.default)(this).constructor;\n      result = _Reflect$construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return (0, _possibleConstructorReturn2.default)(this, result);\n  };\n}\n\nfunction _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !_Reflect$construct) return false;\n  if (_Reflect$construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Boolean.prototype.valueOf.call(_Reflect$construct(Boolean, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nvar LOCUS_REDIRECT_ERROR = 2000002;\n/**\n * @class\n */\n\nvar HttpStatusInterceptor = /*#__PURE__*/function (_Interceptor) {\n  (0, _inherits2.default)(HttpStatusInterceptor, _Interceptor);\n\n  var _super = _createSuper(HttpStatusInterceptor);\n  /**\n   * @param {Object} webex\n   * @param {Object} options\n   * @returns {HttpStatusInterceptor}\n   */\n\n\n  function HttpStatusInterceptor(webex, options) {\n    var _this;\n\n    (0, _classCallCheck2.default)(this, HttpStatusInterceptor);\n    _this = _super.call(this, webex);\n    var ErrorConstructor = options && (options.error || options.ErrorConstructor) || _httpError.default;\n    (0, _defineProperties.default)((0, _assertThisInitialized2.default)(_this), {\n      ErrorConstructor: {\n        value: ErrorConstructor\n      }\n    });\n    return _this;\n  }\n  /**\n   * @param {Object} options\n   * @returns {HttpStatusInterceptor}\n   */\n\n\n  (0, _createClass2.default)(HttpStatusInterceptor, [{\n    key: \"onResponse\",\n    value:\n    /**\n     * @param {Object} options\n     * @param {HttpResponse} response\n     * @returns {Promise}\n     */\n    function onResponse(options, response) {\n      if (response.statusCode) {\n        if (response.statusCode < 400) {\n          return _promise.default.resolve(response);\n        } // to handle locus redirects\n\n\n        if (response.statusCode === 404 && response.body && response.body.errorCode === LOCUS_REDIRECT_ERROR) {\n          return _promise.default.resolve(response);\n        }\n      } // Note: the extra parenthesis below are required to make sure `new` is\n      // applied to the correct method (i.e., the result of `select()`, not\n      // `select()` itself).\n\n\n      return _promise.default.reject(new (this.ErrorConstructor.select(response.statusCode))(response));\n    }\n  }], [{\n    key: \"create\",\n    value: function create(options) {\n      return new HttpStatusInterceptor(this, options);\n    }\n  }]);\n  return HttpStatusInterceptor;\n}(_interceptor.default);\n\nexports.default = HttpStatusInterceptor;","map":{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAIA;;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAEA,IAAMA,oBAAoB,GAAG,OAA7B;AAEA;AACA;AACA;;IACqBC,qB;;;;AACnB;AACF;AACA;AACA;AACA;;;AACE,iCAAYC,KAAZ,EAAmBC,OAAnB,EAA4B;AAAA;;AAAA;AAC1BC,8BAAMF,KAAN;AACA,QAAMG,gBAAgB,GAAGF,OAAO,KAAKA,OAAO,CAACG,KAARH,IAAiBA,OAAO,CAACE,gBAA9B,CAAPF,IAA0DI,kBAAnF;AAEA,gFAA8B;AAC5BF,sBAAgB,EAAE;AAChBG,aAAK,EAAEH;AADS;AADU,KAA9B;AAJ0B;AAS3B;AAED;AACF;AACA;AACA;;;;;;AAKE;AACF;AACA;AACA;AACA;AACE,wBAAWF,OAAX,EAAoBM,QAApB,EAA8B;AAC5B,UAAIA,QAAQ,CAACC,UAAb,EAAyB;AACvB,YAAID,QAAQ,CAACC,UAATD,GAAsB,GAA1B,EAA+B;AAC7B,iBAAOE,iBAAQC,OAAR,CAAgBH,QAAhB,CAAP;AAFqB,UAIvB;;;AACA,YAAIA,QAAQ,CAACC,UAATD,KAAwB,GAAxBA,IACFA,QAAQ,CAACI,IADPJ,IAEFA,QAAQ,CAACI,IAATJ,CAAcK,SAAdL,KAA4BT,oBAF9B,EAEoD;AAClD,iBAAOW,iBAAQC,OAAR,CAAgBH,QAAhB,CAAP;AACD;AAVyB,QAa5B;AACA;AACA;;;AACA,aAAOE,iBAAQI,MAAR,CAAe,KAAK,KAAKV,gBAAL,CAAsBW,MAAtB,CAA6BP,QAAQ,CAACC,UAAtC,CAAL,EAAwDD,QAAxD,CAAf,CAAP;AACD;;;WA1BD,gBAAcN,OAAd,EAAuB;AACrB,aAAO,IAAIF,qBAAJ,CAA0B,IAA1B,EAAgCE,OAAhC,CAAP;AACD;;;EAvBgDc,oB","names":["LOCUS_REDIRECT_ERROR","HttpStatusInterceptor","webex","options","_this","ErrorConstructor","error","HttpError","value","response","statusCode","_promise","resolve","body","errorCode","reject","select","Interceptor"],"sources":["http-status.js"],"sourcesContent":["/*!\n * Copyright (c) 2015-2020 Cisco Systems, Inc. See LICENSE file.\n */\n\nimport HttpError from '../http-error';\nimport Interceptor from '../lib/interceptor';\n\nconst LOCUS_REDIRECT_ERROR = 2000002;\n\n/**\n * @class\n */\nexport default class HttpStatusInterceptor extends Interceptor {\n  /**\n   * @param {Object} webex\n   * @param {Object} options\n   * @returns {HttpStatusInterceptor}\n   */\n  constructor(webex, options) {\n    super(webex);\n    const ErrorConstructor = options && (options.error || options.ErrorConstructor) || HttpError;\n\n    Object.defineProperties(this, {\n      ErrorConstructor: {\n        value: ErrorConstructor\n      }\n    });\n  }\n\n  /**\n   * @param {Object} options\n   * @returns {HttpStatusInterceptor}\n   */\n  static create(options) {\n    return new HttpStatusInterceptor(this, options);\n  }\n\n  /**\n   * @param {Object} options\n   * @param {HttpResponse} response\n   * @returns {Promise}\n   */\n  onResponse(options, response) {\n    if (response.statusCode) {\n      if (response.statusCode < 400) {\n        return Promise.resolve(response);\n      }\n      // to handle locus redirects\n      if (response.statusCode === 404 &&\n        response.body &&\n        response.body.errorCode === LOCUS_REDIRECT_ERROR) {\n        return Promise.resolve(response);\n      }\n    }\n\n    // Note: the extra parenthesis below are required to make sure `new` is\n    // applied to the correct method (i.e., the result of `select()`, not\n    // `select()` itself).\n    return Promise.reject(new (this.ErrorConstructor.select(response.statusCode))(response));\n  }\n}\n"]},"metadata":{},"sourceType":"script"}