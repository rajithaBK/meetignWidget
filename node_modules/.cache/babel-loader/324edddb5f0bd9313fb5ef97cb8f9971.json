{"ast":null,"code":"\"use strict\";\n\nvar _Object$defineProperty = require(\"@babel/runtime-corejs2/core-js/object/define-property\");\n\nvar _interopRequireDefault = require(\"@babel/runtime-corejs2/helpers/interopRequireDefault\");\n\n_Object$defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nexports.default = whileInFlight;\n\nvar _promise = _interopRequireDefault(require(\"@babel/runtime-corejs2/core-js/promise\"));\n\nvar _apply = _interopRequireDefault(require(\"@babel/runtime-corejs2/core-js/reflect/apply\"));\n\nvar _wrap2 = _interopRequireDefault(require(\"lodash/wrap\"));\n\nvar _tap = _interopRequireDefault(require(\"./tap\"));\n/**\n * While the promise returned by the decorated is unfullfilled, sets, the\n * specified boolean on the target class to `true`\n * @param {string} param\n * @returns {Function}\n */\n\n\nfunction whileInFlight(param) {\n  return function whileInFlightDecorator(target, name, descriptor) {\n    descriptor.value = (0, _wrap2.default)(descriptor.value, function whileInFlightExecutor(fn) {\n      var _this = this;\n\n      for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n        args[_key - 1] = arguments[_key];\n      }\n\n      return new _promise.default(function (resolve) {\n        _this[param] = true;\n        resolve((0, _apply.default)(fn, _this, args).then((0, _tap.default)(function () {\n          _this[param] = false;\n        })).catch(function (reason) {\n          _this[param] = false;\n          return _promise.default.reject(reason);\n        }));\n      });\n    });\n  };\n}","map":{"version":3,"mappings":";;;;;;;;;;;;;;;;;;AAQA;AAEA;AACA;AACA;AACA;AACA;AACA;;;AACe,SAASA,aAAT,CAAuBC,KAAvB,EAA8B;AAC3C,SAAO,SAASC,sBAAT,CAAgCC,MAAhC,EAAwCC,IAAxC,EAA8CC,UAA9C,EAA0D;AAC/DA,cAAU,CAACC,KAAXD,GAAmB,oBAAKA,UAAU,CAACC,KAAhB,EAAuB,SAASC,qBAAT,CAA+BC,EAA/B,EAA4C;AAAA;;AAAA,wCAANC,IAAM;AAANA,YAAM,UAANA,GAAMC,eAAND;AAAM;;AACpF,aAAO,qBAAY,UAACE,OAAD,EAAa;AAC9BC,aAAI,CAACX,KAAD,CAAJ,GAAc,IAAd;AACAU,eAAO,CAAC,oBAAcH,EAAd,EAAkBI,KAAlB,EAAwBH,IAAxB,EACLI,IADK,CACA,kBAAI,YAAM;AACdD,eAAI,CAACX,KAAD,CAAJ,GAAc,KAAd;AADI,UADA,EAILa,KAJK,CAIC,UAACC,MAAD,EAAY;AACjBH,eAAI,CAACX,KAAD,CAAJ,GAAc,KAAd;AAEA,iBAAOe,iBAAQC,MAAR,CAAeF,MAAf,CAAP;AAPI,UAAD,CAAPJ;AAFK,QAAP;AADiB,MAAnBN;AADF;AAgBD","names":["whileInFlight","param","whileInFlightDecorator","target","name","descriptor","value","whileInFlightExecutor","fn","args","arguments","resolve","_this","then","catch","reason","_promise","reject"],"sources":["while-in-flight.js"],"sourcesContent":["/*!\n * Copyright (c) 2015-2020 Cisco Systems, Inc. See LICENSE file.\n */\n\n/* eslint no-invalid-this: [0] */\n\nimport {wrap} from 'lodash';\n\nimport tap from './tap';\n\n/**\n * While the promise returned by the decorated is unfullfilled, sets, the\n * specified boolean on the target class to `true`\n * @param {string} param\n * @returns {Function}\n */\nexport default function whileInFlight(param) {\n  return function whileInFlightDecorator(target, name, descriptor) {\n    descriptor.value = wrap(descriptor.value, function whileInFlightExecutor(fn, ...args) {\n      return new Promise((resolve) => {\n        this[param] = true;\n        resolve(Reflect.apply(fn, this, args)\n          .then(tap(() => {\n            this[param] = false;\n          }))\n          .catch((reason) => {\n            this[param] = false;\n\n            return Promise.reject(reason);\n          }));\n      });\n    });\n  };\n}\n"]},"metadata":{},"sourceType":"script"}