{"ast":null,"code":"\"use strict\";\n\nvar _Object$defineProperty = require(\"@babel/runtime-corejs2/core-js/object/define-property\");\n\nvar _interopRequireDefault = require(\"@babel/runtime-corejs2/helpers/interopRequireDefault\");\n\n_Object$defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nexports.default = void 0;\n\nvar _promise = _interopRequireDefault(require(\"@babel/runtime-corejs2/core-js/promise\"));\n\nvar _keys = _interopRequireDefault(require(\"@babel/runtime-corejs2/core-js/object/keys\"));\n\nvar _webexCore = require(\"@webex/webex-core\");\n/*!\n * Copyright (c) 2015-2020 Cisco Systems, Inc. See LICENSE file.\n */\n\n/**\n * @class\n */\n\n\nvar AbstractUserUUIDRequestBatcher = _webexCore.Batcher.extend({\n  namespace: 'User',\n\n  /**\n   * @param {string} item\n   * @returns {Promise<Object>}\n   */\n  prepareItem: function prepareItem(item) {\n    return _promise.default.resolve({\n      email: item\n    });\n  },\n\n  /**\n   * @param {HttpResponseObject} res\n   * @returns {Promise}\n   */\n  handleHttpSuccess: function handleHttpSuccess(res) {\n    var _this = this;\n\n    return _promise.default.all((0, _keys.default)(res.body).map(function (email) {\n      if (res.body[email] && res.body[email].id) {\n        return _this.handleItemSuccess(email, res.body[email]);\n      }\n\n      return _this.handleItemFailure(email, res.body[email]);\n    }));\n  },\n  handleItemFailure: function handleItemFailure(email, response) {\n    return this.getDeferredForResponse(email).then(function (defer) {\n      defer.reject(response);\n    });\n  },\n\n  /**\n   * @param {string} email\n   * @param {Object} response\n   * @returns {Promise}\n   */\n  handleItemSuccess: function handleItemSuccess(email, response) {\n    return this.getDeferredForResponse(email).then(function (defer) {\n      defer.resolve(response);\n    });\n  },\n\n  /**\n   * @param {string} email\n   * @returns {Promise<string>}\n   */\n  fingerprintRequest: function fingerprintRequest(email) {\n    return _promise.default.resolve(email.email || email);\n  },\n\n  /**\n   * @param {string} email\n   * @returns {Promise<string>}\n   */\n  fingerprintResponse: function fingerprintResponse(email) {\n    return _promise.default.resolve(email);\n  }\n});\n/**\n * @class\n */\n\n\nvar FakeUserUUIDRequestBatcher = AbstractUserUUIDRequestBatcher.extend({\n  /**\n   * @param {Object} payload\n   * @returns {Promise<HttpResponseObject>}\n   */\n  submitHttpRequest: function submitHttpRequest(payload) {\n    return this.webex.request({\n      method: 'POST',\n      service: 'conversation',\n      resource: '/users',\n      body: payload\n    });\n  }\n});\n/**\n * @class\n */\n\nvar RealUserUUIDRequestBatcher = AbstractUserUUIDRequestBatcher.extend({\n  /**\n   * @param {Object} payload\n   * @returns {Promise<HttpResponseObject>}\n   */\n  submitHttpRequest: function submitHttpRequest(payload) {\n    return this.webex.request({\n      method: 'POST',\n      service: 'conversation',\n      resource: '/users',\n      body: payload,\n      qs: {\n        shouldCreateUsers: true\n      }\n    });\n  }\n});\n/**\n * @class\n */\n\nvar UserUUIDBatcher = _webexCore.WebexPlugin.extend({\n  children: {\n    faker: FakeUserUUIDRequestBatcher,\n    creator: RealUserUUIDRequestBatcher\n  },\n\n  /**\n   * @param {Object} payload\n   * @returns {Promise<Object>}\n   */\n  request: function request(payload) {\n    return payload.create ? this.creator.request(payload.email) : this.faker.request(payload.email);\n  },\n  version: \"1.154.2\"\n});\n\nvar _default = UserUUIDBatcher;\nexports.default = _default;","map":{"version":3,"mappings":"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","names":["AbstractUserUUIDRequestBatcher","Batcher","extend","namespace","prepareItem","item","_promise","resolve","email","handleHttpSuccess","res","all","body","map","id","_this","handleItemSuccess","handleItemFailure","response","getDeferredForResponse","then","defer","reject","fingerprintRequest","fingerprintResponse","FakeUserUUIDRequestBatcher","submitHttpRequest","payload","webex","request","method","service","resource","RealUserUUIDRequestBatcher","qs","shouldCreateUsers","UserUUIDBatcher","WebexPlugin","children","faker","creator","create","version"],"sources":["user-uuid-batcher.js"],"sourcesContent":["/*!\n * Copyright (c) 2015-2020 Cisco Systems, Inc. See LICENSE file.\n */\n\nimport {Batcher, WebexPlugin} from '@webex/webex-core';\n\n/**\n * @class\n */\nconst AbstractUserUUIDRequestBatcher = Batcher.extend({\n  namespace: 'User',\n\n  /**\n   * @param {string} item\n   * @returns {Promise<Object>}\n   */\n  prepareItem(item) {\n    return Promise.resolve({email: item});\n  },\n\n  /**\n   * @param {HttpResponseObject} res\n   * @returns {Promise}\n   */\n  handleHttpSuccess(res) {\n    return Promise.all(Object.keys(res.body).map((email) => {\n      if (res.body[email] && res.body[email].id) {\n        return this.handleItemSuccess(email, res.body[email]);\n      }\n\n      return this.handleItemFailure(email, res.body[email]);\n    }));\n  },\n\n  handleItemFailure(email, response) {\n    return this.getDeferredForResponse(email)\n      .then((defer) => {\n        defer.reject(response);\n      });\n  },\n\n  /**\n   * @param {string} email\n   * @param {Object} response\n   * @returns {Promise}\n   */\n  handleItemSuccess(email, response) {\n    return this.getDeferredForResponse(email)\n      .then((defer) => {\n        defer.resolve(response);\n      });\n  },\n\n  /**\n   * @param {string} email\n   * @returns {Promise<string>}\n   */\n  fingerprintRequest(email) {\n    return Promise.resolve(email.email || email);\n  },\n\n  /**\n   * @param {string} email\n   * @returns {Promise<string>}\n   */\n  fingerprintResponse(email) {\n    return Promise.resolve(email);\n  }\n});\n\n/**\n * @class\n */\nconst FakeUserUUIDRequestBatcher = AbstractUserUUIDRequestBatcher.extend({\n  /**\n   * @param {Object} payload\n   * @returns {Promise<HttpResponseObject>}\n   */\n  submitHttpRequest(payload) {\n    return this.webex.request({\n      method: 'POST',\n      service: 'conversation',\n      resource: '/users',\n      body: payload\n    });\n  }\n});\n\n/**\n * @class\n */\nconst RealUserUUIDRequestBatcher = AbstractUserUUIDRequestBatcher.extend({\n  /**\n   * @param {Object} payload\n   * @returns {Promise<HttpResponseObject>}\n   */\n  submitHttpRequest(payload) {\n    return this.webex.request({\n      method: 'POST',\n      service: 'conversation',\n      resource: '/users',\n      body: payload,\n      qs: {\n        shouldCreateUsers: true\n      }\n    });\n  }\n});\n\n/**\n * @class\n */\nconst UserUUIDBatcher = WebexPlugin.extend({\n  children: {\n    faker: FakeUserUUIDRequestBatcher,\n    creator: RealUserUUIDRequestBatcher\n  },\n\n  /**\n   * @param {Object} payload\n   * @returns {Promise<Object>}\n   */\n  request(payload) {\n    return payload.create ? this.creator.request(payload.email) : this.faker.request(payload.email);\n  }\n});\n\nexport default UserUUIDBatcher;\n"]},"metadata":{},"sourceType":"script"}