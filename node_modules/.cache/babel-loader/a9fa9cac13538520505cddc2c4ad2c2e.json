{"ast":null,"code":"\"use strict\";\n\nvar _Reflect$construct = require(\"@babel/runtime-corejs2/core-js/reflect/construct\");\n\nvar _Object$defineProperty = require(\"@babel/runtime-corejs2/core-js/object/define-property\");\n\nvar _interopRequireDefault = require(\"@babel/runtime-corejs2/helpers/interopRequireDefault\");\n\n_Object$defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nexports.DryError = exports.KmsTimeoutError = exports.KmsError = void 0;\n\nvar _defineProperties = _interopRequireDefault(require(\"@babel/runtime-corejs2/core-js/object/define-properties\"));\n\nvar _apply = _interopRequireDefault(require(\"@babel/runtime-corejs2/core-js/reflect/apply\"));\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime-corejs2/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime-corejs2/helpers/createClass\"));\n\nvar _inherits2 = _interopRequireDefault(require(\"@babel/runtime-corejs2/helpers/inherits\"));\n\nvar _possibleConstructorReturn2 = _interopRequireDefault(require(\"@babel/runtime-corejs2/helpers/possibleConstructorReturn\"));\n\nvar _getPrototypeOf2 = _interopRequireDefault(require(\"@babel/runtime-corejs2/helpers/getPrototypeOf\"));\n\nvar _defineProperty2 = _interopRequireDefault(require(\"@babel/runtime-corejs2/helpers/defineProperty\"));\n\nvar _common = require(\"@webex/common\");\n\nvar _webexCore = require(\"@webex/webex-core\");\n\nfunction _createSuper(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct();\n\n  return function _createSuperInternal() {\n    var Super = (0, _getPrototypeOf2.default)(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = (0, _getPrototypeOf2.default)(this).constructor;\n      result = _Reflect$construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return (0, _possibleConstructorReturn2.default)(this, result);\n  };\n}\n\nfunction _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !_Reflect$construct) return false;\n  if (_Reflect$construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Boolean.prototype.valueOf.call(_Reflect$construct(Boolean, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n/**\n * Error class for KMS errors\n */\n\n\nvar KmsError = /*#__PURE__*/function (_Exception) {\n  (0, _inherits2.default)(KmsError, _Exception);\n\n  var _super = _createSuper(KmsError);\n\n  function KmsError() {\n    (0, _classCallCheck2.default)(this, KmsError);\n    return _super.apply(this, arguments);\n  }\n\n  (0, _createClass2.default)(KmsError, [{\n    key: \"parse\",\n    value:\n    /**\n     * @param {HttpResponse} body\n     * @returns {string}\n     */\n    function parse(body) {\n      body = body.body || body;\n      (0, _defineProperties.default)(this, {\n        body: {\n          enumerable: false,\n          value: body\n        },\n        reason: {\n          enumerable: false,\n          value: body.reason\n        },\n        requestId: {\n          enumerable: false,\n          value: body.requestId\n        },\n        status: {\n          enumerable: false,\n          value: body.status\n        }\n      });\n      var message = typeof body === 'string' ? body : body.reason;\n\n      if (!message) {\n        message = this.constructor.defaultMessage;\n      }\n\n      if (body.status) {\n        message += \"\\nKMS_RESPONSE_STATUS: \".concat(body.status);\n      }\n\n      if (body.requestId) {\n        message += \"\\nKMS_REQUEST_ID: \".concat(body.requestId);\n      }\n\n      return message;\n    }\n  }]);\n  return KmsError;\n}(_common.Exception);\n/**\n * Thrown when an expected KMSResponse is not received in a timely manner\n */\n\n\nexports.KmsError = KmsError;\n(0, _defineProperty2.default)(KmsError, \"defaultMessage\", 'An unknown error occurred while communicating with the kms. This implies we received an error response without a body.');\n\nvar KmsTimeoutError = /*#__PURE__*/function (_KmsError) {\n  (0, _inherits2.default)(KmsTimeoutError, _KmsError);\n\n  var _super2 = _createSuper(KmsTimeoutError);\n\n  function KmsTimeoutError() {\n    (0, _classCallCheck2.default)(this, KmsTimeoutError);\n    return _super2.apply(this, arguments);\n  }\n\n  (0, _createClass2.default)(KmsTimeoutError, [{\n    key: \"parse\",\n    value:\n    /**\n     * @param {KmsRequest} options.request\n     * @param {KmsRequest} options.timeout\n     * @returns {string}\n     */\n    function parse() {\n      var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n          _ref$request = _ref.request,\n          request = _ref$request === void 0 ? {} : _ref$request,\n          timeout = _ref.timeout;\n\n      var message = \"The KMS did not respond within \".concat(timeout ? \"\".concat(timeout, \" milliseconds\") : 'a timely fashion');\n\n      if (request) {\n        if (request.method && request.uri) {\n          message += \"\\nKMS_REQUEST: \".concat(request.method, \" \").concat(request.uri);\n        }\n\n        if (request.requestId) {\n          message += \"\\nKMS_REQUEST_ID: \".concat(request.requestId);\n        }\n      }\n\n      return message;\n    }\n  }]);\n  return KmsTimeoutError;\n}(KmsError);\n/**\n * Emitted when a REST request includes an encrypter error\n */\n\n\nexports.KmsTimeoutError = KmsTimeoutError;\n\nvar DryError = /*#__PURE__*/function (_WebexHttpError) {\n  (0, _inherits2.default)(DryError, _WebexHttpError);\n\n  var _super3 = _createSuper(DryError);\n\n  function DryError() {\n    (0, _classCallCheck2.default)(this, DryError);\n    return _super3.apply(this, arguments);\n  }\n\n  (0, _createClass2.default)(DryError, [{\n    key: \"parse\",\n    value:\n    /**\n     * @param {WebexHttpError} reason\n     * @returns {string}\n     */\n    function parse(reason) {\n      (0, _apply.default)(_webexCore.WebexHttpError.prototype.parse, this, [reason._res]);\n      var body = reason._res.body.message;\n      var message = body.reason || body;\n\n      if (!message) {\n        message = this.constructor.defaultMessage;\n      }\n\n      if (this.options.url) {\n        message += \"\\n\".concat(this.options.method, \" \").concat(this.options.url);\n      } else if (this.options.uri) {\n        message += \"\\n\".concat(this.options.method, \" \").concat(this.options.uri);\n      } else {\n        message += \"\\n\".concat(this.options.method, \" \").concat(this.options.service.toUpperCase(), \"/\").concat(this.options.resource);\n      }\n\n      message += \"\\nWEBEX_TRACKING_ID: \".concat(this.options.headers.trackingid);\n\n      if (body.status) {\n        message += \"\\nKMS_RESPONSE_STATUS: \".concat(body.status);\n      }\n\n      if (body.requestId) {\n        message += \"\\nKMS_REQUEST_ID: \".concat(body.requestId);\n      }\n\n      (0, _defineProperties.default)(this, {\n        reason: {\n          enumerable: false,\n          value: body.reason\n        },\n        requestId: {\n          enumerable: false,\n          value: body.requestId\n        },\n        status: {\n          enumerable: false,\n          value: body.status\n        }\n      });\n      return message;\n    }\n  }]);\n  return DryError;\n}(_webexCore.WebexHttpError);\n\nexports.DryError = DryError;\n(0, _defineProperty2.default)(DryError, \"defaultMessage\", 'An unknown error was received from a service that proxies to the KMS');","map":{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAIA;;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAEA;AACA;AACA;;;IACaA,Q;;;;;;;;;;;;;AAGX;AACF;AACA;AACA;AACE,mBAAMC,IAAN,EAAY;AACVA,UAAI,GAAGA,IAAI,CAACA,IAALA,IAAaA,IAApBA;AAEA,qCAAwB,IAAxB,EAA8B;AAC5BA,YAAI,EAAE;AACJC,oBAAU,EAAE,KADR;AAEJC,eAAK,EAAEF;AAFH,SADsB;AAK5BG,cAAM,EAAE;AACNF,oBAAU,EAAE,KADN;AAENC,eAAK,EAAEF,IAAI,CAACG;AAFN,SALoB;AAS5BC,iBAAS,EAAE;AACTH,oBAAU,EAAE,KADH;AAETC,eAAK,EAAEF,IAAI,CAACI;AAFH,SATiB;AAa5BC,cAAM,EAAE;AACNJ,oBAAU,EAAE,KADN;AAENC,eAAK,EAAEF,IAAI,CAACK;AAFN;AAboB,OAA9B;AAmBA,UAAIC,OAAO,GAAG,OAAON,IAAP,KAAgB,QAAhB,GAA2BA,IAA3B,GAAkCA,IAAI,CAACG,MAArD;;AAEA,UAAI,CAACG,OAAL,EAAc;AACZA,eAAO,GAAG,KAAKC,WAAL,CAAiBC,cAA3BF;AACD;;AACD,UAAIN,IAAI,CAACK,MAAT,EAAiB;AACfC,eAAO,qCAA8BN,IAAI,CAACK,MAAnC,CAAPC;AACD;;AACD,UAAIN,IAAI,CAACI,SAAT,EAAoB;AAClBE,eAAO,gCAAyBN,IAAI,CAACI,SAA9B,CAAPE;AACD;;AAED,aAAOA,OAAP;AACD;;;EA1C2BG,iB;AA6C9B;AACA;AACA;;;;8BA/CaV,U,kBACa;;IA+CbW,e;;;;;;;;;;;;;AACX;AACF;AACA;AACA;AACA;AACE,qBAAoC;AAAA,qFAAJ,EAAI;AAAA,8BAA7BC,OAA6B;AAAA,UAA7BA,OAA6B,6BAAnB,EAAmB;AAAA,UAAfC,OAAe,QAAfA,OAAe;;AAClC,UAAIN,OAAO,4CAAqCM,OAAO,aAAMA,OAAN,qBAA+B,kBAA3E,CAAX;;AAEA,UAAID,OAAJ,EAAa;AACX,YAAIA,OAAO,CAACE,MAARF,IAAkBA,OAAO,CAACG,GAA9B,EAAmC;AACjCR,iBAAO,6BAAsBK,OAAO,CAACE,MAA9B,cAAwCF,OAAO,CAACG,GAAhD,CAAPR;AACD;;AAED,YAAIK,OAAO,CAACP,SAAZ,EAAuB;AACrBE,iBAAO,gCAAyBK,OAAO,CAACP,SAAjC,CAAPE;AACD;AACF;;AAED,aAAOA,OAAP;AACD;;;EApBkCP,Q;AAuBrC;AACA;AACA;;;;;IACagB,Q;;;;;;;;;;;;;AAGX;AACF;AACA;AACA;AACE,mBAAMZ,MAAN,EAAc;AACZ,0BAAca,0BAAeC,SAAfD,CAAyBE,KAAvC,EAA8C,IAA9C,EAAoD,CAACf,MAAM,CAACgB,IAAR,CAApD;AACA,UAAMnB,IAAI,GAAGG,MAAM,CAACgB,IAAPhB,CAAYH,IAAZG,CAAiBG,OAA9B;AAEA,UAAIA,OAAO,GAAGN,IAAI,CAACG,MAALH,IAAeA,IAA7B;;AAEA,UAAI,CAACM,OAAL,EAAc;AACZA,eAAO,GAAG,KAAKC,WAAL,CAAiBC,cAA3BF;AACD;;AACD,UAAI,KAAKc,OAAL,CAAaC,GAAjB,EAAsB;AACpBf,eAAO,gBAAS,KAAKc,OAAL,CAAaP,MAAtB,cAAgC,KAAKO,OAAL,CAAaC,GAA7C,CAAPf;AADF,aAGK,IAAI,KAAKc,OAAL,CAAaN,GAAjB,EAAsB;AACzBR,eAAO,gBAAS,KAAKc,OAAL,CAAaP,MAAtB,cAAgC,KAAKO,OAAL,CAAaN,GAA7C,CAAPR;AADG,aAGA;AACHA,eAAO,gBAAS,KAAKc,OAAL,CAAaP,MAAtB,cAAgC,KAAKO,OAAL,CAAaE,OAAb,CAAqBC,WAArB,EAAhC,cAAsE,KAAKH,OAAL,CAAaI,QAAnF,CAAPlB;AACD;;AACDA,aAAO,mCAA4B,KAAKc,OAAL,CAAaK,OAAb,CAAqBC,UAAjD,CAAPpB;;AAEA,UAAIN,IAAI,CAACK,MAAT,EAAiB;AACfC,eAAO,qCAA8BN,IAAI,CAACK,MAAnC,CAAPC;AACD;;AACD,UAAIN,IAAI,CAACI,SAAT,EAAoB;AAClBE,eAAO,gCAAyBN,IAAI,CAACI,SAA9B,CAAPE;AACD;;AAED,qCAAwB,IAAxB,EAA8B;AAC5BH,cAAM,EAAE;AACNF,oBAAU,EAAE,KADN;AAENC,eAAK,EAAEF,IAAI,CAACG;AAFN,SADoB;AAK5BC,iBAAS,EAAE;AACTH,oBAAU,EAAE,KADH;AAETC,eAAK,EAAEF,IAAI,CAACI;AAFH,SALiB;AAS5BC,cAAM,EAAE;AACNJ,oBAAU,EAAE,KADN;AAENC,eAAK,EAAEF,IAAI,CAACK;AAFN;AAToB,OAA9B;AAeA,aAAOC,OAAP;AACD;;;EAlD2BU,yB;;;8BAAjBD,U,kBACa","names":["KmsError","body","enumerable","value","reason","requestId","status","message","constructor","defaultMessage","Exception","KmsTimeoutError","request","timeout","method","uri","DryError","WebexHttpError","prototype","parse","_res","options","url","service","toUpperCase","resource","headers","trackingid"],"sources":["kms-errors.js"],"sourcesContent":["/*!\n * Copyright (c) 2015-2020 Cisco Systems, Inc. See LICENSE file.\n */\n\nimport {Exception} from '@webex/common';\nimport {WebexHttpError} from '@webex/webex-core';\n\n/**\n * Error class for KMS errors\n */\nexport class KmsError extends Exception {\n  static defaultMessage = 'An unknown error occurred while communicating with the kms. This implies we received an error response without a body.';\n\n  /**\n   * @param {HttpResponse} body\n   * @returns {string}\n   */\n  parse(body) {\n    body = body.body || body;\n\n    Object.defineProperties(this, {\n      body: {\n        enumerable: false,\n        value: body\n      },\n      reason: {\n        enumerable: false,\n        value: body.reason\n      },\n      requestId: {\n        enumerable: false,\n        value: body.requestId\n      },\n      status: {\n        enumerable: false,\n        value: body.status\n      }\n    });\n\n    let message = typeof body === 'string' ? body : body.reason;\n\n    if (!message) {\n      message = this.constructor.defaultMessage;\n    }\n    if (body.status) {\n      message += `\\nKMS_RESPONSE_STATUS: ${body.status}`;\n    }\n    if (body.requestId) {\n      message += `\\nKMS_REQUEST_ID: ${body.requestId}`;\n    }\n\n    return message;\n  }\n}\n\n/**\n * Thrown when an expected KMSResponse is not received in a timely manner\n */\nexport class KmsTimeoutError extends KmsError {\n  /**\n   * @param {KmsRequest} options.request\n   * @param {KmsRequest} options.timeout\n   * @returns {string}\n   */\n  parse({request = {}, timeout} = {}) {\n    let message = `The KMS did not respond within ${timeout ? `${timeout} milliseconds` : 'a timely fashion'}`;\n\n    if (request) {\n      if (request.method && request.uri) {\n        message += `\\nKMS_REQUEST: ${request.method} ${request.uri}`;\n      }\n\n      if (request.requestId) {\n        message += `\\nKMS_REQUEST_ID: ${request.requestId}`;\n      }\n    }\n\n    return message;\n  }\n}\n\n/**\n * Emitted when a REST request includes an encrypter error\n */\nexport class DryError extends WebexHttpError {\n  static defaultMessage = 'An unknown error was received from a service that proxies to the KMS';\n\n  /**\n   * @param {WebexHttpError} reason\n   * @returns {string}\n   */\n  parse(reason) {\n    Reflect.apply(WebexHttpError.prototype.parse, this, [reason._res]);\n    const body = reason._res.body.message;\n\n    let message = body.reason || body;\n\n    if (!message) {\n      message = this.constructor.defaultMessage;\n    }\n    if (this.options.url) {\n      message += `\\n${this.options.method} ${this.options.url}`;\n    }\n    else if (this.options.uri) {\n      message += `\\n${this.options.method} ${this.options.uri}`;\n    }\n    else {\n      message += `\\n${this.options.method} ${this.options.service.toUpperCase()}/${this.options.resource}`;\n    }\n    message += `\\nWEBEX_TRACKING_ID: ${this.options.headers.trackingid}`;\n\n    if (body.status) {\n      message += `\\nKMS_RESPONSE_STATUS: ${body.status}`;\n    }\n    if (body.requestId) {\n      message += `\\nKMS_REQUEST_ID: ${body.requestId}`;\n    }\n\n    Object.defineProperties(this, {\n      reason: {\n        enumerable: false,\n        value: body.reason\n      },\n      requestId: {\n        enumerable: false,\n        value: body.requestId\n      },\n      status: {\n        enumerable: false,\n        value: body.status\n      }\n    });\n\n    return message;\n  }\n}\n"]},"metadata":{},"sourceType":"script"}