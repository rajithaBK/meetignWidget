{"version":3,"file":"webexSDKComponentAdapter.esm.js","sources":["../src/polyfills.js","../node_modules/@webex/component-adapter-interfaces/dist/webex-component-adapter-interfaces.es.min.js","../node_modules/rollup-plugin-node-globals/src/global.js","../node_modules/process-es6/browser.js","../src/utils.js","../src/logger.js","../src/ActivitiesSDKAdapter.js","../src/RoomsSDKAdapter.js","../src/PeopleSDKAdapter.js","../src/MeetingsSDKAdapter/controls/MeetingControl.js","../src/MeetingsSDKAdapter/controls/AudioControl.js","../src/MeetingsSDKAdapter/controls/ExitControl.js","../src/MeetingsSDKAdapter/controls/JoinControl.js","../src/MeetingsSDKAdapter/controls/RosterControl.js","../src/MeetingsSDKAdapter/controls/SettingsControl.js","../src/MeetingsSDKAdapter/controls/ShareControl.js","../src/MeetingsSDKAdapter/controls/SwitchCameraControl.js","../src/MeetingsSDKAdapter/controls/SwitchMicrophoneControl.js","../src/MeetingsSDKAdapter/controls/SwitchSpeakerControl.js","../src/MeetingsSDKAdapter/controls/VideoControl.js","../src/MeetingsSDKAdapter.js","../node_modules/core-js/library/modules/_global.js","../node_modules/core-js/library/modules/_core.js","../node_modules/core-js/library/modules/_a-function.js","../node_modules/core-js/library/modules/_ctx.js","../node_modules/core-js/library/modules/_is-object.js","../node_modules/core-js/library/modules/_an-object.js","../node_modules/core-js/library/modules/_fails.js","../node_modules/core-js/library/modules/_descriptors.js","../node_modules/core-js/library/modules/_dom-create.js","../node_modules/core-js/library/modules/_ie8-dom-define.js","../node_modules/core-js/library/modules/_to-primitive.js","../node_modules/core-js/library/modules/_object-dp.js","../node_modules/core-js/library/modules/_property-desc.js","../node_modules/core-js/library/modules/_hide.js","../node_modules/core-js/library/modules/_has.js","../node_modules/core-js/library/modules/_export.js","../node_modules/core-js/library/modules/es6.object.define-property.js","../node_modules/core-js/library/fn/object/define-property.js","../node_modules/@babel/runtime-corejs2/core-js/object/define-property.js","../node_modules/@webex/common/dist/constants.js","../src/MembershipsSDKAdapter.js","../src/OrganizationsSDKAdapter.js","../src/WebexSDKAdapter.js"],"sourcesContent":["// dummy implementation of getTracks() for non-supporting browsers,\n// to avoid checking for its existence before calling it\nif (!MediaStream.prototype.getTracks) {\n  MediaStream.prototype.getTracks = () => [];\n}\n","import{throwError as e}from\"rxjs\";class t{constructor(e){this.datasource=e}connect(){return Promise.reject(new Error(\"connect() must be defined in WebexAdapter\"))}disconnect(){return Promise.reject(new Error(\"disconnect() must be defined in WebexAdapter\"))}}class r extends t{getActivity(t){return e(new Error(\"getActivity(ID) must be defined in ActivitiesAdapter\"))}}const n={JOIN:\"JOIN\",CANCEL:\"CANCEL\",CLOSE:\"CLOSE\",TOGGLE:\"TOGGLE\",MULTISELECT:\"MULTISELECT\"},i={ACTIVE:\"active\",INACTIVE:\"inactive\",DISABLED:\"disabled\"},s={NOT_JOINED:\"NOT_JOINED\",LOBBY:\"LOBBY\",JOINED:\"JOINED\",LEFT:\"LEFT\"},o={ASKING:\"ASKING\",ALLOWED:\"ALLOWED\",DENIED:\"DENIED\",DISMISSED:\"DISMISSED\",ERROR:\"ERROR\",IGNORED:\"IGNORED\"};class d extends t{constructor(e){super(e),this.meetingControls={}}createMeeting(t){return e(new Error(\"createMeeting(destination) must be defined in MeetingsAdapter\"))}incomingMeeting(t){return e(new Error(\"incomingMeeting(destination) must be defined in MeetingsAdapter\"))}getMeeting(t){return e(new Error(\"getMeeting(ID) must be defined in MeetingsAdapter\"))}joinMeeting(e){throw new Error(\"joinMeeting(ID) must be defined in MeetingsAdapter\")}leaveMeeting(e){throw new Error(\"leaveMeeting(ID) must be defined in MeetingsAdapter\")}supportedControls(){return e(new Error(\"supportedControls() must be defined in MeetingsAdapter\"))}clearPasswordRequiredFlag(e){throw new Error(\"clearPasswordRequiredFlag(ID) must be defined in MeetingsAdapter\")}clearInvalidPasswordFlag(e){throw new Error(\"clearInvalidPasswordFlag(ID) must be defined in MeetingsAdapter\")}}const a={ROOM:\"room\",MEETING:\"meeting\"};class E extends t{getMembersFromDestination(t,r){return e(new Error(\"getMembersFromDestination(destinationID, destinationType) must be defined in MembershipsAdapter\"))}}class g extends t{getOrg(t){return e(new Error(\"getOrg(ID) must be defined in OrganizationsAdapter\"))}}const c={ACTIVE:\"active\",BOT:\"bot\",CALL:\"call\",DO_NOT_DISTURB:\"dnd\",INACTIVE:\"inactive\",MEETING:\"meeting\",OUT_OF_OFFICE:\"ooo\",PRESENTING:\"presenting\",SELF:\"self\",TYPING:\"typing\"};class I extends t{getMe(){return e(new Error(\"getMe() must be defined in PeopleAdapter\"))}getPerson(t){return e(new Error(\"getPerson(ID) must be defined in PeopleAdapter\"))}}const m={GROUP:\"group\",DIRECT:\"direct\"};class u extends t{getRoom(t){return e(new Error(\"getRoom(ID) must be defined in RoomsAdapter\"))}getRoomActivities(t){return e(new Error(\"getRoomActivities(ID) must be defined in RoomsAdapter\"))}getPreviousRoomActivities(t){return e(new Error(\"getPreviousRoomActivities(ID) must be defined in RoomsAdapter\"))}hasMoreActivities(e){throw new Error(\"hasMoreActivities(ID) must be defined in RoomsAdapter\")}}export{r as ActivitiesAdapter,a as DestinationType,o as MediaPermissions,i as MeetingControlState,n as MeetingControlType,s as MeetingState,d as MeetingsAdapter,E as MembershipsAdapter,g as OrganizationsAdapter,I as PeopleAdapter,c as PersonStatus,m as RoomType,u as RoomsAdapter,t as WebexAdapter};\n//# sourceMappingURL=webex-component-adapter-interfaces.es.min.js.map\n","export default (typeof global !== \"undefined\" ? global :\n            typeof self !== \"undefined\" ? self :\n            typeof window !== \"undefined\" ? window : {});\n","// shim for using process in browser\n// based off https://github.com/defunctzombie/node-process/blob/master/browser.js\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\nvar cachedSetTimeout = defaultSetTimout;\nvar cachedClearTimeout = defaultClearTimeout;\nif (typeof global.setTimeout === 'function') {\n    cachedSetTimeout = setTimeout;\n}\nif (typeof global.clearTimeout === 'function') {\n    cachedClearTimeout = clearTimeout;\n}\n\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\nexport function nextTick(fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n}\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nexport var title = 'browser';\nexport var platform = 'browser';\nexport var browser = true;\nexport var env = {};\nexport var argv = [];\nexport var version = ''; // empty string to avoid regexp issues\nexport var versions = {};\nexport var release = {};\nexport var config = {};\n\nfunction noop() {}\n\nexport var on = noop;\nexport var addListener = noop;\nexport var once = noop;\nexport var off = noop;\nexport var removeListener = noop;\nexport var removeAllListeners = noop;\nexport var emit = noop;\n\nexport function binding(name) {\n    throw new Error('process.binding is not supported');\n}\n\nexport function cwd () { return '/' }\nexport function chdir (dir) {\n    throw new Error('process.chdir is not supported');\n};\nexport function umask() { return 0; }\n\n// from https://github.com/kumavis/browser-process-hrtime/blob/master/index.js\nvar performance = global.performance || {}\nvar performanceNow =\n  performance.now        ||\n  performance.mozNow     ||\n  performance.msNow      ||\n  performance.oNow       ||\n  performance.webkitNow  ||\n  function(){ return (new Date()).getTime() }\n\n// generate timestamp or delta\n// see http://nodejs.org/api/process.html#process_process_hrtime\nexport function hrtime(previousTimestamp){\n  var clocktime = performanceNow.call(performance)*1e-3\n  var seconds = Math.floor(clocktime)\n  var nanoseconds = Math.floor((clocktime%1)*1e9)\n  if (previousTimestamp) {\n    seconds = seconds - previousTimestamp[0]\n    nanoseconds = nanoseconds - previousTimestamp[1]\n    if (nanoseconds<0) {\n      seconds--\n      nanoseconds += 1e9\n    }\n  }\n  return [seconds,nanoseconds]\n}\n\nvar startTime = new Date();\nexport function uptime() {\n  var currentTime = new Date();\n  var dif = currentTime - startTime;\n  return dif / 1000;\n}\n\nexport default {\n  nextTick: nextTick,\n  title: title,\n  browser: browser,\n  env: env,\n  argv: argv,\n  version: version,\n  versions: versions,\n  on: on,\n  addListener: addListener,\n  once: once,\n  off: off,\n  removeListener: removeListener,\n  removeAllListeners: removeAllListeners,\n  emit: emit,\n  binding: binding,\n  cwd: cwd,\n  chdir: chdir,\n  umask: umask,\n  hrtime: hrtime,\n  platform: platform,\n  release: release,\n  config: config,\n  uptime: uptime\n};\n","import {combineLatest, Observable} from 'rxjs';\nimport {startWith} from 'rxjs/operators';\n\n/**\n * Custom rxjs operator for chaining dependent observables.\n * Usage:\n ```js\n  obs.pipe(\n    chainWith((lastMessage) => createDependentObservable(lastMessage),\n  );\n  ```\n *\n * @param {function(lastMessage): Observable} createDependentObservable  Function that is passed the last message emitted by the source observable and returns a new observable\n * @returns {Observable} observable\n */\nexport function chainWith(createDependentObservable) {\n  return (source) => new Observable((subscriber) => {\n    let lastValue;\n    let subscription;\n\n    subscription = source.subscribe(\n      (value) => {\n        subscriber.next(value);\n        lastValue = value;\n      },\n      (error) => subscriber.error(error),\n      () => {\n        subscription = createDependentObservable(lastValue).subscribe(\n          (value) => subscriber.next(value),\n          (error) => subscriber.error(error),\n          () => subscriber.complete(),\n        );\n      },\n    );\n\n    return () => {\n      if (subscription) {\n        subscription.unsubscribe();\n      }\n    };\n  });\n}\n\n/**\n * Custom rxjs operator that works like combineLatest, but emits even if some of the source observables haven't emitted yet.\n * Usage:\n ```js\n  combineLatestImmediate(obs1, obs2, ...);\n  ```\n *\n * @param {ObservableInput} [observables] An array of input Observables to combine with each other.\n * @returns {Observable} Observable that emits arrays containing the last emitted value from each of the observables defined above.\n */\nexport function combineLatestImmediate(...observables) {\n  return combineLatest(observables.map((obs) => obs.pipe(startWith(undefined))));\n}\n\n/**\n * Helper function for deep merge on objects.\n *\n * @param {object} dest - The destination object.\n * @param {object} src - The source object.\n */\nexport function deepMerge(dest, src) {\n  const result = dest;\n\n  for (const [key, val] of Object.entries(src || {})) {\n    if (val && val.constructor === Object) {\n      deepMerge(result[key], val);\n    } else {\n      result[key] = val;\n    }\n  }\n}\n\n/**\n * Safe JSON stringifier that:\n * - replaces circular references with the text [circular-reference]\n * - catches any JSON.stringify error and returns [error-stringifying:<ERROR-MESSAGE>]\n *\n * @param {any} data  Data to be stringified\n * @param {function} [replacer]  JSON.stringify() replacer parameter\n * @param {string|number} [space]  JSON.stringify() space parameter\n * @returns {string} The string result\n */\nexport function safeJsonStringify(data, replacer, space) {\n  const seen = new WeakSet();\n  let str;\n\n  try {\n    str = JSON.stringify(data, (key, value) => {\n      let replaced = replacer ? replacer(key, value) : value;\n\n      if (typeof replaced === 'object' && replaced !== null) {\n        if (seen.has(replaced)) {\n          replaced = '[circular-reference]';\n        } else {\n          seen.add(replaced);\n        }\n      }\n\n      return replaced;\n    }, space);\n  } catch (error) {\n    str = `[error-stringifying:${error.message}]`;\n  }\n\n  return str;\n}\n\nexport default {\n  chainWith,\n  combineLatestImmediate,\n  deepMerge,\n  safeJsonStringify,\n};\n\n// Checks for the existence of setSinkId on a media element.\nexport const isSpeakerSupported = !!document.createElement('audio').setSinkId;\n","import {createLogger, format, transports} from 'winston';\nimport {safeJsonStringify} from './utils';\n\nconst logFormat = format.printf(({\n  timestamp, level, resourceType, resourceID, action, message, error,\n}) => {\n  let msgString = message;\n\n  if (Array.isArray(message)) {\n    msgString = message.map((item) => (\n      (typeof item === 'string' && item)\n      || safeJsonStringify(item, (key, value) => (\n        (value instanceof MediaStream && `MediaStream([${value.getTracks().map((track) => track.kind)}])`)\n        || value\n      ), 2)\n    )).join(' ');\n  }\n\n  return `${timestamp} ${level} ${resourceType} ${resourceID} ${action} ${msgString} ${error ? ` ${error.stack || error}` : ''}`;\n});\n\nconst activeTransports = [];\n\nif (process.env.NODE_ENV !== 'production') {\n  activeTransports.push(new transports.Console({\n    format: format.combine(\n      format.timestamp({format: 'YYYY-MM-DD HH:mm:ss'}),\n      format.colorize(),\n      format.simple(),\n      logFormat,\n    ),\n  }));\n}\n\nconst winstonLogger = createLogger({\n  level: 'error',\n  transports: activeTransports,\n});\n\n// create a custom logger and export it\nconst logger = {\n  setLevel: (level) => {\n    winstonLogger.level = level;\n  },\n};\n\nfor (const level of ['info', 'warn', 'error', 'debug']) {\n  logger[level] = (resourceType, resourceID, action, message, error) => (\n    winstonLogger[level]({\n      resourceType, resourceID, action, message, error,\n    })\n  );\n}\n\nif (typeof window !== 'undefined') {\n  window.webexSDKAdapterSetLogLevel = (level) => logger.setLevel(level);\n}\n\nexport default logger;\n","import {ActivitiesAdapter} from '@webex/component-adapter-interfaces';\nimport {\n  from,\n  Observable,\n  ReplaySubject,\n  defer,\n} from 'rxjs';\nimport {\n  catchError,\n  map,\n  tap,\n} from 'rxjs/operators';\n\nimport logger from './logger';\n\n/**\n * An activity a person performs in Webex.\n *\n * @external Activity\n * @see {@link https://github.com/webex/component-adapter-interfaces/blob/master/src/ActivitiesAdapter.js#L6}\n */\n\n/**\n * The `ActivitiesSDKAdapter` is an implementation of the `ActivitiesAdapter` interface.\n * This implementation utilizes the Webex JS SDK as its source of activity data.\n *\n * @see {@link ActivitiesJSON}\n * @implements {ActivitiesAdapter}\n */\n/* eslint-disable no-useless-constructor */\nexport default class ActivitiesSDKAdapter extends ActivitiesAdapter {\n  constructor(datasource) {\n    super(datasource);\n\n    this.activityObservables = {};\n  }\n\n  /**\n   * Loads activity data from Webex and returns a promise that resolves to an Activity object\n   *\n   * @param {string} activityID  Id of the activity for which to fetch data\n   * @returns {Promise.<Activity>} Information about the activity of the given ID\n   *\n   * @private\n   */\n  fetchActivity(activityID) {\n    logger.debug('ACTIVITY', activityID, 'fetchActivity()', ['called with', {activityID}]);\n\n    return this.datasource.messages.get(activityID);\n  }\n\n  /**\n   * Returns an observable that emits activity data of the given ID.\n   *\n   * @param {string} ID  Id of activity to get\n   * @returns {external:Observable.<Activity>} Observable stream that emits activity data\n   */\n  getActivity(ID) {\n    logger.debug('ACTIVITY', ID, 'getActivity()', ['called with', {ID}]);\n\n    if (!(ID in this.activityObservables)) {\n      // use ReplaySubject cause we don't need to set an initial value\n      this.activityObservables[ID] = new ReplaySubject(1);\n\n      defer(() => this.fetchActivity(ID)).pipe(\n        map(({\n          id,\n          roomId,\n          text,\n          personId,\n          attachments,\n          created,\n        }) => ({\n          ID: id,\n          roomID: roomId,\n          text,\n          personID: personId,\n          attachments,\n          card: attachments && attachments[0] && attachments[0].contentType === 'application/vnd.microsoft.card.adaptive' ? attachments[0].content : undefined,\n          created,\n        })),\n      ).subscribe(\n        (activity) => {\n          logger.debug('ACTIVITY', ID, 'getActivity()', ['emitting activity object', activity]);\n          this.activityObservables[ID].next(activity);\n        },\n        (error) => {\n          logger.error('ACTIVITY', ID, 'getActivity()', 'Error fetching activity', error);\n          this.activityObservables[ID].error(new Error(`Could not find activity with ID \"${ID}\"`));\n        },\n      );\n    }\n\n    return this.activityObservables[ID];\n  }\n\n  /**\n   * Posts an attachment action, returns an observable that emits the created action\n   *\n   * @param {string} activityID  ID of the activity corresponding to this submit action\n   * @param {object} inputs  The message content\n   * @returns {Observable.<object>} Observable stream that emits data of the newly created action\n   */\n  postAction(activityID, inputs) {\n    logger.debug('ATTACHMENT-ACTION', undefined, 'postAction()', ['called with', {activityID, inputs}]);\n\n    const action$ = from(this.datasource.attachmentActions.create({\n      type: 'submit',\n      messageId: activityID,\n      inputs,\n    })).pipe(\n      map((action) => ({\n        actionID: action.id,\n        activityID: action.messageId,\n        inputs: action.inputs,\n        roomID: action.roomId,\n        personID: action.personId,\n        type: action.type,\n        created: action.created,\n      })),\n      tap((action) => {\n        logger.debug('ATTACHMENT-ACTION', action.actionID, 'postAction()', ['emitting posted attachment action', action]);\n      }),\n      catchError((err) => {\n        logger.error('ATTACHMENT-ACTION', undefined, 'postAction()', `Unable to create an attachment for activity with id \"${activityID}\"`, err);\n        throw err;\n      }),\n    );\n\n    return action$;\n  }\n\n  /**\n   * Posts an activity and returns an observable to the new activity data\n   *\n   * @param {object} activity  The activity to post\n   * @returns {Observable.<Activity>} Observable that emits the posted activity (including id)\n   */\n  postActivity(activity) {\n    const activity$ = from(this.datasource.messages.create({\n      roomId: activity.roomID,\n      text: activity.text,\n      attachments: activity.card ? [{\n        contentType: 'application/vnd.microsoft.card.adaptive',\n        content: activity.card,\n      }] : activity.attachments,\n    })).pipe(\n      map(({\n        id,\n        roomId,\n        text,\n        personId,\n        attachments,\n        created,\n      }) => ({\n        ID: id,\n        roomID: roomId,\n        text,\n        personID: personId,\n        attachments,\n        created,\n      })),\n      catchError((err) => {\n        logger.error('ACTIVITY', undefined, 'postActivity()', ['Unable to post activity', activity], err);\n        throw err;\n      }),\n    );\n\n    return activity$;\n  }\n}\n","import {\n  Subject,\n  concat,\n  from,\n  fromEvent,\n  BehaviorSubject,\n  Observable,\n  throwError,\n} from 'rxjs';\nimport {\n  filter,\n  finalize,\n  flatMap,\n  publishReplay,\n  refCount,\n  tap,\n} from 'rxjs/operators';\nimport {RoomsAdapter} from '@webex/component-adapter-interfaces';\nimport {deconstructHydraId} from '@webex/common';\nimport logger from './logger';\n\n// TODO: Figure out how to import JS Doc definitions and remove duplication.\n/**\n * A virtual space where people can collaborate in Webex.\n *\n * @external Room\n * @see {@link https://github.com/webex/component-adapter-interfaces/blob/master/src/RoomsAdapter.js#L7}\n */\n\nexport const ROOM_UPDATED_EVENT = 'updated';\nexport const CONVERSATION_ACTIVITY_EVENT = 'event:conversation.activity';\n\nconst sortByPublished = (arr) => arr.sort((a, b) => new Date(b.published) - new Date(a.published));\n\n// TODO: Need to remove this once we figure out why we need to pre-cache conversations\nlet FETCHED_CONVERSATIONS = false;\n\n/**\n * The `RoomsSDKAdapter` is an implementation of the `RoomsAdapter` interface.\n * This adapter utilizes the Webex JS SDK to fetch data about a room.\n *\n * @implements {RoomsAdapter}\n */\nexport default class RoomsSDKAdapter extends RoomsAdapter {\n  constructor(datasource) {\n    super(datasource);\n\n    this.getRoomObservables = {};\n    this.getRoomActivitiesCache = {};\n    this.listenerCount = 0;\n\n    this.activityLimit = 50;\n    this.activitiesObservableCache = new Map();\n    this.roomActivities = new Map();\n  }\n\n  /**\n   * Fetches the room data from the sdk and returns in the shape required by adapter.\n   *\n   * @private\n   * @param {string} ID ID of the room for which to fetch data\n   * @returns {Room} Information about the room of the given ID\n   */\n  async fetchRoom(ID) {\n    const {\n      id,\n      title,\n      type,\n      lastActivity,\n    } = await this.datasource.rooms.get(ID);\n\n    return {\n      ID: id,\n      title,\n      type,\n      lastActivity,\n    };\n  }\n\n  /**\n   * Tells the SDK to start listening to room events and tracks the amount of calls.\n   *\n   * Note: Since the SDK listens to ALL room events, this function only\n   * calls the SDK's `rooms.listen` function on the first room to listen.\n   * Repeated calls to `rooms.listen` are not needed afterwards.\n   *\n   * @private\n   */\n  startListeningToRoomUpdates() {\n    if (this.listenerCount === 0) {\n      // Tell the sdk to start listening to room changes\n      this.datasource.rooms.listen();\n    }\n    this.listenerCount += 1;\n  }\n\n  /**\n   * Tells the SDK to stop listening to room events.\n   *\n   * Note: Since the SDK listens to ALL room events, this function only\n   * calls the SDK's `rooms.stopListening` function once all of the listeners are done.\n   * If `rooms.stopListening` is called early, existing subscribers won't get any updates.\n   *\n   * @private\n   */\n  stopListeningToRoomUpdates() {\n    this.listenerCount -= 1;\n\n    if (this.listenerCount <= 0) {\n      // Once all listeners are done, stop listening\n      this.datasource.rooms.stopListening();\n    }\n  }\n\n  /**\n   * Returns an observable that emits room data of the given ID.\n   *\n   * @param {string} ID ID of room to get\n   * @returns {external:Observable.<Room>} Observable stream that emits room data of the given ID\n   */\n  getRoom(ID) {\n    logger.debug('ROOM', ID, 'getRoom()', ['called with', {ID}]);\n    if (!(ID in this.getRoomObservables)) {\n      this.startListeningToRoomUpdates();\n\n      const room$ = from(this.fetchRoom(ID));\n\n      // subscribes to room update events emitted via websocket and emits the updated room object.\n      const roomUpdate$ = fromEvent(this.datasource.rooms, ROOM_UPDATED_EVENT).pipe(\n        // Is the room change event for our subscribed room?\n        filter((event) => event.data.id === ID),\n        // Event data doesn't have the room data in it, so we need to fetch manually\n        flatMap(() => from(this.fetchRoom(ID))),\n      );\n\n      // The observable flow for fetching room data, then listening for websocket events about room changes.\n      const getRoom$ = concat(\n        // Fetch Our Room Data\n        room$,\n        roomUpdate$,\n      ).pipe(\n        tap((room) => logger.debug('ROOM', ID, 'getRoom()', ['emitting room object', room])),\n        finalize(() => {\n          // Called once all subscriptions to `ID` are done.\n          this.stopListeningToRoomUpdates();\n          delete this.getRoomObservables[ID];\n        }),\n      );\n\n      // Convert to a multicast observable\n      this.getRoomObservables[ID] = getRoom$.pipe(\n        publishReplay(1),\n        refCount(),\n      );\n    }\n\n    return this.getRoomObservables[ID];\n  }\n\n  /**\n   * Returns an array of IDs of the most recent activities in a conversation up to the specified limit.\n   *\n   * @param {string} ID ID for the room\n   * @param {string} earliestActivityDate  Get all child activities before this date\n   * @returns {Promise} Resolves with array of activities\n   * @private\n   */\n  async fetchActivities(ID, earliestActivityDate) {\n    const {activityLimit} = this;\n    const conversationId = deconstructHydraId(ID).id;\n\n    logger.debug('ROOM', ID, 'fetchActivities()', ['called with', {\n      earliestActivityDate,\n      activityLimit,\n    }]);\n\n    if (!FETCHED_CONVERSATIONS) {\n      await this.datasource.internal.conversation.list();\n      FETCHED_CONVERSATIONS = true;\n    }\n\n    return this.datasource.internal.conversation.listActivities({\n      conversationId,\n      limit: activityLimit + 1, // Fetch one extra activity to determine if there are more activities to fetch later\n      lastActivityFirst: true,\n      maxDate: earliestActivityDate === null ? undefined : earliestActivityDate,\n    });\n  }\n\n  /**\n   * Returns `true` if there are more activities to load from the room of the given ID.\n   * Otherwise, it returns `false`.\n   *\n   * @param {string} ID ID of the room for which to verify activities.\n   * @returns {boolean} `true` if room has more activities to load, `false` otherwise\n   */\n  hasMoreActivities(ID) {\n    const pastActivities$Cache = this.activitiesObservableCache.get(ID);\n    const {\n      hasMore = true,\n    } = this.roomActivities.get(ID);\n\n    if (!hasMore) {\n      pastActivities$Cache.complete();\n    } else {\n      this.fetchPastActivities(ID);\n    }\n\n    return hasMore;\n  }\n\n  /**\n   * Fetches past activities and returns array of (id, published) objects. Performs side effects\n   *\n   * @param {string} ID The id of the room\n   * @returns null\n   */\n  fetchPastActivities(ID) {\n    const roomActivity = this.roomActivities.get(ID);\n    const {earliestActivityDate} = roomActivity;\n    const room$ = this.activitiesObservableCache.get(ID);\n\n    logger.debug('ROOM', ID, 'fetchPastActivities()', ['called with', {\n      earliestActivityDate,\n    }]);\n\n    if (!ID) {\n      logger.error('ROOM', ID, 'fetchPastActivities()', ['Must provide room ID']);\n      room$.error(new Error('fetchPastActivities - Must provide room ID'));\n    }\n\n    from(this.fetchActivities(ID, earliestActivityDate))\n      .subscribe((data) => {\n        if (!data) {\n          return room$.complete();\n        }\n        roomActivity.hasMore = data.length >= this.activityLimit + 1;\n        const {published} = data.shift();\n        const activityIds = sortByPublished(data).map((activity) => {\n          const {id} = activity;\n\n          roomActivity.activities.set(id, activity);\n\n          return [id, activity.published];\n        });\n\n        roomActivity.earliestActivityDate = published;\n        roomActivity.activityIds.set(published, activityIds.length);\n\n        this.roomActivities.set(ID, roomActivity);\n\n        return room$.next(activityIds);\n      });\n  }\n\n  /**\n   * Returns an observable that emits an array of the next chunk of previous\n   * activity data of the given roomID. If `hasMoreActivities` returns false,\n   * the observable will complete.\n   * **Previous activity data must be sorted newest-to-oldest.**\n   *\n   * @param {string} ID  ID of the room for which to get activities.\n   * @param {number} activityLimit The maximum number of activities to return\n   * @returns {external:Observable.<Room>} Observable stream that emits activity data\n   */\n  getPreviousActivities(ID, activityLimit = 50) {\n    this.activityLimit = activityLimit;\n    const pastActivities$Cache = this.activitiesObservableCache.get(ID) || new Subject();\n\n    if (!ID) {\n      logger.error('ROOM', ID, 'getPreviousActivities()', ['Must provide room ID']);\n\n      return throwError(new Error('getPreviousActivities - Must provide room ID'));\n    }\n\n    if (!this.roomActivities.has(ID)) {\n      this.roomActivities.set(ID, {\n        earliestActivityDate: null,\n        activities: new Map(),\n        activityIds: new Map(),\n      });\n    }\n\n    this.activitiesObservableCache.set(ID, pastActivities$Cache);\n\n    return pastActivities$Cache;\n  }\n\n  /**\n   * Returns an observable that emits current and future activities from the specified room.\n   *\n   * @param {string} ID ID of room to get\n   * @returns {Observable.<Activity>} Observable stream that emits current and future activities from the specified room\n   */\n  getRoomActivities(ID) {\n    logger.debug('ROOM', ID, 'getRoomActivities()', ['called with', {ID}]);\n    if (!(ID in this.getRoomActivitiesCache)) {\n      const getRoomActivities$ = new BehaviorSubject({});\n\n      this.datasource.internal.mercury.on('event:conversation.activity', (sdkActivity) => {\n        const {id: UUID} = deconstructHydraId(ID);\n\n        if (sdkActivity.target && sdkActivity.target.id === UUID) {\n          logger.debug('ROOM', ID, 'getRoomActivities()', ['received \"event:conversation.activity\" event', {sdkActivity}]);\n\n          const activity = {\n            ID: sdkActivity.id,\n            roomID: sdkActivity.target.id,\n            content: sdkActivity.object,\n            contentType: sdkActivity.object.objectType,\n            personID: sdkActivity.actor.id,\n            displayAuthor: false,\n            created: sdkActivity.published,\n          };\n\n          getRoomActivities$.next(activity);\n\n          logger.info('ROOM', ID, 'getRoomActivities()', ['emitting activity object', {activity}]);\n        }\n      });\n\n      this.getRoomActivitiesCache[ID] = getRoomActivities$;\n    }\n\n    return this.getRoomActivitiesCache[ID];\n  }\n}\n","import {\n  concat,\n  defer,\n  fromEvent,\n  of,\n} from 'rxjs';\nimport {\n  catchError,\n  flatMap,\n  filter,\n  finalize,\n  map,\n  publishReplay,\n  refCount,\n  tap,\n} from 'rxjs/operators';\nimport {deconstructHydraId} from '@webex/common';\nimport {PeopleAdapter, PersonStatus} from '@webex/component-adapter-interfaces';\nimport logger from './logger';\n\n// TODO: Figure out how to import JS Doc definitions and remove duplication.\n/**\n * A Webex user.\n *\n * @external Person\n * @see {@link https://github.com/webex/component-adapter-interfaces/blob/master/src/PeopleAdapter.js#L6}\n */\n\nconst USER_PRESENCE_UPDATE_EVENT = 'event:apheleia.subscription_update';\n\n/**\n * Returns a PersonStatus enum key from the given value.\n * If status does not match an enum key, it returns null.\n *\n * @private\n * @param {string} status Person status from Apheleia service.\n * @returns {string} PersonStatus\n */\nfunction getStatus(status) {\n  const personStatus = Object.keys(PersonStatus).find((key) => PersonStatus[key] === status);\n\n  return personStatus === undefined ? null : personStatus;\n}\n\n/**\n * The `PeopleSDKAdapter` is an implementation of the `PeopleAdapter` interface.\n * This adapter utilizes the Webex JS SDK to fetch data about a person.\n *\n * @implements {PeopleAdapter}\n */\nexport default class PeopleSDKAdapter extends PeopleAdapter {\n  constructor(datasource) {\n    super(datasource);\n\n    this.getPersonObservables = {};\n  }\n\n  /**\n   * Fetches the person data from the sdk and returns in the shape required by adapter.\n   *\n   * @private\n   * @param {string} ID ID of the person for which to fetch data\n   * @returns {Person} Info about the person of the given ID\n   */\n  async fetchPerson(ID) {\n    const {\n      id,\n      emails,\n      displayName,\n      firstName,\n      lastName,\n      avatar,\n      orgId,\n    } = await this.datasource.people.get(ID);\n\n    logger.debug('PEOPLE', ID, 'fetchPerson()', ['called with', {ID}]);\n\n    return {\n      ID: id,\n      emails,\n      displayName,\n      firstName,\n      lastName,\n      avatar,\n      orgID: orgId,\n    };\n  }\n\n  /**\n   * Returns an observable that emits person data of the access token bearer.\n   * The observable will emit once and then complete.\n   *\n   * @returns {external:Observable.<Person>} Observable stream that emits person data of the current user\n   */\n  getMe() {\n    logger.debug('PEOPLE', undefined, 'getMe()', 'called');\n\n    // Get person data of the current access token bearer\n    return defer(() => this.fetchPerson('me')).pipe(\n      // Get person status information from presence plug-in\n      flatMap((person) => defer(\n        () => this.datasource.internal.presence.get([person.id]),\n      ).pipe(\n        // When SDK throws error, don't set a status\n        catchError(() => of({status: null})),\n        // Combine person data and presence data to send back\n        map(({status}) => ({...person, status: getStatus(status)})),\n      )),\n    );\n  }\n\n  /**\n   * Returns an observable that emits person data of the given ID.\n   *\n   * @param {string} ID ID of person to get\n   * @returns {external:Observable.<Person>} Observable stream that emits person data of the given ID\n   */\n  getPerson(ID) {\n    logger.debug('PEOPLE', ID, 'getPerson()', ['called with', {ID}]);\n    if (!(ID in this.getPersonObservables)) {\n      const personUUID = deconstructHydraId(ID).id;\n      const person$ = defer(() => this.fetchPerson(ID));\n\n      // Subscribe to 'Apheleia' internal service to listen for status changes\n      // Update the Person object with status response from the subscription\n      const personWithStatus$ = defer(\n        () => this.datasource.internal.presence.subscribe(personUUID),\n      ).pipe(\n        map((data) => data.responses[0].status.status), // This returns only the status data from subscription\n        catchError(() => of(null)), // If subscription fails, don't set a status\n        flatMap((status) => person$.pipe(\n          map((person) => ({...person, status: getStatus(status)})),\n        )),\n      );\n\n      // Listen for status changes for the given person ID after subscription to service\n      const statusUpdate$ = fromEvent(\n        this.datasource.internal.mercury,\n        USER_PRESENCE_UPDATE_EVENT,\n      ).pipe(\n        tap(() => {\n          logger.debug(\n            'PEOPLE', ID, 'getPerson', ['received', USER_PRESENCE_UPDATE_EVENT, 'event'],\n          );\n        }),\n        filter((event) => event.data.subject === personUUID),\n        map((event) => getStatus(event.data.status)),\n      );\n\n      // Update the person status after each change emitted from the event\n      const personUpdate$ = person$.pipe(\n        flatMap((person) => statusUpdate$.pipe(map((status) => ({...person, status})))),\n        tap((person) => {\n          logger.debug('PEOPLE', ID, 'getPerson()', ['person update', {person}]);\n        }),\n      );\n\n      // Emit initial person data on the first run and send updates after each status change\n      const getPerson$ = concat(personWithStatus$, personUpdate$).pipe(\n        tap((person) => {\n          logger.debug('PEOPLE', ID, 'getPerson()', ['emit initial person', {person}]);\n        }),\n        finalize(async () => {\n          try {\n            logger.debug('PEOPLE', ID, 'getPerson()', ['unsubscribing from internal service', {personUUID}]);\n            // Unsubscribe from `Apheleia` internal service when there are no more subscriptions\n            await this.datasource.internal.presence.unsubscribe(personUUID);\n          } catch (error) {\n            // Don't do anything when unsubscribing fails\n            // Trying to remove a subscription fails when the user has presence turned off\n            logger.warn('Unsubscribing failed, user has presence turned off');\n          }\n\n          delete this.getPersonObservables[ID];\n        }),\n      );\n\n      // Store observable for future subscriptions\n      this.getPersonObservables[ID] = getPerson$.pipe(\n        publishReplay(1),\n        refCount(),\n      );\n    }\n\n    return this.getPersonObservables[ID];\n  }\n}\n","export default class MeetingControl {\n  /**\n   * Creates a new instance of the MeetingControl.\n   *\n   * @param {object} adapter  Meeting adapter object\n   * @param {string} controlID  The id of the control\n   */\n  constructor(adapter, controlID) {\n    this.adapter = adapter;\n    this.ID = controlID;\n  }\n}\n","import {Observable} from 'rxjs';\nimport {distinctUntilChanged, map, tap} from 'rxjs/operators';\nimport {MeetingControlState} from '@webex/component-adapter-interfaces';\nimport logger from '../../logger';\nimport MeetingControl from './MeetingControl';\n\n/**\n * Display options of a meeting control.\n *\n * @external MeetingControlDisplay\n * @see {@link https://github.com/webex/component-adapter-interfaces/blob/master/src/MeetingsAdapter.js#L58}\n */\n\nexport default class AudioControl extends MeetingControl {\n  /**\n   * Calls the adapter handleLocalAudio() method\n   *\n   * @private\n   * @param {string} meetingID  ID of the meeting to mute audio\n   */\n  action(meetingID) {\n    logger.debug('MEETING', meetingID, 'AudioControl::action()', ['called with', {meetingID}]);\n\n    return this.adapter.handleLocalAudio(meetingID);\n  }\n\n  /**\n   * Returns an observable that emits the display data of a mute meeting audio control.\n   *\n   * @private\n   * @param {string} meetingID  ID of the meeting to mute audio\n   * @returns {Observable.<MeetingControlDisplay>} Observable stream that emits display data of the audio control\n   */\n  display(meetingID) {\n    logger.debug('MEETING', meetingID, 'AudioControl::display()', ['called with', {meetingID}]);\n\n    const common = {\n      ID: this.ID,\n      type: 'BUTTON',\n    };\n\n    const STATES = {\n      muted: {\n        icon: 'microphone-muted',\n        tooltip: 'Unmute audio',\n        state: MeetingControlState.ACTIVE,\n        text: 'Unmute',\n      },\n      unmuted: {\n        icon: 'microphone',\n        tooltip: 'Mute audio',\n        state: MeetingControlState.INACTIVE,\n        text: 'Mute',\n      },\n      muting: {\n        icon: 'microphone',\n        tooltip: 'Muting audio',\n        state: MeetingControlState.DISABLED,\n        text: 'Muting...',\n      },\n      unmuting: {\n        icon: 'microphone-muted',\n        tooltip: 'Unmuting audio',\n        state: MeetingControlState.DISABLED,\n        text: 'Unmuting...',\n      },\n      noMicrophone: {\n        icon: 'microphone-muted',\n        tooltip: 'No microphone available',\n        state: MeetingControlState.DISABLED,\n        text: 'No microphone',\n      },\n    };\n\n    return this.adapter.getMeeting(meetingID).pipe(\n      map(({localAudio: {stream, muting}, disabledLocalAudio}) => (\n        (muting === true && STATES.muting)\n          || (muting === false && STATES.unmuting)\n          || (stream && STATES.unmuted)\n          || (disabledLocalAudio && STATES.muted)\n          || STATES.noMicrophone\n      )),\n      distinctUntilChanged(),\n      map((state) => ({...common, ...state})),\n      tap((display) => logger.debug('MEETING', meetingID, 'AudioControl::display()', ['emitting', display])),\n    );\n  }\n}\n","import {Observable, of} from 'rxjs';\nimport {tap} from 'rxjs/operators';\nimport logger from '../../logger';\nimport MeetingControl from './MeetingControl';\n\n/**\n * Display options of a meeting control.\n *\n * @external MeetingControlDisplay\n * @see {@link https://github.com/webex/component-adapter-interfaces/blob/master/src/MeetingsAdapter.js#L58}\n */\n\nexport default class ExitControl extends MeetingControl {\n  /**\n   * Calls the adapter leaveMeeting method.\n   *\n   * @param {string} meetingID  Id of the meeting to leave from\n   */\n  async action(meetingID) {\n    logger.debug('MEETING', meetingID, 'ExitControl::action()', ['called with', {meetingID}]);\n\n    await this.adapter.leaveMeeting(meetingID);\n  }\n\n  /**\n   * Returns and observable that emits the display data of the control.\n   *\n   * @param meetingID\n   * @returns {Observable.<MeetingControlDisplay>} Observable that emits display of the exit control\n   */\n  // eslint-disable-next-line class-methods-use-this\n  display(meetingID) {\n    logger.debug('MEETING', meetingID, 'ExitControl::display()', 'called');\n\n    return of({\n      ID: this.ID,\n      type: 'CANCEL',\n      icon: 'cancel',\n      tooltip: 'Leave meeting',\n    }).pipe(\n      tap((display) => logger.debug('MEETING', meetingID, 'ExitControl::display()', ['emitting', display])),\n    );\n  }\n}\n","import {Observable} from 'rxjs';\nimport {distinctUntilChanged, map, tap} from 'rxjs/operators';\nimport {MeetingControlState} from '@webex/component-adapter-interfaces';\nimport logger from '../../logger';\nimport MeetingControl from './MeetingControl';\n\n/**\n * Display options of a meeting control.\n *\n * @external MeetingControlDisplay\n * @see {@link https://github.com/webex/component-adapter-interfaces/blob/master/src/MeetingsAdapter.js#L58}\n */\n\nexport default class JoinControl extends MeetingControl {\n  /**\n   * Calls the adapter joinMeeting method.\n   *\n   * @param {string} meetingID  Id of the meeting to join\n   */\n  async action(meetingID) {\n    logger.debug('MEETING', meetingID, 'JoinControl::action()', ['called with', {meetingID}]);\n\n    await this.adapter.joinMeeting(meetingID);\n  }\n\n  /**\n   * Returns an observable that emits the display data of the control.\n   *\n   * @returns {Observable.<MeetingControlDisplay>} Observable that emits display of the join control\n   */\n  // eslint-disable-next-line class-methods-use-this\n  display(meetingID) {\n    logger.debug('MEETING', meetingID, 'JoinControl::display()', ['called with', {meetingID}]);\n\n    return this.adapter.getMeeting(meetingID).pipe(\n      map((meeting) => {\n        const hint = (meeting.localAudio.stream ? 'Unmuted, ' : 'Muted, ')\n        + (meeting.localVideo.stream ? 'video on' : 'video off');\n        const state = meeting.state === 'NOT_JOINED' ? MeetingControlState.ACTIVE : MeetingControlState.DISABLED;\n\n        return {\n          hint,\n          state,\n        };\n      }),\n      distinctUntilChanged((prev, curr) => (\n        (prev.hint === curr.hint) && (prev.state === curr.state)\n      )),\n      map(({hint, state}) => ({\n        ID: this.ID,\n        type: 'JOIN',\n        text: 'Join meeting',\n        tooltip: 'Join meeting',\n        hint,\n        state,\n      })),\n      tap((display) => logger.debug('MEETING', meetingID, 'JoinControl::display()', ['emitting', display])),\n    );\n  }\n}\n","import {Observable} from 'rxjs';\nimport {distinctUntilChanged, map, tap} from 'rxjs/operators';\nimport {MeetingControlState} from '@webex/component-adapter-interfaces';\nimport logger from '../../logger';\nimport MeetingControl from './MeetingControl';\n\n/**\n * Display options of a meeting control.\n *\n * @external MeetingControlDisplay\n * @see {@link https://github.com/webex/component-adapter-interfaces/blob/master/src/MeetingsAdapter.js#L58}\n */\n\nexport default class RosterControl extends MeetingControl {\n  /**\n   * Attempts to toggle roster to the given meeting ID.\n   * A roster toggle event is dispatched.\n   *\n   * @param {string} meetingID  Id of the meeting to toggle roster\n   */\n  async action(meetingID) {\n    logger.debug('MEETING', meetingID, 'RosterControl::action()', ['called with', {meetingID}]);\n\n    await this.adapter.toggleRoster(meetingID);\n  }\n\n  /**\n   * Returns an observable that emits the display data of a roster control.\n   *\n   * @param {string} meetingID  Id of the meeting to toggle roster\n   * @returns {Observable.<MeetingControlDisplay>} Observable stream that emits display data of the roster control\n   */\n  display(meetingID) {\n    logger.debug('MEETING', meetingID, 'RosterControl::display()', ['called with', {meetingID}]);\n    const active = {\n      ID: this.ID,\n      type: 'TOGGLE',\n      state: MeetingControlState.ACTIVE,\n      icon: 'participant-list',\n      text: 'Hide participants',\n      tooltip: 'Hide participants panel',\n    };\n    const inactive = {\n      ID: this.ID,\n      type: 'TOGGLE',\n      state: MeetingControlState.INACTIVE,\n      icon: 'participant-list',\n      text: 'Show participants',\n      tooltip: 'Show participants panel',\n    };\n\n    return this.adapter.getMeeting(meetingID).pipe(\n      map(({showRoster}) => (showRoster ? active : inactive)),\n      distinctUntilChanged(),\n      tap((display) => logger.debug('MEETING', meetingID, 'RosterControl::display()', ['emitting', display])),\n    );\n  }\n}\n","import {Observable} from 'rxjs';\nimport {distinctUntilChanged, map, tap} from 'rxjs/operators';\nimport {MeetingControlState} from '@webex/component-adapter-interfaces';\nimport logger from '../../logger';\nimport MeetingControl from './MeetingControl';\n\n/**\n * Display options of a meeting control.\n *\n * @external MeetingControlDisplay\n * @see {@link https://github.com/webex/component-adapter-interfaces/blob/master/src/MeetingsAdapter.js#L58}\n */\n\nexport default class SettingsControl extends MeetingControl {\n  /**\n   * Toggles the showSettings flag of the given meeting ID.\n   * A settings toggle event is dispatched.\n   *\n   * @param {string} meetingID  Meeting ID\n   */\n  action(meetingID) {\n    logger.debug('Meeting', meetingID, 'SettingsControl::action()', ['called with', {meetingID}]);\n\n    this.adapter.toggleSettings(meetingID);\n  }\n\n  /**\n   * Returns an observable that emits the display data of a settings control.\n   *\n   * @param {string} meetingID  Meeting id\n   * @returns {Observable.<MeetingControlDisplay>} Observable stream that emits display data of the settings control\n   */\n  display(meetingID) {\n    logger.debug('MEETING', meetingID, 'SettingsControl::display()', ['called with', {meetingID}]);\n    const active = {\n      ID: this.ID,\n      type: 'BUTTON',\n      state: MeetingControlState.ACTIVE,\n      icon: 'settings',\n      text: 'Settings',\n      tooltip: 'Meeting settings',\n    };\n    const inactive = {\n      ID: this.ID,\n      type: 'BUTTON',\n      state: MeetingControlState.INACTIVE,\n      icon: 'settings',\n      text: 'Settings',\n      tooltip: 'Meeting settings',\n    };\n\n    return this.adapter.getMeeting(meetingID).pipe(\n      map(({showSettings}) => (showSettings ? active : inactive)),\n      distinctUntilChanged(),\n      tap((display) => logger.debug('Meeting', meetingID, 'SettingsControl::display()', ['emitting', display])),\n    );\n  }\n}\n","import {Observable} from 'rxjs';\nimport {distinctUntilChanged, map, tap} from 'rxjs/operators';\nimport {MeetingControlState} from '@webex/component-adapter-interfaces';\nimport logger from '../../logger';\nimport MeetingControl from './MeetingControl';\n\n/**\n * Display options of a meeting control.\n *\n * @external MeetingControlDisplay\n * @see {@link https://github.com/webex/component-adapter-interfaces/blob/master/src/MeetingsAdapter.js#L58}\n */\n\nexport default class ShareControl extends MeetingControl {\n  /**\n   * Calls the adapter handleLocalShare() method\n   *\n   * @param {string} meetingID  ID of the meeting to share screen\n   */\n  async action(meetingID) {\n    logger.debug('MEETING', meetingID, 'ShareControl::action()', ['called with', {meetingID}]);\n\n    await this.adapter.handleLocalShare(meetingID);\n  }\n\n  /**\n   * Returns an observable that emits the display data of a share control.\n   *\n   * @param {string} meetingID  ID of the meeting to start/stop screen share\n   * @returns {Observable.<MeetingControlDisplay>} Observable stream that emits display data of the screen share control\n   */\n  display(meetingID) {\n    logger.debug('MEETING', meetingID, 'ShareControl::display()', ['called with', {meetingID}]);\n    const inactive = {\n      ID: this.ID,\n      type: 'TOGGLE',\n      state: MeetingControlState.INACTIVE,\n      icon: 'share-screen-presence-stroke',\n      text: 'Start sharing',\n      tooltip: 'Start sharing content',\n    };\n    const active = {\n      ID: this.ID,\n      type: 'TOGGLE',\n      state: MeetingControlState.ACTIVE,\n      icon: 'share-screen-presence-stroke',\n      text: 'Stop sharing',\n      tooltip: 'Stop sharing content',\n    };\n\n    return this.adapter.getMeeting(meetingID).pipe(\n      map(({localShare: {stream}}) => (stream ? active : inactive)),\n      distinctUntilChanged(),\n      tap((display) => logger.debug('MEETING', meetingID, 'ShareControl::display()', ['emitting', display])),\n    );\n  }\n}\n","import {Observable} from 'rxjs';\nimport {distinctUntilChanged, map, tap} from 'rxjs/operators';\nimport logger from '../../logger';\nimport MeetingControl from './MeetingControl';\nimport {combineLatestImmediate} from '../../utils';\n/**\n * Display options of a meeting control.\n *\n * @external MeetingControlDisplay\n * @see {@link https://github.com/webex/component-adapter-interfaces/blob/master/src/MeetingsAdapter.js#L58}\n */\n\nexport default class SwitchCameraControl extends MeetingControl {\n  /**\n   * Calls the action of the switch camera control.\n   *\n   * @param {string} meetingID  Meeting ID\n   * @param {string} cameraID  Id of the camera to switch to\n   */\n  async action(meetingID, cameraID) {\n    logger.debug('MEETING', meetingID, 'SwitchCameraControl::action()', ['called with', {meetingID}]);\n\n    await this.adapter.switchCamera(meetingID, cameraID);\n  }\n\n  /**\n   * Returns an observable that emits the display data of the switch camera control.\n   *\n   * @param {string} meetingID  Meeting ID\n   * @returns {Observable.<MeetingControlDisplay>} Observable that emits control display data of the switch camera control\n   */\n  display(meetingID) {\n    logger.debug('MEETING', meetingID, 'SwitchCameraControl::display()', ['called with', {meetingID}]);\n\n    const cameraID$ = this.adapter.getMeeting(meetingID).pipe(\n      map((meeting) => meeting.cameraID),\n      distinctUntilChanged(),\n    );\n\n    const options$ = this.adapter.getAvailableDevices(meetingID, 'videoinput').pipe(\n      map((availableCameras) => availableCameras.map((camera) => ({\n        value: camera.deviceId,\n        label: camera.label,\n      }))),\n    );\n\n    return combineLatestImmediate(cameraID$, options$).pipe(\n      map(([cameraID, options]) => ({\n        ID: this.ID,\n        type: 'MULTISELECT',\n        tooltip: 'Video Devices',\n        noOptionsMessage: 'No available cameras',\n        options: options || null,\n        selected: cameraID || null,\n        hint: 'Use arrow keys to navigate between camera options and hit \"Enter\" to select.',\n      })),\n      tap((display) => logger.debug('MEETING', meetingID, 'SwitchCameraControl::display()', ['emitting', display])),\n    );\n  }\n}\n","import {Observable} from 'rxjs';\nimport {distinctUntilChanged, map, tap} from 'rxjs/operators';\nimport logger from '../../logger';\nimport MeetingControl from './MeetingControl';\nimport {combineLatestImmediate} from '../../utils';\n\n/**\n * Display options of a meeting control.\n *\n * @external MeetingControlDisplay\n * @see {@link https://github.com/webex/component-adapter-interfaces/blob/master/src/MeetingsAdapter.js#L58}\n */\n\nexport default class SwitchMicrophoneControl extends MeetingControl {\n  /**\n   * Switches the microphone control.\n   *\n   * @param {string} meetingID  Meeting ID\n   * @param {string} microphoneID  Id of the microphone to switch to\n   */\n  async action(meetingID, microphoneID) {\n    logger.debug('MEETING', meetingID, 'SwitchMicrophoneControl::action()', ['called with', {meetingID}]);\n\n    await this.adapter.switchMicrophone(meetingID, microphoneID);\n  }\n\n  /**\n   * Returns an observable that emits the display data of the switch microphone control.\n   *\n   * @param {string} meetingID  Meeting ID\n   * @returns {Observable.<MeetingControlDisplay>} Observable that emits control display data of the switch microphone control\n   */\n  display(meetingID) {\n    logger.debug('MEETING', meetingID, 'SwitchMicrophoneControl::display()', ['called with', {meetingID}]);\n\n    const microphoneID$ = this.adapter.getMeeting(meetingID).pipe(\n      map((meeting) => meeting.microphoneID),\n      distinctUntilChanged(),\n    );\n\n    const options$ = this.adapter.getAvailableDevices(meetingID, 'audioinput').pipe(\n      map((availableMicrophones) => availableMicrophones.map((microphone) => ({\n        value: microphone.deviceId,\n        label: microphone.label,\n      }))),\n    );\n\n    return combineLatestImmediate(microphoneID$, options$).pipe(\n      map(([microphoneID, options]) => ({\n        ID: this.ID,\n        type: 'MULTISELECT',\n        tooltip: 'Audio Devices',\n        noOptionsMessage: 'No available microphones',\n        options: options || null,\n        selected: microphoneID || null,\n        hint: 'Use arrow keys to navigate between microphone options and hit \"Enter\" to select.',\n      })),\n      tap((display) => logger.debug('MEETING', meetingID, 'SwitchMicrophoneControl::display()', ['emitting', display])),\n    );\n  }\n}\n","import {Observable} from 'rxjs';\nimport {distinctUntilChanged, map, tap} from 'rxjs/operators';\nimport logger from '../../logger';\nimport MeetingControl from './MeetingControl';\nimport {combineLatestImmediate, isSpeakerSupported} from '../../utils';\n/**\n * Display options of a meeting control.\n *\n * @external MeetingControlDisplay\n * @see {@link https://github.com/webex/component-adapter-interfaces/blob/master/src/MeetingsAdapter.js#L58}\n */\n\nexport default class SwitchSpeakerControl extends MeetingControl {\n  /**\n   * Calls the the action of the switch speaker control.\n   *\n   * @param {string} meetingID  Meeting ID\n   * @param {string} speakerID  ID of the speaker device to switch to\n   */\n  async action(meetingID, speakerID) {\n    logger.debug('MEETING', meetingID, 'SwitchSpeakerControl::action()', ['called with', {meetingID}]);\n\n    await this.adapter.switchSpeaker(meetingID, speakerID);\n  }\n\n  /**\n   * Returns and observable that emits the display data of the control.\n   *\n   * @param {string} meetingID  Meeting ID\n   * @returns {Observable.<MeetingControlDisplay>} Observable that emits control display of the control\n   */\n  display(meetingID) {\n    logger.debug('MEETING', meetingID, 'SwitchSpeakerControl::display()', ['called with', {meetingID}]);\n\n    const speakerID$ = this.adapter.getMeeting(meetingID).pipe(\n      map((meeting) => meeting.speakerID),\n      distinctUntilChanged(),\n    );\n\n    const options$ = this.adapter.getAvailableDevices(meetingID, 'audiooutput').pipe(\n      map((availableSpeakers) => availableSpeakers.map((speaker) => ({\n        value: speaker.deviceId,\n        label: speaker.label,\n      }))),\n      map((options) => ([{value: '', label: 'Browser Default'}, ...options])),\n    );\n\n    return combineLatestImmediate(speakerID$, options$).pipe(\n      map(([speakerID, options]) => ({\n        ID: this.ID,\n        type: 'MULTISELECT',\n        // The browser api setSinkId() does not work properly on Firefox and Safari browsers so we need to treat them separately by displaying a message inside a tooltip in both cases.\n        // https://developer.mozilla.org/en-US/docs/Web/API/HTMLMediaElement/setSinkId\n        tooltip: isSpeakerSupported ? 'Speaker Devices' : 'The current browser does not support changing speakers',\n        noOptionsMessage: 'No available speakers',\n        options: options || null,\n        selected: speakerID || null,\n        hint: 'Use arrow keys to navigate between speaker options and hit \"Enter\" to select.',\n      })),\n      tap((display) => logger.debug('MEETING', meetingID, 'SwitchSpeakerControl::display()', ['emitting', display])),\n    );\n  }\n}\n","import {Observable} from 'rxjs';\nimport {distinctUntilChanged, map, tap} from 'rxjs/operators';\nimport {MeetingControlState} from '@webex/component-adapter-interfaces';\nimport logger from '../../logger';\nimport MeetingControl from './MeetingControl';\n\n/**\n * Display options of a meeting control.\n *\n * @external MeetingControlDisplay\n * @see {@link https://github.com/webex/component-adapter-interfaces/blob/master/src/MeetingsAdapter.js#L58}\n */\n\nexport default class VideoControl extends MeetingControl {\n  /**\n   * Calls the adapter handleLocalVideo() method\n   *\n   * @param {string} meetingID  Meeting id\n   */\n  action(meetingID) {\n    logger.debug('MEETING', meetingID, 'VideoControl::action()', ['called with', {meetingID}]);\n\n    return this.adapter.handleLocalVideo(meetingID);\n  }\n\n  /**\n   * Returns an observable that emits the display data of a mute meeting video control.\n   *\n   * @param {string} meetingID  Meeting id\n   * @returns {Observable.<MeetingControlDisplay>} Observable stream that emits display data of the video control\n   */\n  display(meetingID) {\n    logger.debug('MEETING', meetingID, 'VideoControl::display()', ['called with', {meetingID}]);\n\n    const common = {\n      ID: this.ID,\n      type: 'BUTTON',\n    };\n\n    const STATES = {\n      muted: {\n        icon: 'camera-muted',\n        tooltip: 'Start video',\n        state: MeetingControlState.ACTIVE,\n        text: 'Start video',\n      },\n      unmuted: {\n        icon: 'camera',\n        tooltip: 'Stop video',\n        state: MeetingControlState.INACTIVE,\n        text: 'Stop video',\n      },\n      muting: {\n        icon: 'camera',\n        tooltip: 'Stopping video',\n        state: MeetingControlState.DISABLED,\n        text: 'Stopping...',\n      },\n      unmuting: {\n        icon: 'camera-muted',\n        tooltip: 'Starting video',\n        state: MeetingControlState.DISABLED,\n        text: 'Starting...',\n      },\n      noCamera: {\n        icon: 'camera-muted',\n        tooltip: 'No camera available',\n        state: MeetingControlState.DISABLED,\n        text: 'No camera',\n      },\n    };\n\n    return this.adapter.getMeeting(meetingID).pipe(\n      map(({localVideo: {stream, muting}, disabledLocalVideo}) => (\n        (muting === true && STATES.muting)\n        || (muting === false && STATES.unmuting)\n        || (stream && STATES.unmuted)\n        || (disabledLocalVideo && STATES.muted)\n        || STATES.noCamera\n      )),\n      distinctUntilChanged(),\n      map((state) => ({...common, ...state})),\n      tap((display) => logger.debug('MEETING', meetingID, 'VideoControl::display()', ['emitting', display])),\n    );\n  }\n}\n","import {MeetingsAdapter, MeetingState} from '@webex/component-adapter-interfaces';\nimport {deconstructHydraId} from '@webex/common';\nimport {\n  concat,\n  from,\n  fromEvent,\n  merge,\n  Observable,\n  of,\n} from 'rxjs';\nimport {\n  catchError,\n  concatMap,\n  distinctUntilChanged,\n  filter,\n  map,\n  publishReplay,\n  refCount,\n  takeWhile,\n  tap,\n} from 'rxjs/operators';\n\nimport logger from './logger';\n\nimport AudioControl from './MeetingsSDKAdapter/controls/AudioControl';\nimport ExitControl from './MeetingsSDKAdapter/controls/ExitControl';\nimport JoinControl from './MeetingsSDKAdapter/controls/JoinControl';\nimport RosterControl from './MeetingsSDKAdapter/controls/RosterControl';\nimport SettingsControl from './MeetingsSDKAdapter/controls/SettingsControl';\nimport ShareControl from './MeetingsSDKAdapter/controls/ShareControl';\nimport SwitchCameraControl from './MeetingsSDKAdapter/controls/SwitchCameraControl';\nimport SwitchMicrophoneControl from './MeetingsSDKAdapter/controls/SwitchMicrophoneControl';\nimport SwitchSpeakerControl from './MeetingsSDKAdapter/controls/SwitchSpeakerControl';\nimport VideoControl from './MeetingsSDKAdapter/controls/VideoControl';\nimport {chainWith, deepMerge} from './utils';\n\n// TODO: Figure out how to import JS Doc definitions and remove duplication.\n/**\n * A video conference in Webex over WebRTC.\n *\n * @external Meeting\n * @see {@link https://github.com/webex/component-adapter-interfaces/blob/master/src/MeetingsAdapter.js#L20}\n * @see {@link https://webrtc.org}\n */\n\n// TODO: Figure out how to import JS Doc definitions and remove duplication.\n/**\n * Display options of a meeting control.\n *\n * @external MeetingControlDisplay\n * @see {@link https://github.com/webex/component-adapter-interfaces/blob/master/src/MeetingsAdapter.js#L58}\n */\n\n// JS SDK Events\nconst EVENT_MEDIA_READY = 'media:ready';\nconst EVENT_MEDIA_STOPPED = 'media:stopped';\nconst EVENT_MEMBERS_UPDATE = 'members:update';\nconst EVENT_LOCAL_SHARE_STOP = 'meeting:stoppedSharingLocal';\nconst EVENT_LOCAL_SHARE_START = 'meeting:startedSharingLocal';\nconst EVENT_REMOTE_SHARE_START = 'meeting:startedSharingRemote';\nconst EVENT_REMOTE_SHARE_STOP = 'meeting:stoppedSharingRemote';\n\n// Adapter Events\nconst EVENT_MEETING_UPDATED = 'adapter:meeting:updated';\nconst EVENT_CAMERA_SWITCH = 'adapter:camera:switch';\nconst EVENT_MICROPHONE_SWITCH = 'adapter:microphone:switch';\n\n// Meeting controls\nconst JOIN_CONTROL = 'join-meeting';\nconst EXIT_CONTROL = 'leave-meeting';\nconst AUDIO_CONTROL = 'mute-audio';\nconst VIDEO_CONTROL = 'mute-video';\nconst SHARE_CONTROL = 'share-screen';\nconst ROSTER_CONTROL = 'member-roster';\nconst SETTINGS_CONTROL = 'settings';\nconst SWITCH_CAMERA_CONTROL = 'switch-camera';\nconst SWITCH_MICROPHONE_CONTROL = 'switch-microphone';\nconst SWITCH_SPEAKER_CONTROL = 'switch-speaker';\n\n// Media stream types\nconst MEDIA_TYPE_LOCAL = 'local';\nconst MEDIA_TYPE_LOCAL_SHARE = 'localShare';\nconst MEDIA_TYPE_REMOTE_AUDIO = 'remoteAudio';\nconst MEDIA_TYPE_REMOTE_VIDEO = 'remoteVideo';\nconst MEDIA_TYPE_REMOTE_SHARE = 'remoteShare';\nconst MEDIA_EVENT_TYPES = [\n  MEDIA_TYPE_LOCAL,\n  MEDIA_TYPE_LOCAL_SHARE,\n  MEDIA_TYPE_REMOTE_AUDIO,\n  MEDIA_TYPE_REMOTE_VIDEO,\n  MEDIA_TYPE_REMOTE_SHARE,\n];\n\nconst mediaSettings = {\n  receiveVideo: true,\n  receiveAudio: true,\n  receiveShare: true,\n  sendVideo: true,\n  sendAudio: true,\n  sendShare: false,\n};\n\nconst HYDRA_ID_TYPE_PEOPLE = 'PEOPLE';\nconst HYDRA_ID_TYPE_ROOM = 'ROOM';\n\nconst LAYOUT_TYPES_MAP = {\n  Overlay: 'ActivePresence',\n  Grid: 'Equal',\n  Stack: 'Prominent',\n  Prominent: 'OnePlusN',\n  Focus: 'Single',\n};\n\nconst SDK_MEMBER_STATUS_TO_ADAPTER_MEETING_STATE = {\n  IN_LOBBY: MeetingState.LOBBY,\n  IN_MEETING: MeetingState.JOINED,\n  NOT_IN_MEETING: MeetingState.LEFT,\n};\n\n/**\n * The `MeetingsSDKAdapter` is an implementation of the `MeetingsAdapter` interface.\n * This adapter utilizes the Webex JS SDK to create and join Webex meetings.\n *\n * @implements {MeetingsAdapter}\n */\nexport default class MeetingsSDKAdapter extends MeetingsAdapter {\n  constructor(datasource) {\n    super(datasource);\n    this.getMeetingObservables = {};\n    this.meetings = {};\n\n    this.meetingControls = {\n      [JOIN_CONTROL]: new JoinControl(this, JOIN_CONTROL),\n      [AUDIO_CONTROL]: new AudioControl(this, AUDIO_CONTROL),\n      [VIDEO_CONTROL]: new VideoControl(this, VIDEO_CONTROL),\n      [SHARE_CONTROL]: new ShareControl(this, SHARE_CONTROL),\n      [EXIT_CONTROL]: new ExitControl(this, EXIT_CONTROL),\n      [ROSTER_CONTROL]: new RosterControl(this, ROSTER_CONTROL),\n      [SETTINGS_CONTROL]: new SettingsControl(this, SETTINGS_CONTROL),\n      [SWITCH_CAMERA_CONTROL]: new SwitchCameraControl(this, SWITCH_CAMERA_CONTROL),\n      [SWITCH_SPEAKER_CONTROL]: new SwitchSpeakerControl(this, SWITCH_SPEAKER_CONTROL),\n      [SWITCH_MICROPHONE_CONTROL]: new SwitchMicrophoneControl(this, SWITCH_MICROPHONE_CONTROL),\n    };\n  }\n\n  /**\n   * Register the SDK meeting plugin to the device\n   * and sync the meeting collection from the server.\n   */\n  async connect() {\n    await this.datasource.meetings.register();\n    await this.datasource.meetings.syncMeetings();\n  }\n\n  /**\n   * Unregister the SDK meeting plugin from the device.\n   */\n  async disconnect() {\n    await this.datasource.meetings.unregister();\n  }\n\n  /**\n   * Returns an observable that emits local device media streams and their user permission status\n   *\n   * @private\n   * @param {string} ID ID to retrieve the SDK meeting object to add the local media to\n   * @returns {Observable} Observable that emits local media streams and their user permission status\n   */\n  getLocalMedia(ID) {\n    logger.debug('MEETING', ID, 'getLocalMedia()', ['called with', {ID}]);\n    const {sendAudio, sendVideo} = mediaSettings;\n\n    return this.getStreamWithPermission(sendAudio, ID, {sendAudio: true}).pipe(\n      map(({\n        permission,\n        stream,\n        ignore,\n        deviceId,\n      }) => ({\n        localAudio: {\n          stream,\n          permission,\n          ignoreMediaAccessPrompt: ignore,\n        },\n        localVideo: {\n          stream: null,\n          permission: null,\n        },\n        microphoneID: deviceId,\n      })),\n      chainWith((audio) => this.getStreamWithPermission(sendVideo, ID, {sendVideo: true}).pipe(\n        map(({\n          permission,\n          stream,\n          ignore,\n          deviceId,\n        }) => ({\n          ...audio,\n          localVideo: {\n            stream,\n            permission,\n            ignoreMediaAccessPrompt: ignore,\n          },\n          cameraID: deviceId,\n        })),\n      )),\n    );\n  }\n\n  /**\n   * Returns an observable that emits local device media streams and their user permission status based on the given constraints.\n   *\n   * @see {@link MediaStream|https://developer.mozilla.org/en-US/docs/Web/API/MediaStream}.\n   *\n   * @private\n   * @param {string} ID ID of the meeting for which to fetch streams\n   * @param {object} mediaDirection A configurable options object for joining a meetings\n   * @param {object} audioVideo audio/video object to set audioinput and videoinput devices\n   * @returns {Observable} Observable that emits local media streams and their user permission status\n   */\n  getStream(ID, mediaDirection, audioVideo) {\n    logger.debug('MEETING', ID, 'getStream()', ['called with', {ID, mediaDirection, audioVideo}]);\n\n    return new Observable(async (subscriber) => {\n      let ignored = false;\n      let isAsking;\n\n      try {\n        const sdkMeeting = this.fetchMeeting(ID);\n\n        const ignore = () => {\n          ignored = true;\n          subscriber.next({permission: 'IGNORED', stream: null});\n          subscriber.complete();\n        };\n\n        // wait a bit for the prompt to appear before emitting ASKING\n        isAsking = true;\n        setTimeout(() => {\n          if (isAsking) {\n            // media access promise was neither fulfilled nor rejected, so the browser prompt is probably showing\n            subscriber.next({permission: 'ASKING', stream: null, ignore});\n          }\n        }, 2000);\n\n        const [localStream] = await sdkMeeting.getMediaStreams(mediaDirection, audioVideo);\n        const availableDevices = await navigator.mediaDevices.enumerateDevices();\n        const [{label: deviceLabel}] = localStream.getTracks();\n        const mediaDevice = availableDevices.find((device) => device.label === deviceLabel);\n        const deviceId = mediaDevice && mediaDevice.deviceId;\n\n        isAsking = false;\n\n        for (const track of localStream.getTracks()) {\n          if (track.kind === 'video' && !mediaDirection.sendVideo) {\n            localStream.removeTrack(track);\n          }\n          if (track.kind === 'audio' && !mediaDirection.sendAudio) {\n            localStream.removeTrack(track);\n          }\n        }\n\n        if (!ignored) {\n          subscriber.next({permission: 'ALLOWED', stream: localStream, deviceId});\n          subscriber.complete();\n        }\n      } catch (error) {\n        isAsking = false;\n\n        if (!ignored) {\n          let perm;\n          const ee = error.error;\n\n          logger.error('MEETING', ID, 'getStream()', 'Unable to retrieve local media stream', ee || error);\n\n          if (ee instanceof DOMException) {\n            if (ee.name === 'NotAllowedError') {\n              if (ee.message === 'Permission dismissed') {\n                perm = 'DISMISSED';\n              } else if (ee.message === 'Permission denied by system') {\n                perm = 'DISABLED';\n              } else {\n                perm = 'DENIED';\n              }\n            } else if (ee.name === 'NotReadableError') {\n              perm = 'DISABLED';\n            } else {\n              perm = 'ERROR';\n            }\n          } else {\n            perm = 'ERROR';\n          }\n          subscriber.next({permission: perm, stream: null});\n          subscriber.complete();\n        }\n      }\n    });\n  }\n\n  /**\n   * Returns an observable that emits local device media streams and their user permission status\n   *\n   * @private\n   * @param {boolean} condition Meeting mediaSettings propery condition for sending streams\n   * @param {string} ID Meeting ID\n   * @param {object} mediaDirection A configurable options object for joining a meetings\n   * @param {object} audioVideo audio/video object to set audioinput and videoinput devices\n   * @returns {Observable} Observable that emits local media streams and their user permission status\n   */\n  getStreamWithPermission(condition, ID, mediaDirection, audioVideo) {\n    logger.debug('MEETING', ID, 'getStreamWithPermission()', ['called with these params', {\n      condition, ID, mediaDirection, audioVideo,\n    }]);\n\n    return condition\n      ? this.getStream(ID, mediaDirection, audioVideo)\n      : of({permission: null, stream: null});\n  }\n\n  /**\n   * Emits available media devices.\n   * If the user did no grant access to media (browser and OS), the returned observable\n   * will emit an empty array.\n   *\n   * @param {string} ID  Id of the meeting\n   * @param {'videoinput'|'audioinput'|'audiooutput'} type  String specifying the device type.\n   * See {@link https://developer.mozilla.org/en-US/docs/Web/API/MediaDeviceInfo/kind|MDN}\n   * @returns {Observable<MediaDeviceInfo[]>} Observable that emits arrays containing media devices.\n   * @private\n   */\n  getAvailableDevices(ID, type) {\n    logger.debug('MEETING', ID, 'getAvailableDevices()', ['called with', {ID, type}]);\n\n    const getDevices = async () => {\n      let devices = [];\n\n      try {\n        devices = await this.fetchMeeting(ID).getDevices();\n        devices = devices.filter((device) => !type || (device.kind === type && device.deviceId));\n      } catch (error) {\n        logger.error('MEETING', ID, 'getAvailableDevices()', 'Unable to retrieve devices', error);\n      }\n\n      return devices;\n    };\n\n    return this.getMeeting(ID).pipe(\n      map((meeting) => (\n        (type !== 'videoinput' && type !== 'audioinput') ||\n        (type === 'videoinput' && meeting.localVideo.permission === 'ALLOWED') ||\n        (type === 'audioinput' && meeting.localAudio.permission === 'ALLOWED')\n      )),\n      distinctUntilChanged(),\n      concatMap((allowed) => from(allowed ? getDevices() : [[]])),\n      tap((devices) => logger.debug('MEETING', ID, 'getAvailabelDevices()', ['emitting', devices])),\n    );\n  }\n\n  /**\n   * Update the meeting object with media attached based on a given event type.\n   *\n   * @private\n   * @param {string} ID ID of the meeting to update\n   * @param {object} media Media stream to attach to the meeting object based on a given event type\n   * @param {string} media.type Type of event associated with the media change\n   * @param {MediaStream} media.stream Media stream to attach to meeting\n   */\n  attachMedia(ID, {type, stream}) {\n    logger.debug('MEETING', ID, 'attachMedia()', ['called with', {ID, type, stream}]);\n    const meeting = {...this.meetings[ID]};\n    const audioTracks = (stream instanceof MediaStream && stream.getAudioTracks()) || [];\n    const videoTracks = (stream instanceof MediaStream && stream.getVideoTracks()) || [];\n\n    switch (type) {\n      case MEDIA_TYPE_LOCAL:\n        this.meetings[ID] = {\n          ...meeting,\n          // Attach the media streams only if the streams are unmuted\n          // `disableLocalAudio/Video` change inside handle media stream methods\n          localAudio: {\n            ...meeting.localAudio,\n            stream: meeting.disabledLocalAudio || audioTracks.length === 0\n              ? null\n              : new MediaStream(audioTracks),\n          },\n          localVideo: {\n            ...meeting.localVideo,\n            stream: meeting.disabledLocalVideo || videoTracks.length === 0\n              ? null\n              : new MediaStream(videoTracks),\n          },\n        };\n        break;\n      case MEDIA_TYPE_REMOTE_AUDIO:\n        this.meetings[ID] = {...meeting, remoteAudio: stream};\n        break;\n      case MEDIA_TYPE_REMOTE_VIDEO:\n        this.meetings[ID] = {...meeting, remoteVideo: stream};\n        break;\n      case MEDIA_TYPE_LOCAL_SHARE:\n        this.meetings[ID] = {...meeting, localShare: {stream}};\n        break;\n      case MEDIA_TYPE_REMOTE_SHARE:\n        this.meetings[ID] = {\n          ...meeting,\n          remoteShareStream: stream,\n          remoteShare: meeting.remoteSharing ? stream : null,\n        };\n        break;\n      case EVENT_REMOTE_SHARE_START:\n        // Only activate the remote stream when get get the start notification\n        this.meetings[ID] = {\n          ...meeting,\n          remoteShare: meeting.remoteShareStream || null,\n          remoteSharing: true,\n        };\n        break;\n      case EVENT_REMOTE_SHARE_STOP:\n        // Remove remote share on stop event\n        this.meetings[ID] = {\n          ...meeting,\n          remoteShare: null,\n          remoteSharing: false,\n        };\n        break;\n      default:\n        break;\n    }\n  }\n\n  /**\n   * Stops the tracks of the given media stream.\n   *\n   * @see {@link MediaStream|https://developer.mozilla.org/en-US/docs/Web/API/MediaStream}.\n   *\n   * @private\n   * @static\n   * @param {MediaStream} stream Media stream for which to stop tracks\n   */\n  // eslint-disable-next-line class-methods-use-this\n  stopStream(stream) {\n    logger.debug('MEETING', undefined, 'stopStream()', 'called');\n    if (stream && stream.getTracks) {\n      const tracks = stream.getTracks();\n\n      tracks.forEach((track) => track.stop());\n    }\n  }\n\n  /**\n   * Update the meeting object by removing all media.\n   *\n   * @private\n   * @param {string} ID ID of the meeting to update\n   */\n  removeMedia(ID) {\n    logger.debug('MEETING', ID, 'removeMedia()', ['called with', {ID}]);\n    if (this.meetings && this.meetings[ID]) {\n      this.stopStream(this.meetings[ID].localAudio.stream);\n      this.stopStream(this.meetings[ID].localVideo.stream);\n      this.stopStream(this.meetings[ID].localShare.stream);\n      this.stopStream(this.meetings[ID].disabledLocalAudio);\n      this.stopStream(this.meetings[ID].disabledLocalVideo);\n    }\n\n    this.meetings[ID] = {\n      ...this.meetings[ID],\n      localAudio: {\n        stream: null,\n        permission: null,\n      },\n      localVideo: {\n        stream: null,\n        permission: null,\n      },\n      localShare: {\n        stream: null,\n      },\n      remoteAudio: null,\n      remoteVideo: null,\n      remoteShare: null,\n      cameraID: null,\n      microphoneID: null,\n      speakerID: null,\n      settings: {\n        visible: false,\n        preview: {\n          video: null,\n          audio: null,\n        },\n      },\n    };\n  }\n\n  /**\n   * Returns a promise of a meeting title for a given destination.\n   * Supported destinations are person ID, room ID and SIP URI.\n   *\n   * @private\n   * @param {string} destination Virtual meeting destination\n   * @returns {Promise.<string>} Promise to the tile of the meeting at the destination\n   */\n  async fetchMeetingTitle(destination) {\n    const {id, type} = deconstructHydraId(destination);\n    let meetingTitle = destination;\n\n    if (type === HYDRA_ID_TYPE_PEOPLE) {\n      const {displayName} = await this.datasource.people.get(id);\n\n      meetingTitle = displayName;\n    } else if (type === HYDRA_ID_TYPE_ROOM) {\n      // One must use a Hydra ID when calling `get` on rooms.\n      // It has both the convo ID and cluster name in it.\n      const {title} = await this.datasource.rooms.get(destination);\n\n      meetingTitle = title;\n    } else {\n      try {\n        const people = await this.datasource.people.list({email: destination});\n\n        if (people.items) {\n          const {displayName} = people.items[0];\n\n          meetingTitle = displayName;\n        }\n        // eslint-disable-next-line no-empty\n      } catch (error) {}\n    }\n\n    return meetingTitle;\n  }\n\n  /**\n   * Creates meeting and returns an observable to the new meeting data.\n   *\n   * @param {string} destination Destination where to start the meeting at\n   * @returns {Observable.<Meeting>} Observable stream that emits data of the newly created meeting\n   */\n  createMeeting(destination) {\n    const newMeeting$ = from(this.datasource.meetings.create(destination)).pipe(\n      map(({id, meetingInfo: {meetingName}}) => ({\n        ID: id,\n        title: meetingName,\n        localAudio: {\n          stream: null,\n          permission: null,\n        },\n        localVideo: {\n          stream: null,\n          permission: null,\n        },\n        localShare: {\n          stream: null,\n        },\n        remoteAudio: null,\n        remoteVideo: null,\n        remoteShare: null,\n        showRoster: null,\n        settings: {\n          visible: false,\n          preview: {\n            audio: null,\n            video: null,\n          },\n        },\n        state: MeetingState.NOT_JOINED,\n        cameraID: null,\n        microphoneID: null,\n        speakerID: '',\n      })),\n      // if not provided by the sdk, compute a meeting title\n      concatMap((meeting) => (\n        meeting.title\n          ? of(meeting)\n          : from(this.fetchMeetingTitle(destination)).pipe(\n            map((title) => ({...meeting, title})),\n          )\n      )),\n    );\n\n    return newMeeting$.pipe(\n      chainWith((meeting) => this.getLocalMedia(meeting.ID).pipe(\n        map((localMedia) => ({\n          ...meeting,\n          ...localMedia,\n        })),\n      )),\n      tap((meeting) => {\n        const sdkMeeting = this.fetchMeeting(meeting.ID);\n\n        this.meetings[meeting.ID] = meeting;\n        sdkMeeting.emit(EVENT_MEETING_UPDATED, meeting);\n      }),\n      catchError((err) => {\n        logger.error('MEETING', destination, 'createMeeting()', `Unable to create a meeting with \"${destination}\"`, err);\n        throw err;\n      }),\n    );\n  }\n\n  /**\n   * Returns a SDK meeting object retrieved from the collection.\n   *\n   * @private\n   * @param {string} ID ID of the meeting to fetch.\n   * @returns {object} The SDK meeting object from the meetings collection.\n   */\n  fetchMeeting(ID) {\n    logger.debug('MEETING', ID, 'fetchMeeting()', ['called with', {ID}]);\n\n    return this.datasource.meetings.getMeetingByType('id', ID);\n  }\n\n  /**\n   * Attempts to join the meeting of the given meeting ID.\n   * If the meeting is successfully joined, a ready event is dispatched.\n   *\n   * @param {string} ID  ID of the meeting to join\n   * @param {object} [options]  Options for joining\n   * @param {string} [options.name]  Username for meeting\n   * @param {string} [options.password]  Meeting guest password\n   * @param {string} [options.hostKey]  Meeting host key\n   */\n  async joinMeeting(ID, options = {}) {\n    logger.debug('MEETING', ID, 'joinMeeting()', ['called with', {ID, options}]);\n    try {\n      const sdkMeeting = this.fetchMeeting(ID);\n\n      sdkMeeting.meetingFiniteStateMachine.reset();\n      logger.debug('MEETING', ID, 'joinMeeting()', ['calling sdkMeeting.join() with', {pin: options.password, moderator: false, name: options.name}]);\n      await sdkMeeting.join({\n        pin: options.hostKey || options.password,\n        moderator: !!(options.hostKey),\n        name: options.name,\n      });\n      logger.info('MEETING', ID, 'JOIN', 'Joining meeting');\n    } catch (error) {\n      if (error.joinIntentRequired) {\n        logger.info('MEETING', ID, 'joinMeeting()', 'Meeting requires authentication');\n\n        this.updateMeeting(ID, () => (\n          {\n            passwordRequired: true,\n            invalidPassword: !!options.password,\n            invalidHostKey: !!options.hostKey,\n          }));\n      } else {\n        logger.error('MEETING', ID, 'joinMeeting()', 'Unable to join', error);\n      }\n    }\n  }\n\n  /**\n   * Attempts to leave the meeting of the given meeting ID.\n   * If the user had left the meeting successfully, a stopped event is dispatched.\n   *\n   * @param {string} ID ID of the meeting to leave from\n   */\n  async leaveMeeting(ID) {\n    logger.debug('MEETING', ID, 'leaveMeeting()', ['called with', {ID}]);\n    try {\n      const sdkMeeting = this.fetchMeeting(ID);\n\n      this.removeMedia(ID);\n\n      logger.debug('MEETING', ID, 'leaveMeeting()', 'calling sdkMeeting.leave()');\n      await sdkMeeting.leave();\n      logger.info('MEETING', ID, 'LEAVE', 'Leaving meeting');\n    } catch (error) {\n      logger.error('MEETING', ID, 'leaveMeeting()', 'Unable to leave', error);\n    }\n  }\n\n  /**\n   * Returns the status of the specified local media (audio or video) in the form of an object\n   * with the following mutually exclusive boolean properties:\n   * - `unmuted` - the media is unmuted\n   * - `muted` - the media is muted\n   * - `muting` - the media is currently being muted\n   * - `unmuting` - the media is currently being unmuted\n   * - `disabled` - the media is disabled (there is no available media device)\n   *\n   * @param {object} localMedia  The local media object from the meeting\n   * @param {MediaStream|null} disabledLocalMedia  The disabled media stream\n   * @returns {{muting: boolean}|{unmuting: boolean}|{unmuted: boolean}|{muted: boolean}|{disabled: boolean}} The local media state\n   */\n  // eslint-disable-next-line class-methods-use-this\n  getLocalMediaState(localMedia, disabledLocalMedia) {\n    return (\n      (localMedia.muting === true && {muting: true})\n      || (localMedia.muting === false && {unmuting: true})\n      || (localMedia.stream && {unmuted: true})\n      || (disabledLocalMedia && {muted: true})\n      || {disabled: true}\n    );\n  }\n\n  /**\n   * Attempts to mute the microphone of the given meeting ID.\n   * If the microphone is successfully muted, an audio mute event is dispatched.\n   *\n   * @private\n   * @param {string} ID ID of the meeting to mute audio\n   */\n  async handleLocalAudio(ID) {\n    logger.debug('MEETING', ID, 'handleLocalAudio()', ['called with', {ID}]);\n\n    let state; // local audio state\n\n    // sanity checks and \"(un)muting in-progress\" state\n    await this.updateMeeting(ID, (meeting) => {\n      let updates;\n\n      state = this.getLocalMediaState(meeting.localAudio, meeting.disabledLocalAudio);\n\n      if (state.disabled) {\n        throw new Error('Can\\'t mute/unmute disabled audio');\n      } else if (state.muting) {\n        throw new Error('Already muting audio');\n      } else if (state.unmuting) {\n        throw new Error('Already unmuting audio');\n      } else if (state.unmuted) {\n        updates = {localAudio: {muting: true}};\n      } else if (state.muted) {\n        updates = {localAudio: {muting: false}};\n      }\n\n      return updates;\n    });\n\n    try {\n      await this.updateMeeting(ID, async (meeting, sdkMeeting) => {\n        const isInSession = !!meeting.remoteAudio;\n        let updates;\n\n        if (state.unmuted) {\n          // Mute the audio only if there is an active meeting\n          if (isInSession) {\n            logger.debug('MEETING', ID, 'handleLocalAudio()', 'calling sdkMeeting.muteAudio()');\n            await sdkMeeting.muteAudio();\n            logger.info('MEETING', ID, 'MUTE', 'Audio muted');\n          }\n\n          // Store the current local audio stream to avoid an extra request call\n          updates = {\n            disabledLocalAudio: meeting.localAudio.stream,\n            localAudio: {\n              stream: null,\n              muting: undefined,\n            },\n          };\n        } else if (state.muted) {\n          // Unmute the audio only if there is an active meeting\n          if (isInSession) {\n            logger.debug('MEETING', ID, 'handleLocalAudio()', 'calling sdkMeeting.unmuteAudio()');\n            await sdkMeeting.unmuteAudio();\n            logger.info('MEETING', ID, 'UNMUTE', 'Unmute audio');\n          }\n\n          // Retrieve the stored local audio stream\n          updates = {\n            disabledLocalAudio: null,\n            localAudio: {\n              stream: meeting.disabledLocalAudio,\n              muting: undefined,\n            },\n          };\n        }\n\n        logger.debug('MEETING', ID, 'handleLocalAudio()', ['meeting updated with localAudio', {updates}]);\n\n        return updates;\n      });\n    } catch (error) {\n      logger.error('MEETING', ID, 'handleLocalAudio()', 'Unable to update local audio settings', error);\n      this.updateMeeting(ID, () => ({localAudio: {muting: undefined}}));\n    }\n  }\n\n  /**\n   * Attempts to mute the camera of the given meeting ID.\n   * If the camera is successfully muted, a video mute event is dispatched.\n   *\n   * @private\n   * @param {string} ID ID of the meeting to mute video\n   */\n  async handleLocalVideo(ID) {\n    logger.debug('MEETING', ID, 'handleLocalVideo()', ['called with', {ID}]);\n\n    let state; // local video state\n\n    // sanity checks and \"(un)muting in-progress\" state\n    await this.updateMeeting(ID, (meeting) => {\n      let updates;\n\n      state = this.getLocalMediaState(meeting.localVideo, meeting.disabledLocalVideo);\n\n      if (state.disabled) {\n        throw new Error('Can\\'t mute/unmute disabled video');\n      } else if (state.muting) {\n        throw new Error('Already muting video');\n      } else if (state.unmuting) {\n        throw new Error('Already unmuting video');\n      } else if (state.unmuted) {\n        updates = {localVideo: {muting: true}};\n      } else if (state.muted) {\n        updates = {localVideo: {muting: false}};\n      }\n\n      return updates;\n    });\n\n    try {\n      await this.updateMeeting(ID, async (meeting, sdkMeeting) => {\n        const isInSession = !!meeting.remoteVideo;\n        let updates;\n\n        if (state.unmuted) {\n          // Mute the video only if there is an active meeting\n          if (isInSession) {\n            logger.debug('MEETING', ID, 'handleLocalVideo()', 'calling sdkMeeting.muteVideo()');\n            await sdkMeeting.muteVideo();\n            logger.info('MEETING', ID, 'MUTE', 'Video muted');\n          }\n\n          // Store the current local video stream to avoid an extra request call\n          updates = {\n            disabledLocalVideo: meeting.localVideo.stream,\n            localVideo: {\n              stream: null,\n              muting: undefined,\n            },\n          };\n        } else if (state.muted) {\n          // Unmute the video only if there is an active meeting\n          if (isInSession) {\n            logger.debug('MEETING', ID, 'handleLocalVideo()', 'calling sdkMeeting.unmuteVideo()');\n            await sdkMeeting.unmuteVideo();\n            logger.info('MEETING', ID, 'UNMUTE', 'Unmute video');\n          }\n\n          // Retrieve the stored local video stream\n          updates = {\n            disabledLocalVideo: null,\n            localVideo: {\n              stream: meeting.disabledLocalVideo,\n              muting: undefined,\n            },\n          };\n        }\n\n        logger.debug('MEETING', ID, 'handleLocalVideo()', ['meeting updated with localVideo', {updates}]);\n\n        return updates;\n      });\n    } catch (error) {\n      logger.error('MEETING', ID, 'handleLocalVideo()', 'Unable to update local video settings', error);\n      this.updateMeeting(ID, () => ({localVideo: {muting: undefined}}));\n    }\n  }\n\n  /**\n   * Attempts to start/stop screen sharing to the given meeting ID.\n   * If successful, a sharing start/stop event is dispatched.\n   *\n   * @private\n   * @param {string} ID ID of the meeting to start/stop sharing\n   */\n  async handleLocalShare(ID) {\n    logger.debug('MEETING', ID, 'handleLocalShare()', ['called with', {ID}]);\n    await this.updateMeeting(ID, async (meeting, sdkMeeting) => {\n      let updates;\n\n      const handleSdkError = (error) => {\n        logger.warn('MEETING', ID, 'handleLocalShare()', 'Unable to update local share stream', error);\n\n        this.stopStream(meeting.localShare.stream);\n        updates = {localShare: {stream: null}};\n        this.updateMeeting(ID, async () => ({localShare: {stream: null}}));\n      };\n\n      //\n      // Workflow:\n      // To enable or to disable the local sharing stream based on toggle state.\n      // Will stop sharing stream and reset UI state when error happens\n      //\n      if (!sdkMeeting.canUpdateMedia()) {\n        logger.error('MEETING', ID, 'handleLocalShare()', 'Unable to update screen share due to unstable connection.');\n      } else if (meeting.localShare.stream) {\n        this.stopStream(meeting.localShare.stream);\n\n        sdkMeeting.updateShare({sendShare: false, receiveShare: true}).catch(handleSdkError);\n        logger.info('MEETING', ID, 'UNSHARE', 'Stopping sharing');\n\n        updates = {localShare: {stream: null}};\n      } else {\n        const [, localShare] = await sdkMeeting.getMediaStreams({sendShare: true});\n\n        sdkMeeting.updateShare({\n          stream: localShare,\n          sendShare: true,\n          receiveShare: true,\n        }).catch(handleSdkError);\n\n        logger.info('MEETING', ID, 'SHARE', 'Starting sharing');\n\n        updates = {localShare: {stream: localShare}};\n      }\n\n      logger.debug('MEETING', ID, 'handleLocalShare()', ['meeting updated with localShare', {updates}]);\n\n      return updates;\n    });\n  }\n\n  /**\n   * Attempts to toggle roster to the given meeting ID.\n   * A roster toggle event is dispatched.\n   *\n   * @param {string} ID ID of the meeting to toggle roster\n   */\n  toggleRoster(ID) {\n    logger.debug('MEETING', ID, 'toggleRoster()', ['called with', {ID}]);\n    logger.info('MEETING', ID, 'TOOGLE ROSTER', 'Opening meeting participants panel');\n\n    return this.updateMeeting(ID, ({showRoster}) => ({showRoster: !showRoster}));\n  }\n\n  /**\n   * Toggles the settings.visible flag of the given meeting ID.\n   * A settings toggle event is dispatched.\n   *\n   * @param {string} ID  Meeting ID\n   */\n  async toggleSettings(ID) {\n    logger.debug('MEETING', ID, 'toggleSettings()', ['called with', {ID}]);\n    await this.updateMeeting(ID, async (meeting, sdkMeeting) => {\n      let updates;\n      const openingSettings = !meeting.settings.visible;\n\n      if (openingSettings) {\n        logger.info('MEETING', ID, 'TOOGLE SETTINGS', 'Opening settings modal');\n        // Populate the preview streams with clones of the meeting streams\n        // so that switching cameras/microphones in preview doesn't stop the meeting streams.\n        // If the camera or microphone are muted, start them for the preview.\n        const videoStream = meeting.localVideo.stream || meeting.disabledLocalVideo;\n        const audioStream = meeting.localAudio.stream || meeting.disabledLocalAudio;\n\n        updates = {\n          settings: {\n            visible: true,\n            preview: {\n              video: videoStream && videoStream.clone(),\n              audio: audioStream && audioStream.clone(),\n            },\n          },\n        };\n      } else {\n        logger.info('MEETING', ID, 'TOOGLE SETTINGS', 'Closing settings modal');\n        // When closing settings, stop the existing meeting streams\n        // and replace them with the last preview streams.\n        this.stopStream(meeting.localVideo.stream);\n        this.stopStream(meeting.localAudio.stream);\n        updates = {\n          settings: {\n            visible: false,\n          },\n          localVideo: {\n            stream: meeting.localVideo.stream && meeting.settings.preview.video,\n          },\n          disabledLocalVideo: meeting.disabledLocalVideo && meeting.settings.preview.video,\n          localAudio: {\n            stream: meeting.localAudio.stream && meeting.settings.preview.audio,\n          },\n          disabledLocalAudio: meeting.disabledLocalAudio && meeting.settings.preview.audio,\n        };\n\n        if (meeting.state === MeetingState.JOINED) {\n          if (meeting.settings.preview.video) {\n            await sdkMeeting.updateVideo({\n              stream: meeting.settings.preview.video,\n              receiveVideo: mediaSettings.receiveVideo,\n              sendVideo: mediaSettings.sendVideo,\n            });\n          }\n\n          if (meeting.settings.preview.audio) {\n            await sdkMeeting.updateAudio({\n              stream: meeting.settings.preview.audio,\n              receiveAudio: mediaSettings.receiveAudio,\n              sendAudio: mediaSettings.sendAudio,\n            });\n          }\n        }\n      }\n\n      logger.debug('MEETING', ID, 'toggleSettings()', ['meeting updated with toggleSettings', {updates}]);\n\n      return updates;\n    });\n  }\n\n  /**\n   * Switches the camera control.\n   *\n   * @param {string} ID Meeting ID\n   * @param {string} cameraID ID of the camera to switch to\n   */\n  async switchCamera(ID, cameraID) {\n    logger.debug('MEETING', ID, 'switchCamera()', ['called with', {ID, cameraID}]);\n    logger.info('MEETING', ID, 'SWITCH CAMERA', `Switching current camera to camera with id \"${cameraID}\"`);\n    await this.updateMeeting(ID, async (meeting) => {\n      let updates;\n\n      this.stopStream(meeting.settings.preview.video);\n      const {stream, permission, deviceId} = await this.getStream(\n        ID,\n        {sendVideo: true},\n        {video: {deviceId: cameraID}},\n      ).toPromise();\n\n      if (stream) {\n        updates = {\n          settings: {\n            preview: {\n              video: stream,\n            },\n          },\n          cameraID: deviceId,\n        };\n      } else {\n        throw new Error(`Could not change camera, permission not granted: ${permission}`);\n      }\n\n      logger.debug('MEETING', ID, 'switchCamera()', ['meeting update with switchCamera', {updates}]);\n\n      return updates;\n    });\n  }\n\n  /**\n   * Switches the microphone control.\n   *\n   * @param {string} ID Meeting ID\n   * @param {string} microphoneID ID of the microphone to switch to\n   */\n  async switchMicrophone(ID, microphoneID) {\n    logger.debug('MEETING', ID, 'switchMicrophone()', ['called with', {ID, microphoneID}]);\n    logger.info('MEETING', ID, 'SWITCH MICROPHONE', `Switching current microphone to microphone with id \"${microphoneID}\"`);\n    await this.updateMeeting(ID, async (meeting) => {\n      let updates;\n\n      this.stopStream(meeting.settings.preview.audio);\n      const {stream, permission, deviceId} = await this.getStream(\n        ID,\n        {sendAudio: true},\n        {audio: {deviceId: microphoneID}},\n      ).toPromise();\n\n      if (stream) {\n        updates = {\n          settings: {\n            preview: {\n              audio: stream,\n            },\n          },\n          microphoneID: deviceId,\n        };\n      } else {\n        throw new Error(`Could not change microphone, permission not granted: ${permission}`);\n      }\n\n      logger.debug('MEETING', ID, 'switchMicrophone()', ['meeting update with switchMicrophone', {updates}]);\n\n      return updates;\n    });\n  }\n\n  /**\n   * Switches the layout control.\n   *\n   * @async\n   * @param {string} ID  Meeting ID\n   * @param {string} layoutType  Type of layout\n   * @returns {Promise}  Resolves when the layout has been changed\n   */\n  async changeLayout(ID, layoutType) {\n    const sdkMeeting = this.fetchMeeting(ID);\n\n    await sdkMeeting.changeVideoLayout(LAYOUT_TYPES_MAP[layoutType]);\n  }\n\n  /**\n   * Switches the speaker control.\n   *\n   * @param {string} ID  Meeting ID\n   * @param {string} speakerID  ID of the speaker device to switch to\n   * @private\n   */\n  async switchSpeaker(ID, speakerID) {\n    logger.debug('MEETING', ID, 'switchSpeaker()', ['called with', {ID, speakerID}]);\n    logger.info('MEETING', ID, 'SWITCH SPEAKER', `Switching current speaker to speaker with id \"${speakerID}\"`);\n\n    return this.updateMeeting(ID, () => ({speakerID}));\n  }\n\n  /**\n   * Allows user to join meeting without allowing camera access\n   *\n   * @param {string}  ID Meeting ID\n   */\n  ignoreVideoAccessPrompt(ID) {\n    logger.debug('MEETING', ID, 'ignoreVideoAccessPrompt()', ['called with', {ID}]);\n    const meeting = this.meetings[ID];\n\n    if (meeting.localVideo.ignoreMediaAccessPrompt) {\n      logger.info('MEETING', ID, 'PROCEED WITHOUT CAMERA', 'Allow to join the meeting without camera access');\n      meeting.localVideo.ignoreMediaAccessPrompt();\n    } else {\n      logger.error('MEETING', ID, 'ignoreVideoAccessPrompt()', `Can not ignore video prompt in current state: \"${meeting.localVideo.permission}\"`);\n    }\n  }\n\n  /**\n   * Allows user to join meeting without allowing microphone access\n   *\n   * @param {string} ID  Meeting ID\n   */\n  ignoreAudioAccessPrompt(ID) {\n    logger.debug('MEETING', ID, 'ignoreAudioAccessPrompt()', ['called with', {ID}]);\n    const meeting = this.meetings[ID];\n\n    if (meeting.localAudio.ignoreMediaAccessPrompt) {\n      logger.info('MEETING', ID, 'PROCEED WITHOUT MICROPHONE', 'Allow to join the meeting without microphone access');\n      meeting.localAudio.ignoreMediaAccessPrompt();\n    } else {\n      logger.error('MEETING', ID, 'ignoreAudioAccessPrompt()', `Can not ignore audio prompt in current state: \"${meeting.localAudio.permission}\"`);\n    }\n  }\n\n  /**\n   * Sends the local media streams to the SDK\n   *\n   * @async\n   * @private\n   * @param {string} ID  Meeting id\n   * @returns {Promise} Resolves when the local media streams have been successfully sent to the SDK.\n   */\n  async addMedia(ID) {\n    logger.debug('MEETING', ID, 'addMedia()', ['called with', {ID}]);\n    const sdkMeeting = this.fetchMeeting(ID);\n    const localStream = new MediaStream();\n    const localAudio = this.meetings[ID].localAudio.stream\n      || this.meetings[ID].disabledLocalAudio;\n    const localVideo = this.meetings[ID].localVideo.stream\n      || this.meetings[ID].disabledLocalVideo;\n\n    if (localAudio) {\n      localAudio.getAudioTracks().forEach((track) => localStream.addTrack(track));\n    }\n\n    if (localVideo) {\n      localVideo.getVideoTracks().forEach((track) => localStream.addTrack(track));\n    }\n\n    logger.debug('MEETING', ID, 'addMedia()', ['calling sdkMeeting.addMedia()', {localStream, mediaSettings}]);\n    await sdkMeeting.addMedia({localStream, mediaSettings});\n\n    if (!this.meetings[ID].localAudio.stream) {\n      logger.debug('MEETING', ID, 'addMedia()', 'calling sdkMeeting.muteAudio()');\n      await sdkMeeting.muteAudio();\n    }\n\n    if (!this.meetings[ID].localVideo.stream) {\n      logger.debug('MEETING', ID, 'addMedia()', 'calling sdkMeeting.muteVideo()');\n      await sdkMeeting.muteVideo();\n    }\n  }\n\n  /**\n   * Returns an observable that emits meeting data of the given ID.\n   *\n   * @param {string} ID ID of meeting to get\n   * @returns {Observable.<Meeting>} Observable stream that emits meeting data of the given ID\n   */\n  getMeeting(ID) {\n    logger.debug('MEETING', ID, 'getMeeting()', ['called with', {ID}]);\n    if (!(ID in this.getMeetingObservables)) {\n      const sdkMeeting = this.fetchMeeting(ID);\n      const getMeeting$ = Observable.create((observer) => {\n        if (sdkMeeting && this.meetings[ID]) {\n          logger.debug('MEETING', ID, 'getMeeting()', ['initial meeting object', this.meetings[ID]]);\n          observer.next(this.meetings[ID]);\n          observer.complete();\n        } else {\n          logger.error('MEETING', ID, 'getMeeting()', `Could not find meeting with ID \"${ID}\"`);\n          observer.error(new Error(`Could not find meeting with ID \"${ID}\"`));\n        }\n      });\n\n      const meetingUpdateEvent$ = fromEvent(sdkMeeting, EVENT_MEETING_UPDATED).pipe(\n        tap(() => logger.debug('MEETING', ID, 'getMeeting()', ['received', EVENT_MEETING_UPDATED, 'event'])),\n        tap((meeting) => {\n          this.meetings[ID] = meeting;\n        }),\n      );\n\n      const meetingWithMediaReadyEvent$ = fromEvent(sdkMeeting, EVENT_MEDIA_READY).pipe(\n        tap(() => {\n          logger.debug('MEETING', ID, 'getMeeting()', ['received', EVENT_MEDIA_READY, 'event']);\n        }),\n        filter((event) => MEDIA_EVENT_TYPES.includes(event.type)),\n        map((event) => this.attachMedia(ID, event)),\n      );\n\n      const meetingWithMediaStoppedEvent$ = fromEvent(sdkMeeting, EVENT_MEDIA_STOPPED).pipe(\n        tap(() => {\n          logger.debug('MEETING', ID, 'getMeeting()', ['received', EVENT_MEDIA_STOPPED, 'event']);\n          this.removeMedia(ID);\n        }),\n      );\n\n      const meetingWithMediaShareEvent$ = fromEvent(sdkMeeting, EVENT_REMOTE_SHARE_START).pipe(\n        tap(() => {\n          logger.debug('MEETING', ID, 'getMeeting()', ['received', EVENT_REMOTE_SHARE_START, 'event']);\n          this.attachMedia(ID, {type: EVENT_REMOTE_SHARE_START});\n        }),\n      );\n\n      const meetingWithMediaStoppedShareEvent$ = fromEvent(sdkMeeting, EVENT_REMOTE_SHARE_STOP)\n        .pipe(\n          tap(() => {\n            logger.debug('MEETING', ID, 'getMeeting()', ['received', EVENT_REMOTE_SHARE_STOP, 'event']);\n            this.attachMedia(ID, {type: EVENT_REMOTE_SHARE_STOP});\n          }),\n        );\n\n      const meetingWithLocalShareStoppedEvent$ = fromEvent(sdkMeeting, EVENT_LOCAL_SHARE_STOP).pipe(\n        tap(() => {\n          logger.debug('MEETING', ID, 'getMeeting()', ['received', EVENT_LOCAL_SHARE_STOP, 'event']);\n          this.stopStream(this.meetings[ID].localShare.stream);\n          this.meetings[ID].localShare.stream = null;\n        }),\n      );\n\n      const meetingWithLocalShareStartedEvent$ = fromEvent(sdkMeeting, EVENT_LOCAL_SHARE_START)\n        .pipe(\n          tap(() => {\n            logger.debug('MEETING', ID, 'getMeeting()', ['received', EVENT_LOCAL_SHARE_START, 'event']);\n          }),\n        );\n\n      const meetingWithSwitchCameraEvent$ = fromEvent(sdkMeeting, EVENT_CAMERA_SWITCH).pipe(\n        tap(() => {\n          logger.debug('MEETING', ID, 'getMeeting()', ['received', EVENT_CAMERA_SWITCH, 'event']);\n        }),\n      );\n\n      const meetingWithSwitchMicrophoneEvent$ = fromEvent(sdkMeeting, EVENT_MICROPHONE_SWITCH).pipe(\n        tap(() => {\n          logger.debug('MEETING', ID, 'getMeeting()', ['received', EVENT_MICROPHONE_SWITCH, 'event']);\n        }),\n      );\n\n      const meetingStateChange$ = fromEvent(sdkMeeting && sdkMeeting.members, EVENT_MEMBERS_UPDATE)\n        .pipe(\n          map((event) => {\n            logger.debug('MEETING', ID, 'getMeeting()', ['received', EVENT_MEMBERS_UPDATE, 'event']);\n            const self = Object.values(event.full).find((m) => m.isSelf);\n\n            return SDK_MEMBER_STATUS_TO_ADAPTER_MEETING_STATE[self && self.status]\n              || MeetingState.NOT_JOINED;\n          }),\n          distinctUntilChanged(),\n          tap((state) => {\n            logger.debug('MEETING', ID, 'getMeeting()', ['changing meeting state to', state]);\n            this.meetings[ID] = {...this.meetings[ID], state};\n            if (state === MeetingState.JOINED) {\n              // do not await on this, otherwise the emitted message won't contain an updated state\n              this.addMedia(ID).catch((error) => {\n                logger.error('MEETING', ID, 'getMeeting()', 'Unable to add media', error);\n              });\n            }\n          }),\n        );\n\n      const meetingsWithEvents$ = merge(\n        meetingUpdateEvent$,\n        meetingWithMediaReadyEvent$,\n        meetingWithMediaStoppedEvent$,\n        meetingWithLocalShareStoppedEvent$,\n        meetingWithMediaShareEvent$,\n        meetingWithMediaStoppedShareEvent$,\n        meetingStateChange$,\n        meetingWithSwitchCameraEvent$,\n        meetingWithSwitchMicrophoneEvent$,\n        meetingWithLocalShareStartedEvent$,\n      ).pipe(map(() => this.meetings[ID])); // Return a meeting object from event\n\n      const getMeetingWithEvents$ = concat(getMeeting$, meetingsWithEvents$);\n\n      // Convert to a multicast observable\n      this.getMeetingObservables[ID] = getMeetingWithEvents$.pipe(\n        publishReplay(1),\n        refCount(),\n        takeWhile((meeting) => meeting.state && meeting.state !== MeetingState.LEFT, true),\n        tap(() => {\n          logger.debug('MEETING', ID, 'getMeeting()', ['emitting', this.meetings[ID]]);\n        }),\n      );\n    }\n\n    return this.getMeetingObservables[ID];\n  }\n\n  /**\n   * A callback that returns an updated meeting\n   *\n   * @callback UpdateMeetingCallback\n   * @param {Meeting} meeting  Original meeting object\n   * @returns {Promise<Meeting>} Updated meeting object\n   */\n\n  /**\n   * Updates a meeting and notifies listeners\n   *\n   * @private\n   * @async\n   * @param {string} ID  Id of the meeting to update.\n   * @param {UpdateMeetingCallback} updater  Function to update the meeting\n   */\n\n  async updateMeeting(ID, updater) {\n    logger.debug('MEETING', ID, 'updateMeeting()', ['called with', {ID, updater}]);\n    const sdkMeeting = this.fetchMeeting(ID);\n    const meeting = this.meetings[ID];\n\n    if (!sdkMeeting || !meeting) {\n      throw new Error(`Could not find meeting with ID \"${ID}\"`);\n    }\n\n    const updates = await updater(meeting, sdkMeeting);\n\n    deepMerge(meeting, updates);\n\n    logger.debug('MEETING', ID, 'updateMeeting()', ['meeting updated with', EVENT_MEETING_UPDATED, 'event', 'meeting object', {meeting}]);\n    sdkMeeting.emit(EVENT_MEETING_UPDATED, meeting);\n  }\n\n  /**\n   * Displays the names of the available controls.\n   *\n   * @returns {string[]} Array containing the control names supported.\n   */\n  supportedControls() {\n    return Object.keys(this.meetingControls);\n  }\n\n  /**\n   * Displays the available layout types.\n   *\n   * @returns {string[]} Array containing the layout types.\n   */\n  // eslint-disable-next-line class-methods-use-this\n  getLayoutTypes() {\n    return Object.keys(LAYOUT_TYPES_MAP);\n  }\n\n  /**\n   * Clears the password required flag.\n   *\n   * @async\n   * @param {string} ID  Id of the meeting\n   */\n  async clearPasswordRequiredFlag(ID) {\n    logger.debug('MEETING', ID, 'clearPasswordRequiredFlag()', ['called with', {ID}]);\n    await this.updateMeeting(ID, async () => ({passwordRequired: false}));\n  }\n\n  /**\n   * Sets the invalidPassword flag to false.\n   *\n   * @async\n   * @param {string} ID  Id of the meeting\n   */\n  async clearInvalidPasswordFlag(ID) {\n    logger.debug('MEETING', ID, 'clearInvalidPasswordFlag()', ['called with', {ID}]);\n    await this.updateMeeting(ID, async () => ({invalidPassword: false}));\n  }\n\n  /**\n   * Sets the invalidHostKey flag to false.\n   *\n   * @async\n   * @param {string} ID  Id of the meeting\n   */\n  async clearInvalidHostKeyFlag(ID) {\n    await this.updateMeeting(ID, async () => ({invalidHostKey: false}));\n  }\n}\n","// https://github.com/zloirock/core-js/issues/86#issuecomment-115759028\nvar global = module.exports = typeof window != 'undefined' && window.Math == Math\n  ? window : typeof self != 'undefined' && self.Math == Math ? self\n  // eslint-disable-next-line no-new-func\n  : Function('return this')();\nif (typeof __g == 'number') __g = global; // eslint-disable-line no-undef\n","var core = module.exports = { version: '2.6.12' };\nif (typeof __e == 'number') __e = core; // eslint-disable-line no-undef\n","module.exports = function (it) {\n  if (typeof it != 'function') throw TypeError(it + ' is not a function!');\n  return it;\n};\n","// optional / simple context binding\nvar aFunction = require('./_a-function');\nmodule.exports = function (fn, that, length) {\n  aFunction(fn);\n  if (that === undefined) return fn;\n  switch (length) {\n    case 1: return function (a) {\n      return fn.call(that, a);\n    };\n    case 2: return function (a, b) {\n      return fn.call(that, a, b);\n    };\n    case 3: return function (a, b, c) {\n      return fn.call(that, a, b, c);\n    };\n  }\n  return function (/* ...args */) {\n    return fn.apply(that, arguments);\n  };\n};\n","module.exports = function (it) {\n  return typeof it === 'object' ? it !== null : typeof it === 'function';\n};\n","var isObject = require('./_is-object');\nmodule.exports = function (it) {\n  if (!isObject(it)) throw TypeError(it + ' is not an object!');\n  return it;\n};\n","module.exports = function (exec) {\n  try {\n    return !!exec();\n  } catch (e) {\n    return true;\n  }\n};\n","// Thank's IE8 for his funny defineProperty\nmodule.exports = !require('./_fails')(function () {\n  return Object.defineProperty({}, 'a', { get: function () { return 7; } }).a != 7;\n});\n","var isObject = require('./_is-object');\nvar document = require('./_global').document;\n// typeof document.createElement is 'object' in old IE\nvar is = isObject(document) && isObject(document.createElement);\nmodule.exports = function (it) {\n  return is ? document.createElement(it) : {};\n};\n","module.exports = !require('./_descriptors') && !require('./_fails')(function () {\n  return Object.defineProperty(require('./_dom-create')('div'), 'a', { get: function () { return 7; } }).a != 7;\n});\n","// 7.1.1 ToPrimitive(input [, PreferredType])\nvar isObject = require('./_is-object');\n// instead of the ES6 spec version, we didn't implement @@toPrimitive case\n// and the second argument - flag - preferred type is a string\nmodule.exports = function (it, S) {\n  if (!isObject(it)) return it;\n  var fn, val;\n  if (S && typeof (fn = it.toString) == 'function' && !isObject(val = fn.call(it))) return val;\n  if (typeof (fn = it.valueOf) == 'function' && !isObject(val = fn.call(it))) return val;\n  if (!S && typeof (fn = it.toString) == 'function' && !isObject(val = fn.call(it))) return val;\n  throw TypeError(\"Can't convert object to primitive value\");\n};\n","var anObject = require('./_an-object');\nvar IE8_DOM_DEFINE = require('./_ie8-dom-define');\nvar toPrimitive = require('./_to-primitive');\nvar dP = Object.defineProperty;\n\nexports.f = require('./_descriptors') ? Object.defineProperty : function defineProperty(O, P, Attributes) {\n  anObject(O);\n  P = toPrimitive(P, true);\n  anObject(Attributes);\n  if (IE8_DOM_DEFINE) try {\n    return dP(O, P, Attributes);\n  } catch (e) { /* empty */ }\n  if ('get' in Attributes || 'set' in Attributes) throw TypeError('Accessors not supported!');\n  if ('value' in Attributes) O[P] = Attributes.value;\n  return O;\n};\n","module.exports = function (bitmap, value) {\n  return {\n    enumerable: !(bitmap & 1),\n    configurable: !(bitmap & 2),\n    writable: !(bitmap & 4),\n    value: value\n  };\n};\n","var dP = require('./_object-dp');\nvar createDesc = require('./_property-desc');\nmodule.exports = require('./_descriptors') ? function (object, key, value) {\n  return dP.f(object, key, createDesc(1, value));\n} : function (object, key, value) {\n  object[key] = value;\n  return object;\n};\n","var hasOwnProperty = {}.hasOwnProperty;\nmodule.exports = function (it, key) {\n  return hasOwnProperty.call(it, key);\n};\n","var global = require('./_global');\nvar core = require('./_core');\nvar ctx = require('./_ctx');\nvar hide = require('./_hide');\nvar has = require('./_has');\nvar PROTOTYPE = 'prototype';\n\nvar $export = function (type, name, source) {\n  var IS_FORCED = type & $export.F;\n  var IS_GLOBAL = type & $export.G;\n  var IS_STATIC = type & $export.S;\n  var IS_PROTO = type & $export.P;\n  var IS_BIND = type & $export.B;\n  var IS_WRAP = type & $export.W;\n  var exports = IS_GLOBAL ? core : core[name] || (core[name] = {});\n  var expProto = exports[PROTOTYPE];\n  var target = IS_GLOBAL ? global : IS_STATIC ? global[name] : (global[name] || {})[PROTOTYPE];\n  var key, own, out;\n  if (IS_GLOBAL) source = name;\n  for (key in source) {\n    // contains in native\n    own = !IS_FORCED && target && target[key] !== undefined;\n    if (own && has(exports, key)) continue;\n    // export native or passed\n    out = own ? target[key] : source[key];\n    // prevent global pollution for namespaces\n    exports[key] = IS_GLOBAL && typeof target[key] != 'function' ? source[key]\n    // bind timers to global for call from export context\n    : IS_BIND && own ? ctx(out, global)\n    // wrap global constructors for prevent change them in library\n    : IS_WRAP && target[key] == out ? (function (C) {\n      var F = function (a, b, c) {\n        if (this instanceof C) {\n          switch (arguments.length) {\n            case 0: return new C();\n            case 1: return new C(a);\n            case 2: return new C(a, b);\n          } return new C(a, b, c);\n        } return C.apply(this, arguments);\n      };\n      F[PROTOTYPE] = C[PROTOTYPE];\n      return F;\n    // make static versions for prototype methods\n    })(out) : IS_PROTO && typeof out == 'function' ? ctx(Function.call, out) : out;\n    // export proto methods to core.%CONSTRUCTOR%.methods.%NAME%\n    if (IS_PROTO) {\n      (exports.virtual || (exports.virtual = {}))[key] = out;\n      // export proto methods to core.%CONSTRUCTOR%.prototype.%NAME%\n      if (type & $export.R && expProto && !expProto[key]) hide(expProto, key, out);\n    }\n  }\n};\n// type bitmap\n$export.F = 1;   // forced\n$export.G = 2;   // global\n$export.S = 4;   // static\n$export.P = 8;   // proto\n$export.B = 16;  // bind\n$export.W = 32;  // wrap\n$export.U = 64;  // safe\n$export.R = 128; // real proto method for `library`\nmodule.exports = $export;\n","var $export = require('./_export');\n// 19.1.2.4 / 15.2.3.6 Object.defineProperty(O, P, Attributes)\n$export($export.S + $export.F * !require('./_descriptors'), 'Object', { defineProperty: require('./_object-dp').f });\n","require('../../modules/es6.object.define-property');\nvar $Object = require('../../modules/_core').Object;\nmodule.exports = function defineProperty(it, key, desc) {\n  return $Object.defineProperty(it, key, desc);\n};\n","module.exports = require(\"core-js/library/fn/object/define-property\");","\"use strict\";\n\nvar _Object$defineProperty = require(\"@babel/runtime-corejs2/core-js/object/define-property\");\n\n_Object$defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nexports.INTERNAL_US_INTEGRATION_CLUSTER_NAME = exports.INTERNAL_US_CLUSTER_NAME = exports.deviceType = exports.hydraTypes = exports.SDK_EVENT = void 0;\nvar SDK_EVENT = {\n  INTERNAL: {\n    WEBEX_ACTIVITY: 'event:conversation.activity',\n    ACTIVITY_FIELD: {\n      ACTOR: 'actor',\n      OBJECT: 'object',\n      TARGET: 'target'\n    },\n    ACTIVITY_VERB: {\n      ACKNOWLEDGE: 'acknowledge',\n      CARD_ACTION: 'cardAction',\n      CREATE: 'create',\n      POST: 'post',\n      SHARE: 'share',\n      DELETE: 'delete',\n      ADD: 'add',\n      LEAVE: 'leave',\n      ADD_MODERATOR: 'assignModerator',\n      REMOVE_MODERATOR: 'unassignModerator',\n      LOCK: 'lock',\n      UNLOCK: 'unlock',\n      HIDE: 'hide',\n      UPDATE: 'update'\n    },\n    ACTIVITY_TAG: {\n      HIDDEN: 'HIDDEN',\n      ONE_ON_ONE: 'ONE_ON_ONE',\n      LOCKED: 'LOCKED'\n    }\n  },\n  EXTERNAL: {\n    EVENT_TYPE: {\n      CREATED: 'created',\n      DELETED: 'deleted',\n      UPDATED: 'updated',\n      SEEN: 'seen'\n    },\n    OWNER: {\n      CREATOR: 'creator',\n      ORG: 'org'\n    },\n    STATUS: {\n      ACTIVE: 'active',\n      DISABLED: 'disabled'\n    },\n    SPACE_TYPE: {\n      DIRECT: 'direct',\n      GROUP: 'group'\n    },\n    RESOURCE: {\n      ATTACHMENT_ACTIONS: 'attachmentActions',\n      MEMBERSHIPS: 'memberships',\n      MESSAGES: 'messages',\n      ROOMS: 'rooms'\n    },\n    ATTACHMENTS: {\n      CARD_CONTENT_TYPE: 'application/vnd.microsoft.card.adaptive'\n    }\n  }\n};\nexports.SDK_EVENT = SDK_EVENT;\nvar hydraTypes = {\n  ATTACHMENT_ACTION: 'ATTACHMENT_ACTION',\n  CONTENT: 'CONTENT',\n  MEMBERSHIP: 'MEMBERSHIP',\n  MESSAGE: 'MESSAGE',\n  ORGANIZATION: 'ORGANIZATION',\n  PEOPLE: 'PEOPLE',\n  ROOM: 'ROOM',\n  TEAM: 'TEAM'\n};\nexports.hydraTypes = hydraTypes;\nvar deviceType = {\n  PROVISIONAL: 'PROVISIONAL',\n  WEB: 'WEB'\n};\nexports.deviceType = deviceType;\nvar INTERNAL_US_CLUSTER_NAME = 'urn:TEAM:us-east-2_a';\nexports.INTERNAL_US_CLUSTER_NAME = INTERNAL_US_CLUSTER_NAME;\nvar INTERNAL_US_INTEGRATION_CLUSTER_NAME = 'urn:TEAM:us-east-1_int13';\nexports.INTERNAL_US_INTEGRATION_CLUSTER_NAME = INTERNAL_US_INTEGRATION_CLUSTER_NAME;\n//# sourceMappingURL=constants.js.map\n","import {\n  BehaviorSubject,\n  combineLatest,\n  concat,\n  defer,\n  from,\n  fromEvent,\n  merge,\n  throwError,\n} from 'rxjs';\nimport {\n  filter,\n  finalize,\n  map,\n  mergeMap,\n  publishReplay,\n  refCount,\n  tap,\n} from 'rxjs/operators';\nimport {SDK_EVENT, constructHydraId, deconstructHydraId} from '@webex/common';\nimport {\n  DestinationType,\n  MembershipsAdapter,\n} from '@webex/component-adapter-interfaces';\nimport {hydraTypes} from '@webex/common/dist/constants';\nimport logger from './logger';\nimport {name, version} from '../package.json';\n\nconst LOG_ARGS = ['SDK-MEMBERSHIPS', `${name}-${version}`];\n\n// max parameter value must be greater than 0 and less than or equal to 1000\nconst MAX_MEMBERSHIPS = 1000;\n\n// TODO: Figure out how to import JS Doc definitions and remove duplication.\n/**\n * A Member object that is part of a membership\n *\n * @external Member\n * @see {@link https://github.com/webex/component-adapter-interfaces/blob/master/src/MembershipsAdapter.js#L6}\n */\n\n/**\n * Sort the members alphabetically, with the current user first\n *\n * @param {Array} members List of sdk meeting members\n * @returns {Array} Sorted list of sdk meeting members\n */\nfunction sortMeetingMembers(members) {\n  logger.debug(...LOG_ARGS, 'sortMeetingMembers()', ['called with', {members}]);\n\n  return members.sort((member1, member2) => (\n    /* eslint-disable no-nested-ternary, indent */\n    member1.isSelf ? -1 // current user comes first\n    : member2.isSelf ? +1\n    : !member1.name ? +1 // empty names come last\n    : !member2.name ? -1\n    : member1.name.localeCompare(member2.name))); // alphabetical order\n    /* eslint-enable no-nested-ternary, indent */\n}\n\n/**\n * A Webex user.\n *\n * @external Person\n * @see {@link https://github.com/webex/component-adapter-interfaces/blob/master/src/PeopleAdapter.js#L6}\n */\n\n/**\n * Sort a memberships list alphabetically, with the current user first\n *\n * @param {Array} memberships List of sdk memberships\n * @param {string} myID Id of the current user\n * @returns {Array} Sorted list of sdk memberships\n */\nfunction sortRoomMembers(memberships, myID) {\n  logger.debug(...LOG_ARGS, 'sortRoomMembers()', ['called with', {memberships, myID}]);\n\n  return memberships.sort((m1, m2) => (\n    /* eslint-disable no-nested-ternary, indent */\n    m1.personId === myID ? -1 // current user comes first\n    : m2.personId === myID ? 1\n    : !m2.personDisplayName ? -1 // empty names come last\n    : !m1.personDisplayName ? 1\n    : m1.personDisplayName.localeCompare(m2.personDisplayName))); // alphabetical order\n    /* eslint-enable no-nested-ternary, indent */\n}\n\n/**\n * Maps SDK members to adapter members\n *\n * @private\n * @param {object} sdkMembers  Members object from sdk meeting, keyed by ID\n * @param {object} meeting  Sdk meeting object\n * @returns {Array.<Member>} List of meeting members\n */\nfunction getMembers(sdkMembers, meeting) {\n  logger.debug(...LOG_ARGS, 'getMembers()', ['called with', {sdkMembers, meeting}]);\n  let members = Object.values(sdkMembers || {});\n\n  members = sortMeetingMembers(members);\n\n  return members.map((member) => ({\n    ID:\n      member.participant\n      && member.participant.person\n      && constructHydraId(hydraTypes.PEOPLE, member.participant.person.id),\n    orgID:\n      member.participant\n      && member.participant.person\n      && member.participant.person.orgId\n      && constructHydraId(hydraTypes.ORGANIZATION, member.participant.person.orgId),\n    inMeeting: member.isInMeeting,\n    muted: member.isAudioMuted,\n    sharing: member.isContentSharing,\n    host: !!meeting.meetingInfo.isWebexScheduled && member.isModerator,\n    guest: member.isGuest,\n  }));\n}\n\n/**\n * The `MembershipsSDKAdapter` is an implementation of the `MembershipsAdapter` interface.\n * This adapter utilizes the Webex JS SDK to fetch data about a memberships.\n *\n * @implements {MembershipsAdapter}\n */\nexport default class MembershipsSDKAdapter extends MembershipsAdapter {\n  constructor(datasource) {\n    super(datasource);\n\n    logger.debug(...LOG_ARGS, 'constructor()', 'instantiating membership sdk adapter');\n\n    this.members$ = {}; // cache membership observables based on membership id\n    this.listenerCount = 0;\n  }\n\n  /**\n   * Tells the SDK to start listening to memberships events and tracks the amount of calls.\n   *\n   * Note: Since the SDK listens to ALL memberships events, this function only\n   * calls the SDK's `memberships.listen` function on the first membership to listen.\n   * Repeated calls to `memberships.listen` are not needed afterwards.\n   *\n   * @private\n   */\n  startListeningToMembershipsUpdates() {\n    logger.debug(...LOG_ARGS, 'startListeningToMembershipsUpdates()', 'called');\n    if (this.listenerCount === 0) {\n      // Tell the sdk to start listening to membership changes\n      this.datasource.memberships.listen();\n    }\n    this.listenerCount += 1;\n  }\n\n  /**\n   * Tells the SDK to stop listening to memberships events.\n   *\n   * Note: Since the SDK listens to ALL memberships events, this function only\n   * calls the SDK's `memberships.stopListening` function once all of the listeners are done.\n   * If `memberships.stopListening` is called early, existing subscribers won't get any updates.\n   *\n   * @private\n   */\n  stopListeningToMembershipsUpdates() {\n    logger.debug(...LOG_ARGS, 'stopListeningToMembershipsUpdates()', 'called');\n    this.listenerCount -= 1;\n\n    if (this.listenerCount <= 0) {\n      // Once all listeners are done, stop listening\n      this.datasource.memberships.stopListening();\n    }\n  }\n\n  /**\n   * Returns an observable that emits room members list of the given roomID.\n   *\n   * @private\n   * @param {string} roomID ID of the room\n   * @returns {external:Observable.<Array.<Member>>} Observable stream that emits a list of current members in a room\n   */\n  getRoomMembers(roomID) {\n    logger.debug('MEMBERSHIP', `room-${roomID}`, 'getRoomMembers()', ['called with', {roomID}]);\n    this.startListeningToMembershipsUpdates();\n\n    const membershipToMember = (membership) => ({\n      ID: deconstructHydraId(membership.personId).id,\n      orgID: deconstructHydraId(membership.personOrgId).id,\n      muted: null,\n      sharing: null,\n      inMeeting: null,\n      host: null,\n      guest: null,\n    });\n\n    const me$ = from(this.datasource.people.get('me'));\n\n    const memberships$ = defer(() => this.datasource.memberships.list({\n      roomId: roomID,\n      max: MAX_MEMBERSHIPS,\n    })).pipe(\n      map((page) => page.items),\n    );\n\n    const members$ = combineLatest([me$, memberships$]).pipe(\n      map(([me, memberships]) => sortRoomMembers(memberships, me.id).map(membershipToMember)),\n    );\n\n    const createdEvent$ = fromEvent(\n      this.datasource.memberships,\n      SDK_EVENT.EXTERNAL.EVENT_TYPE.CREATED,\n    ).pipe(\n      tap(() => {\n        logger.debug('MEMBERSHIP', `room-${roomID}`, 'getRoomMembers()', ['received', SDK_EVENT.EXTERNAL.EVENT_TYPE.CREATED, 'event']);\n      }),\n    );\n\n    const deletedEvent$ = fromEvent(\n      this.datasource.memberships,\n      SDK_EVENT.EXTERNAL.EVENT_TYPE.DELETED,\n    );\n\n    const event$ = merge(createdEvent$, deletedEvent$)\n      .pipe(\n        filter((event) => event.data.roomId === roomID),\n        mergeMap(() => members$),\n      );\n\n    return concat(members$, event$).pipe(\n      publishReplay(1),\n      refCount(),\n      tap((members) => {\n        logger.debug('MEMBERSHIP', `room-${roomID}`, 'getRoomMembers()', ['emitting membership object', members]);\n      }),\n      finalize(() => {\n        this.stopListeningToMembershipsUpdates();\n      }),\n    );\n  }\n\n  /**\n   * Returns an observable that emits meeting members list of the given meetingID.\n   *\n   * @private\n   * @param {string} meetingID ID of the meeting\n   * @returns {external:Observable.<Array.<Member>>} Observable stream that emits a list of current members in a meeting\n   */\n  getMeetingMembers(meetingID) {\n    logger.debug('MEMBERSHIP', `meeting-${meetingID}`, 'getMeetingMembers()', ['called with', {meetingID}]);\n    const meeting = this.datasource.meetings.getMeetingByType('id', meetingID);\n    let members$;\n\n    if (!meeting) {\n      members$ = throwError(new Error(`Meeting ${meetingID} not found.`));\n    } else {\n      const members = meeting.members\n        && meeting.members.membersCollection\n        && meeting.members.membersCollection.members;\n\n      // Behavior subject will keep the last emitted object for new subscribers\n      // https://rxjs.dev/guide/subject#behaviorsubject\n      members$ = new BehaviorSubject(getMembers(members, meeting));\n\n      // Emit on membership updates\n      meeting.members.on('members:update', (payload) => {\n        logger.debug(...LOG_ARGS, 'getMeetingMembers()', ['received \"members:update\" event', {payload}]);\n        if (payload && payload.full) {\n          members$.next(getMembers(payload.full, meeting));\n        }\n      });\n    }\n\n    return members$.pipe(\n      tap((members) => {\n        logger.debug('MEMBERSHIP', `meeting-${meetingID}`, 'getMeetingMembers()', ['emitting membership object', members]);\n      }),\n    );\n  }\n\n  /**\n   * Returns an observable that emits a list of Member objects.\n   * Whenever there is an update to the membership, the observable\n   * will emit a new updated Member list, if datasource permits.\n   *\n   * @param {string} destinationID  ID of the destination for which to get members\n   * @param {DestinationType} destinationType Type of the membership destination\n   * @returns {external:Observable.<Array.<Member>>} Observable stream that emits member lists\n   */\n  getMembersFromDestination(destinationID, destinationType) {\n    logger.debug('MEMBERSHIP', `${destinationType}-${destinationID}`, 'getMembersFromDestination()', ['called with', {destinationID, destinationType}]);\n    const membershipID = `${destinationType}-${destinationID}`;\n    let members$ = this.members$[membershipID];\n\n    if (!members$) {\n      switch (destinationType) {\n        case DestinationType.ROOM:\n          members$ = this.getRoomMembers(destinationID);\n          break;\n        case DestinationType.MEETING:\n          members$ = this.getMeetingMembers(destinationID);\n          break;\n        default:\n          members$ = throwError(new Error(`getMembersFromDestination for ${destinationType} is not currently supported.`));\n      }\n\n      // save for future calls\n      this.members$[membershipID] = members$;\n    }\n\n    return members$;\n  }\n}\n","import {ReplaySubject, defer} from 'rxjs';\nimport {map} from 'rxjs/operators';\nimport {OrganizationsAdapter} from '@webex/component-adapter-interfaces';\nimport logger from './logger';\n\n// TODO: Figure out how to import JS Doc definitions and remove duplication.\n/**\n * A set of people in Webex.\n *\n * @external Organization\n * @see {@link https://github.com/webex/component-adapter-interfaces/blob/master/src/OrganizationsAdapter.js#L6}\n */\n\n/**\n * The `OrganizationsSDKAdapter` is an implementation of the `OrganizationsAdapter` interface.\n * This adapter utilizes the Webex JS SDK to fetch data about an organization.\n *\n * @implements {OrganizationsAdapter}\n */\nexport default class OrganizationsSDKAdapter extends OrganizationsAdapter {\n  constructor(datasource) {\n    super(datasource);\n\n    this.organizationObservables = {};\n  }\n\n  /**\n   * Returns a promise to organization data from Webex.\n   *\n   * @param {string} orgID ID of the organization for which to fetch data\n   * @returns {Promise.<Organization>} Information about the organization of the given ID\n   *\n   * @private\n   */\n  fetchOrganization(orgID) {\n    logger.debug('ORGANIZATION', orgID, 'fetchOrganization()', ['called with', {orgID}]);\n\n    return this.datasource.request({\n      service: 'hydra',\n      resource: `organizations/${orgID}`,\n    }).then((res) => res.body);\n  }\n\n  /**\n   * Returns an observable that emits organization data of the given ID.\n   *\n   * @param {string} ID ID of organization to get\n   * @returns {external:Observable.<Organization>} Observable stream that emits organization data\n   */\n  getOrg(ID) {\n    logger.debug('ORGANIZATION', ID, 'getOrg()', ['called with', {ID}]);\n\n    if (!(ID in this.organizationObservables)) {\n      // use ReplaySubject cause we don't need to set an initial value\n      this.organizationObservables[ID] = new ReplaySubject(1);\n\n      defer(() => this.fetchOrganization(ID)).pipe(\n        map((response) => ({\n          ID: response.id,\n          name: response.displayName,\n        })),\n      ).subscribe(\n        (organization) => {\n          logger.debug('ORGANIZATION', ID, 'getOrg()', ['emitting organization object', organization]);\n          this.organizationObservables[ID].next(organization);\n        },\n        (error) => {\n          logger.error('ORGANIZATION', ID, 'getOrg()', 'Error fetching organization', error);\n          this.organizationObservables[ID].error(new Error(`Could't find organization with ID \"${ID}\"`));\n        },\n      );\n    }\n\n    return this.organizationObservables[ID];\n  }\n}\n","import {WebexAdapter} from '@webex/component-adapter-interfaces';\nimport ActivitiesSDKAdapter from './ActivitiesSDKAdapter';\nimport RoomsSDKAdapter from './RoomsSDKAdapter';\nimport PeopleSDKAdapter from './PeopleSDKAdapter';\nimport MeetingsSDKAdapter from './MeetingsSDKAdapter';\nimport MembershipsSDKAdapter from './MembershipsSDKAdapter';\nimport OrganizationsSDKAdapter from './OrganizationsSDKAdapter';\nimport logger from './logger';\nimport {name, version} from '../package.json';\n\nconst LOG_ARGS = ['SDK', `${name}-${version}`];\n\nexport default class WebexSDKAdapter extends WebexAdapter {\n  /**\n   * Creates a new instance of the WebexSDKAdapter.\n   * The data source for this adapter comes from an authenticated instance of the SDK.\n   * More information about the Webex JS SDK: https://github.com/webex/webex-js-sdk\n   *\n   * @param {object} sdk The primary sdk the adapter will be using.\n   */\n  constructor(sdk) {\n    super(sdk);\n\n    logger.debug(...LOG_ARGS, 'constructor()', 'instantiating sdk component adapter');\n\n    this.activitiesAdapter = new ActivitiesSDKAdapter(sdk);\n    this.peopleAdapter = new PeopleSDKAdapter(sdk);\n    this.roomsAdapter = new RoomsSDKAdapter(sdk);\n    this.meetingsAdapter = new MeetingsSDKAdapter(sdk);\n    this.membershipsAdapter = new MembershipsSDKAdapter(sdk);\n    this.organizationsAdapter = new OrganizationsSDKAdapter(sdk);\n    this.sdk = sdk;\n  }\n\n  /**\n   * Connect to Webex services so SDK can listen for data updates.\n   */\n  async connect() {\n    logger.debug(...LOG_ARGS, 'connect()', 'called');\n    logger.debug(...LOG_ARGS, 'connect()', 'calling sdk.internal.mercury.connect()');\n    await this.sdk.internal.device.register();\n    logger.debug(...LOG_ARGS, 'connect()', 'calling sdk.internal.mercury.connect()');\n    await this.sdk.internal.mercury.connect();\n    logger.debug(...LOG_ARGS, 'connect()', 'calling meetingsAdapter.connect()');\n    await this.meetingsAdapter.connect();\n  }\n\n  /**\n   * Disconnect from Webex services, closing any connections SDK may have opened.\n   */\n  async disconnect() {\n    logger.debug(...LOG_ARGS, 'disconnect()', 'called');\n    logger.debug(...LOG_ARGS, 'disconnect()', 'calling meetingsAdapter.disconnect()');\n    await this.meetingsAdapter.disconnect();\n    logger.debug(...LOG_ARGS, 'disconnect()', 'calling sdk.internal.mercury.disconnect()');\n    await this.sdk.internal.mercury.disconnect();\n    logger.debug(...LOG_ARGS, 'disconnect()', 'calling meetingsAdapter.unregister()');\n    await this.sdk.internal.device.unregister();\n  }\n}\n"],"names":["MediaStream","prototype","getTracks","WebexAdapter","[object Object]","datasource","this","Promise","reject","Error","global","self","window","setTimeout","clearTimeout","performance","now","mozNow","msNow","oNow","webkitNow","Date","getTime","chainWith","createDependentObservable","source","Observable","subscriber","lastValue","subscription","subscribe","value","next","error","complete","unsubscribe","combineLatestImmediate","observables","combineLatest","map","obs","pipe","startWith","undefined","deepMerge","dest","src","result","key","val","Object","entries","constructor","safeJsonStringify","data","replacer","space","seen","WeakSet","str","JSON","stringify","replaced","has","add","message","isSpeakerSupported","document","createElement","setSinkId","logFormat","format","printf","timestamp","level","resourceType","resourceID","action","msgString","Array","isArray","item","track","kind","join","stack","activeTransports","push","transports","Console","combine","colorize","simple","winstonLogger","createLogger","logger","setLevel","webexSDKAdapterSetLogLevel","ActivitiesSDKAdapter","ActivitiesAdapter","activityObservables","fetchActivity","activityID","debug","messages","get","getActivity","ID","ReplaySubject","defer","id","roomId","text","personId","attachments","created","roomID","personID","card","contentType","content","activity","postAction","inputs","action$","from","attachmentActions","create","type","messageId","actionID","tap","catchError","err","postActivity","activity$","ROOM_UPDATED_EVENT","sortByPublished","arr","sort","a","b","published","FETCHED_CONVERSATIONS","RoomsSDKAdapter","RoomsAdapter","getRoomObservables","getRoomActivitiesCache","listenerCount","activityLimit","activitiesObservableCache","Map","roomActivities","fetchRoom","title","lastActivity","rooms","startListeningToRoomUpdates","listen","stopListeningToRoomUpdates","stopListening","getRoom","room$","roomUpdate$","fromEvent","filter","event","flatMap","getRoom$","concat","room","finalize","publishReplay","refCount","fetchActivities","earliestActivityDate","conversationId","deconstructHydraId","internal","conversation","list","listActivities","limit","lastActivityFirst","maxDate","hasMoreActivities","pastActivities$Cache","hasMore","fetchPastActivities","roomActivity","length","shift","activityIds","activities","set","getPreviousActivities","Subject","throwError","getRoomActivities","getRoomActivities$","BehaviorSubject","mercury","on","sdkActivity","UUID","target","object","objectType","actor","displayAuthor","info","USER_PRESENCE_UPDATE_EVENT","getStatus","status","personStatus","keys","PersonStatus","find","PeopleSDKAdapter","PeopleAdapter","getPersonObservables","fetchPerson","emails","displayName","firstName","lastName","avatar","orgId","people","orgID","getMe","person","presence","of","getPerson","personUUID","person$","personWithStatus$","responses","statusUpdate$","subject","personUpdate$","getPerson$","warn","MeetingControl","adapter","controlID","AudioControl","meetingID","handleLocalAudio","display","common","STATES","muted","icon","tooltip","state","MeetingControlState","ACTIVE","unmuted","INACTIVE","muting","DISABLED","unmuting","noMicrophone","getMeeting","localAudio","stream","disabledLocalAudio","distinctUntilChanged","ExitControl","leaveMeeting","JoinControl","joinMeeting","meeting","hint","localVideo","prev","curr","RosterControl","toggleRoster","active","inactive","showRoster","SettingsControl","toggleSettings","showSettings","ShareControl","handleLocalShare","localShare","SwitchCameraControl","cameraID","switchCamera","cameraID$","options$","getAvailableDevices","availableCameras","camera","deviceId","label","options","noOptionsMessage","selected","SwitchMicrophoneControl","microphoneID","switchMicrophone","microphoneID$","availableMicrophones","microphone","SwitchSpeakerControl","speakerID","switchSpeaker","speakerID$","availableSpeakers","speaker","VideoControl","handleLocalVideo","noCamera","disabledLocalVideo","EVENT_MEDIA_READY","EVENT_MEDIA_STOPPED","EVENT_MEMBERS_UPDATE","EVENT_LOCAL_SHARE_STOP","EVENT_LOCAL_SHARE_START","EVENT_REMOTE_SHARE_START","EVENT_REMOTE_SHARE_STOP","EVENT_MEETING_UPDATED","EVENT_CAMERA_SWITCH","EVENT_MICROPHONE_SWITCH","JOIN_CONTROL","EXIT_CONTROL","AUDIO_CONTROL","VIDEO_CONTROL","SHARE_CONTROL","ROSTER_CONTROL","SETTINGS_CONTROL","SWITCH_CAMERA_CONTROL","SWITCH_MICROPHONE_CONTROL","SWITCH_SPEAKER_CONTROL","MEDIA_TYPE_LOCAL","MEDIA_TYPE_LOCAL_SHARE","MEDIA_TYPE_REMOTE_AUDIO","MEDIA_TYPE_REMOTE_VIDEO","MEDIA_TYPE_REMOTE_SHARE","MEDIA_EVENT_TYPES","mediaSettings","receiveVideo","receiveAudio","receiveShare","sendVideo","sendAudio","sendShare","HYDRA_ID_TYPE_PEOPLE","HYDRA_ID_TYPE_ROOM","LAYOUT_TYPES_MAP","Overlay","Grid","Stack","Prominent","Focus","SDK_MEMBER_STATUS_TO_ADAPTER_MEETING_STATE","IN_LOBBY","MeetingState","LOBBY","IN_MEETING","JOINED","NOT_IN_MEETING","LEFT","MeetingsSDKAdapter","MeetingsAdapter","getMeetingObservables","meetings","meetingControls","connect","register","syncMeetings","disconnect","unregister","getLocalMedia","getStreamWithPermission","permission","ignore","ignoreMediaAccessPrompt","audio","getStream","mediaDirection","audioVideo","ignored","isAsking","sdkMeeting","fetchMeeting","localStream","getMediaStreams","availableDevices","navigator","mediaDevices","enumerateDevices","deviceLabel","mediaDevice","device","removeTrack","perm","ee","DOMException","name","condition","getDevices","devices","concatMap","allowed","attachMedia","audioTracks","getAudioTracks","videoTracks","getVideoTracks","remoteAudio","remoteVideo","remoteShareStream","remoteShare","remoteSharing","stopStream","tracks","forEach","stop","removeMedia","settings","visible","preview","video","fetchMeetingTitle","destination","meetingTitle","email","items","createMeeting","newMeeting$","meetingInfo","meetingName","NOT_JOINED","localMedia","emit","getMeetingByType","meetingFiniteStateMachine","reset","pin","password","moderator","hostKey","joinIntentRequired","updateMeeting","passwordRequired","invalidPassword","invalidHostKey","leave","getLocalMediaState","disabledLocalMedia","disabled","updates","isInSession","muteAudio","unmuteAudio","muteVideo","unmuteVideo","handleSdkError","canUpdateMedia","updateShare","catch","openingSettings","videoStream","audioStream","clone","updateVideo","updateAudio","toPromise","changeLayout","layoutType","changeVideoLayout","ignoreVideoAccessPrompt","ignoreAudioAccessPrompt","addMedia","addTrack","getMeeting$","observer","meetingUpdateEvent$","meetingWithMediaReadyEvent$","includes","meetingWithMediaStoppedEvent$","meetingWithMediaShareEvent$","meetingWithMediaStoppedShareEvent$","meetingWithLocalShareStoppedEvent$","meetingWithLocalShareStartedEvent$","meetingWithSwitchCameraEvent$","meetingWithSwitchMicrophoneEvent$","meetingStateChange$","members","values","full","m","isSelf","meetingsWithEvents$","merge","getMeetingWithEvents$","takeWhile","updater","supportedControls","getLayoutTypes","clearPasswordRequiredFlag","clearInvalidPasswordFlag","clearInvalidHostKeyFlag","_globalModule","Math","Function","__g","core","_coreModule","version","__e","_aFunction","it","TypeError","aFunction","require$$0","_ctx","fn","that","call","c","apply","arguments","_isObject","isObject","_anObject","_fails","exec","e","_descriptors","defineProperty","require$$1","is","_domCreate","_ie8DomDefine","require$$2","_toPrimitive","S","toString","valueOf","anObject","IE8_DOM_DEFINE","toPrimitive","dP","require$$3","O","P","Attributes","_propertyDesc","bitmap","enumerable","configurable","writable","createDesc","_hide","f","hasOwnProperty","_has","ctx","hide","require$$4","PROTOTYPE","$export","IS_FORCED","F","IS_GLOBAL","G","IS_STATIC","IS_PROTO","IS_BIND","B","IS_WRAP","W","exports","expProto","own","out","C","virtual","R","U","_export","$Object","desc","ACTIVITY_VERB","LOCK","UNLOCK","HIDE","HIDDEN","ONE_ON_ONE","LOCKED","CREATED","DELETED","GROUP","ROOMS","WEB","LOG_ARGS","MAX_MEMBERSHIPS","sortMeetingMembers","member1","member2","localeCompare","sortRoomMembers","memberships","myID","m1","m2","personDisplayName","getMembers","sdkMembers","member","participant","constructHydraId","hydraTypes","PEOPLE","ORGANIZATION","inMeeting","isInMeeting","isAudioMuted","sharing","isContentSharing","host","isWebexScheduled","isModerator","guest","isGuest","MembershipsSDKAdapter","MembershipsAdapter","members$","startListeningToMembershipsUpdates","stopListeningToMembershipsUpdates","getRoomMembers","membershipToMember","membership","personOrgId","me$","memberships$","max","page","me","createdEvent$","SDK_EVENT","EXTERNAL","EVENT_TYPE","deletedEvent$","event$","mergeMap","getMeetingMembers","membersCollection","payload","getMembersFromDestination","destinationID","destinationType","membershipID","DestinationType","ROOM","MEETING","OrganizationsSDKAdapter","OrganizationsAdapter","organizationObservables","fetchOrganization","request","service","resource","then","res","body","getOrg","response","organization","WebexSDKAdapter","sdk","activitiesAdapter","peopleAdapter","roomsAdapter","meetingsAdapter","membershipsAdapter","organizationsAdapter"],"mappings":";;;;;AAAA;AACA;AACA,IAAI,CAACA,WAAW,CAACC,SAAZ,CAAsBC,SAA3B,EAAsC;AACpCF,EAAAA,WAAW,CAACC,SAAZ,CAAsBC,SAAtB,GAAkC,MAAM,EAAxC;AACD;;ACOc,MAAMC,CAAN,CAAMA;AAMnBC,EAAAA,WAAAA,CAAYC,CAAZD,EAAYC;AACVC,SAAKD,UAALC,GAAkBD,CAAlBC;AAQFF;;AAAAA,EAAAA,OAAAA,GAAAA;AACE,WAAOG,OAAAA,CAAQC,MAARD,CACL,IAAIE,KAAJ,CAAU,2CAAV,CADKF,CAAP;AAUFH;;AAAAA,EAAAA,UAAAA,GAAAA;AACE,WAAOG,OAAAA,CAAQC,MAARD,CACL,IAAIE,KAAJ,CAAU,8CAAV,CADKF,CAAP;AACY;;AA5BKJ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACXrB,eAAgB,OAAOO,MAAP,KAAkB,WAAlB,GAAgCA,MAAhC,GACJ,OAAOC,IAAP,KAAgB,WAAhB,GAA8BA,IAA9B,GACA,OAAOC,MAAP,KAAkB,WAAlB,GAAgCA,MAAhC,GAAyC,EAFrD;;ACWA,IAAI,OAAOF,QAAM,CAACG,UAAd,KAA6B,UAAjC,EAA6C;;AAG7C,IAAI,OAAOH,QAAM,CAACI,YAAd,KAA+B,UAAnC,EAA+C;;AAsJ/C,IAAIC,WAAW,GAAGL,QAAM,CAACK,WAAP,IAAsB,EAAxC;;AAEEA,WAAW,CAACC,GAAZ,IACAD,WAAW,CAACE,MADZ,IAEAF,WAAW,CAACG,KAFZ,IAGAH,WAAW,CAACI,IAHZ,IAIAJ,WAAW,CAACK,SAJZ,IAKA,YAAU;AAAE,SAAQ,IAAIC,IAAJ,EAAD,CAAaC,OAAb,EAAP;AAA+B;;ACxK7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACO,SAASC,SAAT,CAAmBC,yBAAnB,EAA8C;AACnD,SAAQC,MAAD,IAAY,IAAIC,UAAJ,CAAgBC,UAAD,IAAgB;AAChD,QAAIC,SAAJ;AACA,QAAIC,YAAJ;AAEAA,IAAAA,YAAY,GAAGJ,MAAM,CAACK,SAAP,CACZC,KAAD,IAAW;AACTJ,MAAAA,UAAU,CAACK,IAAX,CAAgBD,KAAhB;AACAH,MAAAA,SAAS,GAAGG,KAAZ;AACD,KAJY,EAKZE,KAAD,IAAWN,UAAU,CAACM,KAAX,CAAiBA,KAAjB,CALE,EAMb,MAAM;AACJJ,MAAAA,YAAY,GAAGL,yBAAyB,CAACI,SAAD,CAAzB,CAAqCE,SAArC,CACZC,KAAD,IAAWJ,UAAU,CAACK,IAAX,CAAgBD,KAAhB,CADE,EAEZE,KAAD,IAAWN,UAAU,CAACM,KAAX,CAAiBA,KAAjB,CAFE,EAGb,MAAMN,UAAU,CAACO,QAAX,EAHO,CAAf;AAKD,KAZY,CAAf;AAeA,WAAO,MAAM;AACX,UAAIL,YAAJ,EAAkB;AAChBA,QAAAA,YAAY,CAACM,WAAb;AACD;AACF,KAJD;AAKD,GAxBkB,CAAnB;AAyBD;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACO,SAASC,sBAAT,GAAgD;AAAA,oCAAbC,WAAa;AAAbA,IAAAA,WAAa;AAAA;;AACrD,SAAOC,aAAa,CAACD,WAAW,CAACE,GAAZ,CAAiBC,GAAD,IAASA,GAAG,CAACC,IAAJ,CAASC,SAAS,CAACC,SAAD,CAAlB,CAAzB,CAAD,CAApB;AACD;AAED;AACA;AACA;AACA;AACA;AACA;;AACO,SAASC,SAAT,CAAmBC,IAAnB,EAAyBC,GAAzB,EAA8B;AACnC,QAAMC,MAAM,GAAGF,IAAf;;AAEA,OAAK,MAAM,CAACG,GAAD,EAAMC,GAAN,CAAX,IAAyBC,MAAM,CAACC,OAAP,CAAeL,GAAG,IAAI,EAAtB,CAAzB,EAAoD;AAClD,QAAIG,GAAG,IAAIA,GAAG,CAACG,WAAJ,KAAoBF,MAA/B,EAAuC;AACrCN,MAAAA,SAAS,CAACG,MAAM,CAACC,GAAD,CAAP,EAAcC,GAAd,CAAT;AACD,KAFD,MAEO;AACLF,MAAAA,MAAM,CAACC,GAAD,CAAN,GAAcC,GAAd;AACD;AACF;AACF;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACO,SAASI,iBAAT,CAA2BC,IAA3B,EAAiCC,QAAjC,EAA2CC,KAA3C,EAAkD;AACvD,QAAMC,IAAI,GAAG,IAAIC,OAAJ,EAAb;AACA,MAAIC,GAAJ;;AAEA,MAAI;AACFA,IAAAA,GAAG,GAAGC,IAAI,CAACC,SAAL,CAAeP,IAAf,EAAqB,CAACN,GAAD,EAAMjB,KAAN,KAAgB;AACzC,UAAI+B,QAAQ,GAAGP,QAAQ,GAAGA,QAAQ,CAACP,GAAD,EAAMjB,KAAN,CAAX,GAA0BA,KAAjD;;AAEA,UAAI,OAAO+B,QAAP,KAAoB,QAApB,IAAgCA,QAAQ,KAAK,IAAjD,EAAuD;AACrD,YAAIL,IAAI,CAACM,GAAL,CAASD,QAAT,CAAJ,EAAwB;AACtBA,UAAAA,QAAQ,GAAG,sBAAX;AACD,SAFD,MAEO;AACLL,UAAAA,IAAI,CAACO,GAAL,CAASF,QAAT;AACD;AACF;;AAED,aAAOA,QAAP;AACD,KAZK,EAYHN,KAZG,CAAN;AAaD,GAdD,CAcE,OAAOvB,KAAP,EAAc;AACd0B,IAAAA,GAAG,GAAI,uBAAsB1B,KAAK,CAACgC,OAAQ,GAA3C;AACD;;AAED,SAAON,GAAP;AACD;;AAUM,MAAMO,kBAAkB,GAAG,CAAC,CAACC,QAAQ,CAACC,aAAT,CAAuB,OAAvB,EAAgCC,SAA7D;;ACnHP,MAAMC,SAAS,GAAGC,MAAM,CAACC,MAAP,CAAc,QAE1B;AAAA,MAF2B;AAC/BC,IAAAA,SAD+B;AACpBC,IAAAA,KADoB;AACbC,IAAAA,YADa;AACCC,IAAAA,UADD;AACaC,IAAAA,MADb;AACqBZ,IAAAA,OADrB;AAC8BhC,IAAAA;AAD9B,GAE3B;AACJ,MAAI6C,SAAS,GAAGb,OAAhB;;AAEA,MAAIc,KAAK,CAACC,OAAN,CAAcf,OAAd,CAAJ,EAA4B;AAC1Ba,IAAAA,SAAS,GAAGb,OAAO,CAAC1B,GAAR,CAAa0C,IAAD,IACrB,OAAOA,IAAP,KAAgB,QAAhB,IAA4BA,IAA7B,IACG5B,iBAAiB,CAAC4B,IAAD,EAAO,CAACjC,GAAD,EAAMjB,KAAN,KACxBA,KAAK,YAAY/B,WAAjB,IAAiC,gBAAe+B,KAAK,CAAC7B,SAAN,GAAkBqC,GAAlB,CAAuB2C,KAAD,IAAWA,KAAK,CAACC,IAAvC,CAA6C,IAA9F,IACGpD,KAFe,EAGjB,CAHiB,CAFV,EAMTqD,IANS,CAMJ,GANI,CAAZ;AAOD;;AAED,SAAQ,GAAEX,SAAU,IAAGC,KAAM,IAAGC,YAAa,IAAGC,UAAW,IAAGC,MAAO,IAAGC,SAAU,IAAG7C,KAAK,GAAI,IAAGA,KAAK,CAACoD,KAAN,IAAepD,KAAM,EAA5B,GAAgC,EAAG,EAA7H;AACD,CAhBiB,CAAlB;AAkBA,MAAMqD,gBAAgB,GAAG,EAAzB;;AAE2C;AACzCA,EAAAA,gBAAgB,CAACC,IAAjB,CAAsB,IAAIC,UAAU,CAACC,OAAf,CAAuB;AAC3ClB,IAAAA,MAAM,EAAEA,MAAM,CAACmB,OAAP,CACNnB,MAAM,CAACE,SAAP,CAAiB;AAACF,MAAAA,MAAM,EAAE;AAAT,KAAjB,CADM,EAENA,MAAM,CAACoB,QAAP,EAFM,EAGNpB,MAAM,CAACqB,MAAP,EAHM,EAINtB,SAJM;AADmC,GAAvB,CAAtB;AAQD;;AAED,MAAMuB,aAAa,GAAGC,YAAY,CAAC;AACjCpB,EAAAA,KAAK,EAAE,OAD0B;AAEjCc,EAAAA,UAAU,EAAEF;AAFqB,CAAD,CAAlC;;AAMA,MAAMS,MAAM,GAAG;AACbC,EAAAA,QAAQ,EAAGtB,KAAD,IAAW;AACnBmB,IAAAA,aAAa,CAACnB,KAAd,GAAsBA,KAAtB;AACD;AAHY,CAAf;;AAMA,KAAK,MAAMA,KAAX,IAAoB,CAAC,MAAD,EAAS,MAAT,EAAiB,OAAjB,EAA0B,OAA1B,CAApB,EAAwD;AACtDqB,EAAAA,MAAM,CAACrB,KAAD,CAAN,GAAgB,CAACC,YAAD,EAAeC,UAAf,EAA2BC,MAA3B,EAAmCZ,OAAnC,EAA4ChC,KAA5C,KACd4D,aAAa,CAACnB,KAAD,CAAb,CAAqB;AACnBC,IAAAA,YADmB;AACLC,IAAAA,UADK;AACOC,IAAAA,MADP;AACeZ,IAAAA,OADf;AACwBhC,IAAAA;AADxB,GAArB,CADF;AAKD;;AAED,IAAI,OAAOrB,MAAP,KAAkB,WAAtB,EAAmC;AACjCA,EAAAA,MAAM,CAACqF,0BAAP,GAAqCvB,KAAD,IAAWqB,MAAM,CAACC,QAAP,CAAgBtB,KAAhB,CAA/C;AACD;;ACzCD;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA;;AACe,MAAMwB,oBAAN,SAAmCC,CAAnC,CAAqD;AAClE/C,EAAAA,WAAW,CAAC/C,UAAD,EAAa;AACtB,UAAMA,UAAN;AAEA,SAAK+F,mBAAL,GAA2B,EAA3B;AACD;AAED;AACF;AACA;AACA;AACA;AACA;AACA;AACA;;;AACEC,EAAAA,aAAa,CAACC,UAAD,EAAa;AACxBP,IAAAA,MAAM,CAACQ,KAAP,CAAa,UAAb,EAAyBD,UAAzB,EAAqC,iBAArC,EAAwD,CAAC,aAAD,EAAgB;AAACA,MAAAA;AAAD,KAAhB,CAAxD;AAEA,WAAO,KAAKjG,UAAL,CAAgBmG,QAAhB,CAAyBC,GAAzB,CAA6BH,UAA7B,CAAP;AACD;AAED;AACF;AACA;AACA;AACA;AACA;;;AACEI,EAAAA,WAAW,CAACC,EAAD,EAAK;AACdZ,IAAAA,MAAM,CAACQ,KAAP,CAAa,UAAb,EAAyBI,EAAzB,EAA6B,eAA7B,EAA8C,CAAC,aAAD,EAAgB;AAACA,MAAAA;AAAD,KAAhB,CAA9C;;AAEA,QAAI,EAAEA,EAAE,IAAI,KAAKP,mBAAb,CAAJ,EAAuC;AACrC;AACA,WAAKA,mBAAL,CAAyBO,EAAzB,IAA+B,IAAIC,aAAJ,CAAkB,CAAlB,CAA/B;AAEAC,MAAAA,KAAK,CAAC,MAAM,KAAKR,aAAL,CAAmBM,EAAnB,CAAP,CAAL,CAAoClE,IAApC,CACEF,GAAG,CAAC;AAAA,YAAC;AACHuE,UAAAA,EADG;AAEHC,UAAAA,MAFG;AAGHC,UAAAA,IAHG;AAIHC,UAAAA,QAJG;AAKHC,UAAAA,WALG;AAMHC,UAAAA;AANG,SAAD;AAAA,eAOG;AACLR,UAAAA,EAAE,EAAEG,EADC;AAELM,UAAAA,MAAM,EAAEL,MAFH;AAGLC,UAAAA,IAHK;AAILK,UAAAA,QAAQ,EAAEJ,QAJL;AAKLC,UAAAA,WALK;AAMLI,UAAAA,IAAI,EAAEJ,WAAW,IAAIA,WAAW,CAAC,CAAD,CAA1B,IAAiCA,WAAW,CAAC,CAAD,CAAX,CAAeK,WAAf,KAA+B,yCAAhE,GAA4GL,WAAW,CAAC,CAAD,CAAX,CAAeM,OAA3H,GAAqI7E,SANtI;AAOLwE,UAAAA;AAPK,SAPH;AAAA,OAAD,CADL,EAiBErF,SAjBF,CAkBG2F,QAAD,IAAc;AACZ1B,QAAAA,MAAM,CAACQ,KAAP,CAAa,UAAb,EAAyBI,EAAzB,EAA6B,eAA7B,EAA8C,CAAC,0BAAD,EAA6Bc,QAA7B,CAA9C;AACA,aAAKrB,mBAAL,CAAyBO,EAAzB,EAA6B3E,IAA7B,CAAkCyF,QAAlC;AACD,OArBH,EAsBGxF,KAAD,IAAW;AACT8D,QAAAA,MAAM,CAAC9D,KAAP,CAAa,UAAb,EAAyB0E,EAAzB,EAA6B,eAA7B,EAA8C,yBAA9C,EAAyE1E,KAAzE;AACA,aAAKmE,mBAAL,CAAyBO,EAAzB,EAA6B1E,KAA7B,CAAmC,IAAIxB,KAAJ,CAAW,oCAAmCkG,EAAG,GAAjD,CAAnC;AACD,OAzBH;AA2BD;;AAED,WAAO,KAAKP,mBAAL,CAAyBO,EAAzB,CAAP;AACD;AAED;AACF;AACA;AACA;AACA;AACA;AACA;;;AACEe,EAAAA,UAAU,CAACpB,UAAD,EAAaqB,MAAb,EAAqB;AAC7B5B,IAAAA,MAAM,CAACQ,KAAP,CAAa,mBAAb,EAAkC5D,SAAlC,EAA6C,cAA7C,EAA6D,CAAC,aAAD,EAAgB;AAAC2D,MAAAA,UAAD;AAAaqB,MAAAA;AAAb,KAAhB,CAA7D;AAEA,UAAMC,OAAO,GAAGC,IAAI,CAAC,KAAKxH,UAAL,CAAgByH,iBAAhB,CAAkCC,MAAlC,CAAyC;AAC5DC,MAAAA,IAAI,EAAE,QADsD;AAE5DC,MAAAA,SAAS,EAAE3B,UAFiD;AAG5DqB,MAAAA;AAH4D,KAAzC,CAAD,CAAJ,CAIZlF,IAJY,CAKdF,GAAG,CAAEsC,MAAD,KAAa;AACfqD,MAAAA,QAAQ,EAAErD,MAAM,CAACiC,EADF;AAEfR,MAAAA,UAAU,EAAEzB,MAAM,CAACoD,SAFJ;AAGfN,MAAAA,MAAM,EAAE9C,MAAM,CAAC8C,MAHA;AAIfP,MAAAA,MAAM,EAAEvC,MAAM,CAACkC,MAJA;AAKfM,MAAAA,QAAQ,EAAExC,MAAM,CAACoC,QALF;AAMfe,MAAAA,IAAI,EAAEnD,MAAM,CAACmD,IANE;AAOfb,MAAAA,OAAO,EAAEtC,MAAM,CAACsC;AAPD,KAAb,CAAD,CALW,EAcdgB,GAAG,CAAEtD,MAAD,IAAY;AACdkB,MAAAA,MAAM,CAACQ,KAAP,CAAa,mBAAb,EAAkC1B,MAAM,CAACqD,QAAzC,EAAmD,cAAnD,EAAmE,CAAC,mCAAD,EAAsCrD,MAAtC,CAAnE;AACD,KAFE,CAdW,EAiBduD,UAAU,CAAEC,GAAD,IAAS;AAClBtC,MAAAA,MAAM,CAAC9D,KAAP,CAAa,mBAAb,EAAkCU,SAAlC,EAA6C,cAA7C,EAA8D,wDAAuD2D,UAAW,GAAhI,EAAoI+B,GAApI;AACA,YAAMA,GAAN;AACD,KAHS,CAjBI,CAAhB;AAuBA,WAAOT,OAAP;AACD;AAED;AACF;AACA;AACA;AACA;AACA;;;AACEU,EAAAA,YAAY,CAACb,QAAD,EAAW;AACrB,UAAMc,SAAS,GAAGV,IAAI,CAAC,KAAKxH,UAAL,CAAgBmG,QAAhB,CAAyBuB,MAAzB,CAAgC;AACrDhB,MAAAA,MAAM,EAAEU,QAAQ,CAACL,MADoC;AAErDJ,MAAAA,IAAI,EAAES,QAAQ,CAACT,IAFsC;AAGrDE,MAAAA,WAAW,EAAEO,QAAQ,CAACH,IAAT,GAAgB,CAAC;AAC5BC,QAAAA,WAAW,EAAE,yCADe;AAE5BC,QAAAA,OAAO,EAAEC,QAAQ,CAACH;AAFU,OAAD,CAAhB,GAGRG,QAAQ,CAACP;AANuC,KAAhC,CAAD,CAAJ,CAOdzE,IAPc,CAQhBF,GAAG,CAAC;AAAA,UAAC;AACHuE,QAAAA,EADG;AAEHC,QAAAA,MAFG;AAGHC,QAAAA,IAHG;AAIHC,QAAAA,QAJG;AAKHC,QAAAA,WALG;AAMHC,QAAAA;AANG,OAAD;AAAA,aAOG;AACLR,QAAAA,EAAE,EAAEG,EADC;AAELM,QAAAA,MAAM,EAAEL,MAFH;AAGLC,QAAAA,IAHK;AAILK,QAAAA,QAAQ,EAAEJ,QAJL;AAKLC,QAAAA,WALK;AAMLC,QAAAA;AANK,OAPH;AAAA,KAAD,CARa,EAuBhBiB,UAAU,CAAEC,GAAD,IAAS;AAClBtC,MAAAA,MAAM,CAAC9D,KAAP,CAAa,UAAb,EAAyBU,SAAzB,EAAoC,gBAApC,EAAsD,CAAC,yBAAD,EAA4B8E,QAA5B,CAAtD,EAA6FY,GAA7F;AACA,YAAMA,GAAN;AACD,KAHS,CAvBM,CAAlB;AA6BA,WAAOE,SAAP;AACD;;AA3IiE;;ACRpE;AACA;AACA;AACA;AACA;AACA;;AAEO,MAAMC,kBAAkB,GAAG,SAA3B;;AAGP,MAAMC,eAAe,GAAIC,GAAD,IAASA,GAAG,CAACC,IAAJ,CAAS,CAACC,CAAD,EAAIC,CAAJ,KAAU,IAAIxH,IAAJ,CAASwH,CAAC,CAACC,SAAX,IAAwB,IAAIzH,IAAJ,CAASuH,CAAC,CAACE,SAAX,CAA3C,CAAjC;;;AAGA,IAAIC,qBAAqB,GAAG,KAA5B;AAEA;AACA;AACA;AACA;AACA;AACA;;AACe,MAAMC,eAAN,SAA8BC,CAA9B,CAA2C;AACxD7F,EAAAA,WAAW,CAAC/C,UAAD,EAAa;AACtB,UAAMA,UAAN;AAEA,SAAK6I,kBAAL,GAA0B,EAA1B;AACA,SAAKC,sBAAL,GAA8B,EAA9B;AACA,SAAKC,aAAL,GAAqB,CAArB;AAEA,SAAKC,aAAL,GAAqB,EAArB;AACA,SAAKC,yBAAL,GAAiC,IAAIC,GAAJ,EAAjC;AACA,SAAKC,cAAL,GAAsB,IAAID,GAAJ,EAAtB;AACD;AAED;AACF;AACA;AACA;AACA;AACA;AACA;;;AACiB,QAATE,SAAS,CAAC9C,EAAD,EAAK;AAClB,UAAM;AACJG,MAAAA,EADI;AAEJ4C,MAAAA,KAFI;AAGJ1B,MAAAA,IAHI;AAIJ2B,MAAAA;AAJI,QAKF,MAAM,KAAKtJ,UAAL,CAAgBuJ,KAAhB,CAAsBnD,GAAtB,CAA0BE,EAA1B,CALV;AAOA,WAAO;AACLA,MAAAA,EAAE,EAAEG,EADC;AAEL4C,MAAAA,KAFK;AAGL1B,MAAAA,IAHK;AAIL2B,MAAAA;AAJK,KAAP;AAMD;AAED;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACEE,EAAAA,2BAA2B,GAAG;AAC5B,QAAI,KAAKT,aAAL,KAAuB,CAA3B,EAA8B;AAC5B;AACA,WAAK/I,UAAL,CAAgBuJ,KAAhB,CAAsBE,MAAtB;AACD;;AACD,SAAKV,aAAL,IAAsB,CAAtB;AACD;AAED;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACEW,EAAAA,0BAA0B,GAAG;AAC3B,SAAKX,aAAL,IAAsB,CAAtB;;AAEA,QAAI,KAAKA,aAAL,IAAsB,CAA1B,EAA6B;AAC3B;AACA,WAAK/I,UAAL,CAAgBuJ,KAAhB,CAAsBI,aAAtB;AACD;AACF;AAED;AACF;AACA;AACA;AACA;AACA;;;AACEC,EAAAA,OAAO,CAACtD,EAAD,EAAK;AACVZ,IAAAA,MAAM,CAACQ,KAAP,CAAa,MAAb,EAAqBI,EAArB,EAAyB,WAAzB,EAAsC,CAAC,aAAD,EAAgB;AAACA,MAAAA;AAAD,KAAhB,CAAtC;;AACA,QAAI,EAAEA,EAAE,IAAI,KAAKuC,kBAAb,CAAJ,EAAsC;AACpC,WAAKW,2BAAL;AAEA,YAAMK,KAAK,GAAGrC,IAAI,CAAC,KAAK4B,SAAL,CAAe9C,EAAf,CAAD,CAAlB,CAHoC;;AAMpC,YAAMwD,WAAW,GAAGC,SAAS,CAAC,KAAK/J,UAAL,CAAgBuJ,KAAjB,EAAwBpB,kBAAxB,CAAT,CAAqD/F,IAArD;AAElB4H,MAAAA,MAAM,CAAEC,KAAD,IAAWA,KAAK,CAAChH,IAAN,CAAWwD,EAAX,KAAkBH,EAA9B,CAFY;AAIlB4D,MAAAA,OAAO,CAAC,MAAM1C,IAAI,CAAC,KAAK4B,SAAL,CAAe9C,EAAf,CAAD,CAAX,CAJW,CAApB,CANoC;;AAcpC,YAAM6D,QAAQ,GAAGC,MAAM;AAErBP,MAAAA,KAFqB,EAGrBC,WAHqB,CAAN,CAIf1H,IAJe,CAKf0F,GAAG,CAAEuC,IAAD,IAAU3E,MAAM,CAACQ,KAAP,CAAa,MAAb,EAAqBI,EAArB,EAAyB,WAAzB,EAAsC,CAAC,sBAAD,EAAyB+D,IAAzB,CAAtC,CAAX,CALY,EAMfC,QAAQ,CAAC,MAAM;AACb;AACA,aAAKZ,0BAAL;AACA,eAAO,KAAKb,kBAAL,CAAwBvC,EAAxB,CAAP;AACD,OAJO,CANO,CAAjB,CAdoC;;AA4BpC,WAAKuC,kBAAL,CAAwBvC,EAAxB,IAA8B6D,QAAQ,CAAC/H,IAAT,CAC5BmI,aAAa,CAAC,CAAD,CADe,EAE5BC,QAAQ,EAFoB,CAA9B;AAID;;AAED,WAAO,KAAK3B,kBAAL,CAAwBvC,EAAxB,CAAP;AACD;AAED;AACF;AACA;AACA;AACA;AACA;AACA;AACA;;;AACuB,QAAfmE,eAAe,CAACnE,EAAD,EAAKoE,oBAAL,EAA2B;AAC9C,UAAM;AAAC1B,MAAAA;AAAD,QAAkB,IAAxB;AACA,UAAM2B,cAAc,GAAGC,kBAAkB,CAACtE,EAAD,CAAlB,CAAuBG,EAA9C;AAEAf,IAAAA,MAAM,CAACQ,KAAP,CAAa,MAAb,EAAqBI,EAArB,EAAyB,mBAAzB,EAA8C,CAAC,aAAD,EAAgB;AAC5DoE,MAAAA,oBAD4D;AAE5D1B,MAAAA;AAF4D,KAAhB,CAA9C;;AAKA,QAAI,CAACN,qBAAL,EAA4B;AAC1B,YAAM,KAAK1I,UAAL,CAAgB6K,QAAhB,CAAyBC,YAAzB,CAAsCC,IAAtC,EAAN;AACArC,MAAAA,qBAAqB,GAAG,IAAxB;AACD;;AAED,WAAO,KAAK1I,UAAL,CAAgB6K,QAAhB,CAAyBC,YAAzB,CAAsCE,cAAtC,CAAqD;AAC1DL,MAAAA,cAD0D;AAE1DM,MAAAA,KAAK,EAAEjC,aAAa,GAAG,CAFmC;AAEhC;AAC1BkC,MAAAA,iBAAiB,EAAE,IAHuC;AAI1DC,MAAAA,OAAO,EAAET,oBAAoB,KAAK,IAAzB,GAAgCpI,SAAhC,GAA4CoI;AAJK,KAArD,CAAP;AAMD;AAED;AACF;AACA;AACA;AACA;AACA;AACA;;;AACEU,EAAAA,iBAAiB,CAAC9E,EAAD,EAAK;AACpB,UAAM+E,oBAAoB,GAAG,KAAKpC,yBAAL,CAA+B7C,GAA/B,CAAmCE,EAAnC,CAA7B;AACA,UAAM;AACJgF,MAAAA,OAAO,GAAG;AADN,QAEF,KAAKnC,cAAL,CAAoB/C,GAApB,CAAwBE,EAAxB,CAFJ;;AAIA,QAAI,CAACgF,OAAL,EAAc;AACZD,MAAAA,oBAAoB,CAACxJ,QAArB;AACD,KAFD,MAEO;AACL,WAAK0J,mBAAL,CAAyBjF,EAAzB;AACD;;AAED,WAAOgF,OAAP;AACD;AAED;AACF;AACA;AACA;AACA;AACA;;;AACEC,EAAAA,mBAAmB,CAACjF,EAAD,EAAK;AACtB,UAAMkF,YAAY,GAAG,KAAKrC,cAAL,CAAoB/C,GAApB,CAAwBE,EAAxB,CAArB;AACA,UAAM;AAACoE,MAAAA;AAAD,QAAyBc,YAA/B;AACA,UAAM3B,KAAK,GAAG,KAAKZ,yBAAL,CAA+B7C,GAA/B,CAAmCE,EAAnC,CAAd;AAEAZ,IAAAA,MAAM,CAACQ,KAAP,CAAa,MAAb,EAAqBI,EAArB,EAAyB,uBAAzB,EAAkD,CAAC,aAAD,EAAgB;AAChEoE,MAAAA;AADgE,KAAhB,CAAlD;;AAIA,QAAI,CAACpE,EAAL,EAAS;AACPZ,MAAAA,MAAM,CAAC9D,KAAP,CAAa,MAAb,EAAqB0E,EAArB,EAAyB,uBAAzB,EAAkD,CAAC,sBAAD,CAAlD;AACAuD,MAAAA,KAAK,CAACjI,KAAN,CAAY,IAAIxB,KAAJ,CAAU,4CAAV,CAAZ;AACD;;AAEDoH,IAAAA,IAAI,CAAC,KAAKiD,eAAL,CAAqBnE,EAArB,EAAyBoE,oBAAzB,CAAD,CAAJ,CACGjJ,SADH,CACcwB,IAAD,IAAU;AACnB,UAAI,CAACA,IAAL,EAAW;AACT,eAAO4G,KAAK,CAAChI,QAAN,EAAP;AACD;;AACD2J,MAAAA,YAAY,CAACF,OAAb,GAAuBrI,IAAI,CAACwI,MAAL,IAAe,KAAKzC,aAAL,GAAqB,CAA3D;AACA,YAAM;AAACP,QAAAA;AAAD,UAAcxF,IAAI,CAACyI,KAAL,EAApB;AACA,YAAMC,WAAW,GAAGvD,eAAe,CAACnF,IAAD,CAAf,CAAsBf,GAAtB,CAA2BkF,QAAD,IAAc;AAC1D,cAAM;AAACX,UAAAA;AAAD,YAAOW,QAAb;AAEAoE,QAAAA,YAAY,CAACI,UAAb,CAAwBC,GAAxB,CAA4BpF,EAA5B,EAAgCW,QAAhC;AAEA,eAAO,CAACX,EAAD,EAAKW,QAAQ,CAACqB,SAAd,CAAP;AACD,OANmB,CAApB;AAQA+C,MAAAA,YAAY,CAACd,oBAAb,GAAoCjC,SAApC;AACA+C,MAAAA,YAAY,CAACG,WAAb,CAAyBE,GAAzB,CAA6BpD,SAA7B,EAAwCkD,WAAW,CAACF,MAApD;AAEA,WAAKtC,cAAL,CAAoB0C,GAApB,CAAwBvF,EAAxB,EAA4BkF,YAA5B;AAEA,aAAO3B,KAAK,CAAClI,IAAN,CAAWgK,WAAX,CAAP;AACD,KArBH;AAsBD;AAED;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACEG,EAAAA,qBAAqB,CAACxF,EAAD,EAAyB;AAAA,QAApB0C,aAAoB,uEAAJ,EAAI;AAC5C,SAAKA,aAAL,GAAqBA,aAArB;AACA,UAAMqC,oBAAoB,GAAG,KAAKpC,yBAAL,CAA+B7C,GAA/B,CAAmCE,EAAnC,KAA0C,IAAIyF,OAAJ,EAAvE;;AAEA,QAAI,CAACzF,EAAL,EAAS;AACPZ,MAAAA,MAAM,CAAC9D,KAAP,CAAa,MAAb,EAAqB0E,EAArB,EAAyB,yBAAzB,EAAoD,CAAC,sBAAD,CAApD;AAEA,aAAO0F,UAAU,CAAC,IAAI5L,KAAJ,CAAU,8CAAV,CAAD,CAAjB;AACD;;AAED,QAAI,CAAC,KAAK+I,cAAL,CAAoBzF,GAApB,CAAwB4C,EAAxB,CAAL,EAAkC;AAChC,WAAK6C,cAAL,CAAoB0C,GAApB,CAAwBvF,EAAxB,EAA4B;AAC1BoE,QAAAA,oBAAoB,EAAE,IADI;AAE1BkB,QAAAA,UAAU,EAAE,IAAI1C,GAAJ,EAFc;AAG1ByC,QAAAA,WAAW,EAAE,IAAIzC,GAAJ;AAHa,OAA5B;AAKD;;AAED,SAAKD,yBAAL,CAA+B4C,GAA/B,CAAmCvF,EAAnC,EAAuC+E,oBAAvC;AAEA,WAAOA,oBAAP;AACD;AAED;AACF;AACA;AACA;AACA;AACA;;;AACEY,EAAAA,iBAAiB,CAAC3F,EAAD,EAAK;AACpBZ,IAAAA,MAAM,CAACQ,KAAP,CAAa,MAAb,EAAqBI,EAArB,EAAyB,qBAAzB,EAAgD,CAAC,aAAD,EAAgB;AAACA,MAAAA;AAAD,KAAhB,CAAhD;;AACA,QAAI,EAAEA,EAAE,IAAI,KAAKwC,sBAAb,CAAJ,EAA0C;AACxC,YAAMoD,kBAAkB,GAAG,IAAIC,eAAJ,CAAoB,EAApB,CAA3B;AAEA,WAAKnM,UAAL,CAAgB6K,QAAhB,CAAyBuB,OAAzB,CAAiCC,EAAjC,CAAoC,6BAApC,EAAoEC,WAAD,IAAiB;AAClF,cAAM;AAAC7F,UAAAA,EAAE,EAAE8F;AAAL,YAAa3B,kBAAkB,CAACtE,EAAD,CAArC;;AAEA,YAAIgG,WAAW,CAACE,MAAZ,IAAsBF,WAAW,CAACE,MAAZ,CAAmB/F,EAAnB,KAA0B8F,IAApD,EAA0D;AACxD7G,UAAAA,MAAM,CAACQ,KAAP,CAAa,MAAb,EAAqBI,EAArB,EAAyB,qBAAzB,EAAgD,CAAC,8CAAD,EAAiD;AAACgG,YAAAA;AAAD,WAAjD,CAAhD;AAEA,gBAAMlF,QAAQ,GAAG;AACfd,YAAAA,EAAE,EAAEgG,WAAW,CAAC7F,EADD;AAEfM,YAAAA,MAAM,EAAEuF,WAAW,CAACE,MAAZ,CAAmB/F,EAFZ;AAGfU,YAAAA,OAAO,EAAEmF,WAAW,CAACG,MAHN;AAIfvF,YAAAA,WAAW,EAAEoF,WAAW,CAACG,MAAZ,CAAmBC,UAJjB;AAKf1F,YAAAA,QAAQ,EAAEsF,WAAW,CAACK,KAAZ,CAAkBlG,EALb;AAMfmG,YAAAA,aAAa,EAAE,KANA;AAOf9F,YAAAA,OAAO,EAAEwF,WAAW,CAAC7D;AAPN,WAAjB;AAUAyD,UAAAA,kBAAkB,CAACvK,IAAnB,CAAwByF,QAAxB;AAEA1B,UAAAA,MAAM,CAACmH,IAAP,CAAY,MAAZ,EAAoBvG,EAApB,EAAwB,qBAAxB,EAA+C,CAAC,0BAAD,EAA6B;AAACc,YAAAA;AAAD,WAA7B,CAA/C;AACD;AACF,OApBD;AAsBA,WAAK0B,sBAAL,CAA4BxC,EAA5B,IAAkC4F,kBAAlC;AACD;;AAED,WAAO,KAAKpD,sBAAL,CAA4BxC,EAA5B,CAAP;AACD;;AA1RuD;;ACtB1D;AACA;AACA;AACA;AACA;AACA;;AAEA,MAAMwG,0BAA0B,GAAG,oCAAnC;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,SAASC,SAAT,CAAmBC,MAAnB,EAA2B;AACzB,QAAMC,YAAY,GAAGpK,MAAM,CAACqK,IAAP,CAAYC,CAAZ,EAA0BC,IAA1B,CAAgCzK,GAAD,IAASwK,CAAY,CAACxK,GAAD,CAAZ,KAAsBqK,MAA9D,CAArB;AAEA,SAAOC,YAAY,KAAK3K,SAAjB,GAA6B,IAA7B,GAAoC2K,YAA3C;AACD;AAED;AACA;AACA;AACA;AACA;AACA;;;AACe,MAAMI,gBAAN,SAA+BC,CAA/B,CAA6C;AAC1DvK,EAAAA,WAAW,CAAC/C,UAAD,EAAa;AACtB,UAAMA,UAAN;AAEA,SAAKuN,oBAAL,GAA4B,EAA5B;AACD;AAED;AACF;AACA;AACA;AACA;AACA;AACA;;;AACmB,QAAXC,WAAW,CAAClH,EAAD,EAAK;AACpB,UAAM;AACJG,MAAAA,EADI;AAEJgH,MAAAA,MAFI;AAGJC,MAAAA,WAHI;AAIJC,MAAAA,SAJI;AAKJC,MAAAA,QALI;AAMJC,MAAAA,MANI;AAOJC,MAAAA;AAPI,QAQF,MAAM,KAAK9N,UAAL,CAAgB+N,MAAhB,CAAuB3H,GAAvB,CAA2BE,EAA3B,CARV;AAUAZ,IAAAA,MAAM,CAACQ,KAAP,CAAa,QAAb,EAAuBI,EAAvB,EAA2B,eAA3B,EAA4C,CAAC,aAAD,EAAgB;AAACA,MAAAA;AAAD,KAAhB,CAA5C;AAEA,WAAO;AACLA,MAAAA,EAAE,EAAEG,EADC;AAELgH,MAAAA,MAFK;AAGLC,MAAAA,WAHK;AAILC,MAAAA,SAJK;AAKLC,MAAAA,QALK;AAMLC,MAAAA,MANK;AAOLG,MAAAA,KAAK,EAAEF;AAPF,KAAP;AASD;AAED;AACF;AACA;AACA;AACA;AACA;;;AACEG,EAAAA,KAAK,GAAG;AACNvI,IAAAA,MAAM,CAACQ,KAAP,CAAa,QAAb,EAAuB5D,SAAvB,EAAkC,SAAlC,EAA6C,QAA7C,EADM;;AAIN,WAAOkE,KAAK,CAAC,MAAM,KAAKgH,WAAL,CAAiB,IAAjB,CAAP,CAAL,CAAoCpL,IAApC;AAEL8H,IAAAA,OAAO,CAAEgE,MAAD,IAAY1H,KAAK,CACvB,MAAM,KAAKxG,UAAL,CAAgB6K,QAAhB,CAAyBsD,QAAzB,CAAkC/H,GAAlC,CAAsC,CAAC8H,MAAM,CAACzH,EAAR,CAAtC,CADiB,CAAL,CAElBrE,IAFkB;AAIlB2F,IAAAA,UAAU,CAAC,MAAMqG,EAAE,CAAC;AAACpB,MAAAA,MAAM,EAAE;AAAT,KAAD,CAAT,CAJQ;AAMlB9K,IAAAA,GAAG,CAAC;AAAA,UAAC;AAAC8K,QAAAA;AAAD,OAAD;AAAA,aAAe,EAAC,GAAGkB,MAAJ;AAAYlB,QAAAA,MAAM,EAAED,SAAS,CAACC,MAAD;AAA7B,OAAf;AAAA,KAAD,CANe,CAAb,CAFF,CAAP;AAWD;AAED;AACF;AACA;AACA;AACA;AACA;;;AACEqB,EAAAA,SAAS,CAAC/H,EAAD,EAAK;AACZZ,IAAAA,MAAM,CAACQ,KAAP,CAAa,QAAb,EAAuBI,EAAvB,EAA2B,aAA3B,EAA0C,CAAC,aAAD,EAAgB;AAACA,MAAAA;AAAD,KAAhB,CAA1C;;AACA,QAAI,EAAEA,EAAE,IAAI,KAAKiH,oBAAb,CAAJ,EAAwC;AACtC,YAAMe,UAAU,GAAG1D,kBAAkB,CAACtE,EAAD,CAAlB,CAAuBG,EAA1C;AACA,YAAM8H,OAAO,GAAG/H,KAAK,CAAC,MAAM,KAAKgH,WAAL,CAAiBlH,EAAjB,CAAP,CAArB,CAFsC;AAKtC;;AACA,YAAMkI,iBAAiB,GAAGhI,KAAK,CAC7B,MAAM,KAAKxG,UAAL,CAAgB6K,QAAhB,CAAyBsD,QAAzB,CAAkC1M,SAAlC,CAA4C6M,UAA5C,CADuB,CAAL,CAExBlM,IAFwB,CAGxBF,GAAG,CAAEe,IAAD,IAAUA,IAAI,CAACwL,SAAL,CAAe,CAAf,EAAkBzB,MAAlB,CAAyBA,MAApC,CAHqB;AAIxBjF,MAAAA,UAAU,CAAC,MAAMqG,EAAE,CAAC,IAAD,CAAT,CAJc;AAKxBlE,MAAAA,OAAO,CAAE8C,MAAD,IAAYuB,OAAO,CAACnM,IAAR,CAClBF,GAAG,CAAEgM,MAAD,KAAa,EAAC,GAAGA,MAAJ;AAAYlB,QAAAA,MAAM,EAAED,SAAS,CAACC,MAAD;AAA7B,OAAb,CAAD,CADe,CAAb,CALiB,CAA1B,CANsC;;AAiBtC,YAAM0B,aAAa,GAAG3E,SAAS,CAC7B,KAAK/J,UAAL,CAAgB6K,QAAhB,CAAyBuB,OADI,EAE7BU,0BAF6B,CAAT,CAGpB1K,IAHoB,CAIpB0F,GAAG,CAAC,MAAM;AACRpC,QAAAA,MAAM,CAACQ,KAAP,CACE,QADF,EACYI,EADZ,EACgB,WADhB,EAC6B,CAAC,UAAD,EAAawG,0BAAb,EAAyC,OAAzC,CAD7B;AAGD,OAJE,CAJiB,EASpB9C,MAAM,CAAEC,KAAD,IAAWA,KAAK,CAAChH,IAAN,CAAW0L,OAAX,KAAuBL,UAAnC,CATc,EAUpBpM,GAAG,CAAE+H,KAAD,IAAW8C,SAAS,CAAC9C,KAAK,CAAChH,IAAN,CAAW+J,MAAZ,CAArB,CAViB,CAAtB,CAjBsC;;AA+BtC,YAAM4B,aAAa,GAAGL,OAAO,CAACnM,IAAR,CACpB8H,OAAO,CAAEgE,MAAD,IAAYQ,aAAa,CAACtM,IAAd,CAAmBF,GAAG,CAAE8K,MAAD,KAAa,EAAC,GAAGkB,MAAJ;AAAYlB,QAAAA;AAAZ,OAAb,CAAD,CAAtB,CAAb,CADa,EAEpBlF,GAAG,CAAEoG,MAAD,IAAY;AACdxI,QAAAA,MAAM,CAACQ,KAAP,CAAa,QAAb,EAAuBI,EAAvB,EAA2B,aAA3B,EAA0C,CAAC,eAAD,EAAkB;AAAC4H,UAAAA;AAAD,SAAlB,CAA1C;AACD,OAFE,CAFiB,CAAtB,CA/BsC;;AAuCtC,YAAMW,UAAU,GAAGzE,MAAM,CAACoE,iBAAD,EAAoBI,aAApB,CAAN,CAAyCxM,IAAzC,CACjB0F,GAAG,CAAEoG,MAAD,IAAY;AACdxI,QAAAA,MAAM,CAACQ,KAAP,CAAa,QAAb,EAAuBI,EAAvB,EAA2B,aAA3B,EAA0C,CAAC,qBAAD,EAAwB;AAAC4H,UAAAA;AAAD,SAAxB,CAA1C;AACD,OAFE,CADc,EAIjB5D,QAAQ,CAAC,YAAY;AACnB,YAAI;AACF5E,UAAAA,MAAM,CAACQ,KAAP,CAAa,QAAb,EAAuBI,EAAvB,EAA2B,aAA3B,EAA0C,CAAC,qCAAD,EAAwC;AAACgI,YAAAA;AAAD,WAAxC,CAA1C,EADE;;AAGF,gBAAM,KAAKtO,UAAL,CAAgB6K,QAAhB,CAAyBsD,QAAzB,CAAkCrM,WAAlC,CAA8CwM,UAA9C,CAAN;AACD,SAJD,CAIE,OAAO1M,KAAP,EAAc;AACd;AACA;AACA8D,UAAAA,MAAM,CAACoJ,IAAP,CAAY,oDAAZ;AACD;;AAED,eAAO,KAAKvB,oBAAL,CAA0BjH,EAA1B,CAAP;AACD,OAZO,CAJS,CAAnB,CAvCsC;;AA2DtC,WAAKiH,oBAAL,CAA0BjH,EAA1B,IAAgCuI,UAAU,CAACzM,IAAX,CAC9BmI,aAAa,CAAC,CAAD,CADiB,EAE9BC,QAAQ,EAFsB,CAAhC;AAID;;AAED,WAAO,KAAK+C,oBAAL,CAA0BjH,EAA1B,CAAP;AACD;;AAvIyD;;AClD7C,MAAMyI,cAAN,CAAqB;AAClC;AACF;AACA;AACA;AACA;AACA;AACEhM,EAAAA,WAAW,CAACiM,OAAD,EAAUC,SAAV,EAAqB;AAC9B,SAAKD,OAAL,GAAeA,OAAf;AACA,SAAK1I,EAAL,GAAU2I,SAAV;AACD;;AAViC;;ACMpC;AACA;AACA;AACA;AACA;AACA;;AAEe,MAAMC,YAAN,SAA2BH,cAA3B,CAA0C;AACvD;AACF;AACA;AACA;AACA;AACA;AACEvK,EAAAA,MAAM,CAAC2K,SAAD,EAAY;AAChBzJ,IAAAA,MAAM,CAACQ,KAAP,CAAa,SAAb,EAAwBiJ,SAAxB,EAAmC,wBAAnC,EAA6D,CAAC,aAAD,EAAgB;AAACA,MAAAA;AAAD,KAAhB,CAA7D;AAEA,WAAO,KAAKH,OAAL,CAAaI,gBAAb,CAA8BD,SAA9B,CAAP;AACD;AAED;AACF;AACA;AACA;AACA;AACA;AACA;;;AACEE,EAAAA,OAAO,CAACF,SAAD,EAAY;AACjBzJ,IAAAA,MAAM,CAACQ,KAAP,CAAa,SAAb,EAAwBiJ,SAAxB,EAAmC,yBAAnC,EAA8D,CAAC,aAAD,EAAgB;AAACA,MAAAA;AAAD,KAAhB,CAA9D;AAEA,UAAMG,MAAM,GAAG;AACbhJ,MAAAA,EAAE,EAAE,KAAKA,EADI;AAEbqB,MAAAA,IAAI,EAAE;AAFO,KAAf;AAKA,UAAM4H,MAAM,GAAG;AACbC,MAAAA,KAAK,EAAE;AACLC,QAAAA,IAAI,EAAE,kBADD;AAELC,QAAAA,OAAO,EAAE,cAFJ;AAGLC,QAAAA,KAAK,EAAEC,CAAmB,CAACC,MAHtB;AAILlJ,QAAAA,IAAI,EAAE;AAJD,OADM;AAObmJ,MAAAA,OAAO,EAAE;AACPL,QAAAA,IAAI,EAAE,YADC;AAEPC,QAAAA,OAAO,EAAE,YAFF;AAGPC,QAAAA,KAAK,EAAEC,CAAmB,CAACG,QAHpB;AAIPpJ,QAAAA,IAAI,EAAE;AAJC,OAPI;AAabqJ,MAAAA,MAAM,EAAE;AACNP,QAAAA,IAAI,EAAE,YADA;AAENC,QAAAA,OAAO,EAAE,cAFH;AAGNC,QAAAA,KAAK,EAAEC,CAAmB,CAACK,QAHrB;AAINtJ,QAAAA,IAAI,EAAE;AAJA,OAbK;AAmBbuJ,MAAAA,QAAQ,EAAE;AACRT,QAAAA,IAAI,EAAE,kBADE;AAERC,QAAAA,OAAO,EAAE,gBAFD;AAGRC,QAAAA,KAAK,EAAEC,CAAmB,CAACK,QAHnB;AAIRtJ,QAAAA,IAAI,EAAE;AAJE,OAnBG;AAyBbwJ,MAAAA,YAAY,EAAE;AACZV,QAAAA,IAAI,EAAE,kBADM;AAEZC,QAAAA,OAAO,EAAE,yBAFG;AAGZC,QAAAA,KAAK,EAAEC,CAAmB,CAACK,QAHf;AAIZtJ,QAAAA,IAAI,EAAE;AAJM;AAzBD,KAAf;AAiCA,WAAO,KAAKqI,OAAL,CAAaoB,UAAb,CAAwBjB,SAAxB,EAAmC/M,IAAnC,CACLF,GAAG,CAAC;AAAA,UAAC;AAACmO,QAAAA,UAAU,EAAE;AAACC,UAAAA,MAAD;AAASN,UAAAA;AAAT,SAAb;AAA+BO,QAAAA;AAA/B,OAAD;AAAA,aACDP,MAAM,KAAK,IAAX,IAAmBT,MAAM,CAACS,MAA3B,IACMA,MAAM,KAAK,KAAX,IAAoBT,MAAM,CAACW,QADjC,IAEMI,MAAM,IAAIf,MAAM,CAACO,OAFvB,IAGMS,kBAAkB,IAAIhB,MAAM,CAACC,KAHnC,IAIKD,MAAM,CAACY,YALV;AAAA,KAAD,CADE,EAQLK,oBAAoB,EARf,EASLtO,GAAG,CAAEyN,KAAD,KAAY,EAAC,GAAGL,MAAJ;AAAY,SAAGK;AAAf,KAAZ,CAAD,CATE,EAUL7H,GAAG,CAAEuH,OAAD,IAAa3J,MAAM,CAACQ,KAAP,CAAa,SAAb,EAAwBiJ,SAAxB,EAAmC,yBAAnC,EAA8D,CAAC,UAAD,EAAaE,OAAb,CAA9D,CAAd,CAVE,CAAP;AAYD;;AAzEsD;;ACRzD;AACA;AACA;AACA;AACA;AACA;;AAEe,MAAMoB,WAAN,SAA0B1B,cAA1B,CAAyC;AACtD;AACF;AACA;AACA;AACA;AACc,QAANvK,MAAM,CAAC2K,SAAD,EAAY;AACtBzJ,IAAAA,MAAM,CAACQ,KAAP,CAAa,SAAb,EAAwBiJ,SAAxB,EAAmC,uBAAnC,EAA4D,CAAC,aAAD,EAAgB;AAACA,MAAAA;AAAD,KAAhB,CAA5D;AAEA,UAAM,KAAKH,OAAL,CAAa0B,YAAb,CAA0BvB,SAA1B,CAAN;AACD;AAED;AACF;AACA;AACA;AACA;AACA;AACE;;;AACAE,EAAAA,OAAO,CAACF,SAAD,EAAY;AACjBzJ,IAAAA,MAAM,CAACQ,KAAP,CAAa,SAAb,EAAwBiJ,SAAxB,EAAmC,wBAAnC,EAA6D,QAA7D;AAEA,WAAOf,EAAE,CAAC;AACR9H,MAAAA,EAAE,EAAE,KAAKA,EADD;AAERqB,MAAAA,IAAI,EAAE,QAFE;AAGR8H,MAAAA,IAAI,EAAE,QAHE;AAIRC,MAAAA,OAAO,EAAE;AAJD,KAAD,CAAF,CAKJtN,IALI,CAML0F,GAAG,CAAEuH,OAAD,IAAa3J,MAAM,CAACQ,KAAP,CAAa,SAAb,EAAwBiJ,SAAxB,EAAmC,wBAAnC,EAA6D,CAAC,UAAD,EAAaE,OAAb,CAA7D,CAAd,CANE,CAAP;AAQD;;AA9BqD;;ACNxD;AACA;AACA;AACA;AACA;AACA;;AAEe,MAAMsB,WAAN,SAA0B5B,cAA1B,CAAyC;AACtD;AACF;AACA;AACA;AACA;AACc,QAANvK,MAAM,CAAC2K,SAAD,EAAY;AACtBzJ,IAAAA,MAAM,CAACQ,KAAP,CAAa,SAAb,EAAwBiJ,SAAxB,EAAmC,uBAAnC,EAA4D,CAAC,aAAD,EAAgB;AAACA,MAAAA;AAAD,KAAhB,CAA5D;AAEA,UAAM,KAAKH,OAAL,CAAa4B,WAAb,CAAyBzB,SAAzB,CAAN;AACD;AAED;AACF;AACA;AACA;AACA;AACE;;;AACAE,EAAAA,OAAO,CAACF,SAAD,EAAY;AACjBzJ,IAAAA,MAAM,CAACQ,KAAP,CAAa,SAAb,EAAwBiJ,SAAxB,EAAmC,wBAAnC,EAA6D,CAAC,aAAD,EAAgB;AAACA,MAAAA;AAAD,KAAhB,CAA7D;AAEA,WAAO,KAAKH,OAAL,CAAaoB,UAAb,CAAwBjB,SAAxB,EAAmC/M,IAAnC,CACLF,GAAG,CAAE2O,OAAD,IAAa;AACf,YAAMC,IAAI,GAAG,CAACD,OAAO,CAACR,UAAR,CAAmBC,MAAnB,GAA4B,WAA5B,GAA0C,SAA3C,KACVO,OAAO,CAACE,UAAR,CAAmBT,MAAnB,GAA4B,UAA5B,GAAyC,WAD/B,CAAb;AAEA,YAAMX,KAAK,GAAGkB,OAAO,CAAClB,KAAR,KAAkB,YAAlB,GAAiCC,CAAmB,CAACC,MAArD,GAA8DD,CAAmB,CAACK,QAAhG;AAEA,aAAO;AACLa,QAAAA,IADK;AAELnB,QAAAA;AAFK,OAAP;AAID,KATE,CADE,EAWLa,oBAAoB,CAAC,CAACQ,IAAD,EAAOC,IAAP,KAClBD,IAAI,CAACF,IAAL,KAAcG,IAAI,CAACH,IAApB,IAA8BE,IAAI,CAACrB,KAAL,KAAesB,IAAI,CAACtB,KADhC,CAXf,EAcLzN,GAAG,CAAC;AAAA,UAAC;AAAC4O,QAAAA,IAAD;AAAOnB,QAAAA;AAAP,OAAD;AAAA,aAAoB;AACtBrJ,QAAAA,EAAE,EAAE,KAAKA,EADa;AAEtBqB,QAAAA,IAAI,EAAE,MAFgB;AAGtBhB,QAAAA,IAAI,EAAE,cAHgB;AAItB+I,QAAAA,OAAO,EAAE,cAJa;AAKtBoB,QAAAA,IALsB;AAMtBnB,QAAAA;AANsB,OAApB;AAAA,KAAD,CAdE,EAsBL7H,GAAG,CAAEuH,OAAD,IAAa3J,MAAM,CAACQ,KAAP,CAAa,SAAb,EAAwBiJ,SAAxB,EAAmC,wBAAnC,EAA6D,CAAC,UAAD,EAAaE,OAAb,CAA7D,CAAd,CAtBE,CAAP;AAwBD;;AA7CqD;;ACPxD;AACA;AACA;AACA;AACA;AACA;;AAEe,MAAM6B,aAAN,SAA4BnC,cAA5B,CAA2C;AACxD;AACF;AACA;AACA;AACA;AACA;AACc,QAANvK,MAAM,CAAC2K,SAAD,EAAY;AACtBzJ,IAAAA,MAAM,CAACQ,KAAP,CAAa,SAAb,EAAwBiJ,SAAxB,EAAmC,yBAAnC,EAA8D,CAAC,aAAD,EAAgB;AAACA,MAAAA;AAAD,KAAhB,CAA9D;AAEA,UAAM,KAAKH,OAAL,CAAamC,YAAb,CAA0BhC,SAA1B,CAAN;AACD;AAED;AACF;AACA;AACA;AACA;AACA;;;AACEE,EAAAA,OAAO,CAACF,SAAD,EAAY;AACjBzJ,IAAAA,MAAM,CAACQ,KAAP,CAAa,SAAb,EAAwBiJ,SAAxB,EAAmC,0BAAnC,EAA+D,CAAC,aAAD,EAAgB;AAACA,MAAAA;AAAD,KAAhB,CAA/D;AACA,UAAMiC,MAAM,GAAG;AACb9K,MAAAA,EAAE,EAAE,KAAKA,EADI;AAEbqB,MAAAA,IAAI,EAAE,QAFO;AAGbgI,MAAAA,KAAK,EAAEC,CAAmB,CAACC,MAHd;AAIbJ,MAAAA,IAAI,EAAE,kBAJO;AAKb9I,MAAAA,IAAI,EAAE,mBALO;AAMb+I,MAAAA,OAAO,EAAE;AANI,KAAf;AAQA,UAAM2B,QAAQ,GAAG;AACf/K,MAAAA,EAAE,EAAE,KAAKA,EADM;AAEfqB,MAAAA,IAAI,EAAE,QAFS;AAGfgI,MAAAA,KAAK,EAAEC,CAAmB,CAACG,QAHZ;AAIfN,MAAAA,IAAI,EAAE,kBAJS;AAKf9I,MAAAA,IAAI,EAAE,mBALS;AAMf+I,MAAAA,OAAO,EAAE;AANM,KAAjB;AASA,WAAO,KAAKV,OAAL,CAAaoB,UAAb,CAAwBjB,SAAxB,EAAmC/M,IAAnC,CACLF,GAAG,CAAC;AAAA,UAAC;AAACoP,QAAAA;AAAD,OAAD;AAAA,aAAmBA,UAAU,GAAGF,MAAH,GAAYC,QAAzC;AAAA,KAAD,CADE,EAELb,oBAAoB,EAFf,EAGL1I,GAAG,CAAEuH,OAAD,IAAa3J,MAAM,CAACQ,KAAP,CAAa,SAAb,EAAwBiJ,SAAxB,EAAmC,0BAAnC,EAA+D,CAAC,UAAD,EAAaE,OAAb,CAA/D,CAAd,CAHE,CAAP;AAKD;;AA3CuD;;ACP1D;AACA;AACA;AACA;AACA;AACA;;AAEe,MAAMkC,eAAN,SAA8BxC,cAA9B,CAA6C;AAC1D;AACF;AACA;AACA;AACA;AACA;AACEvK,EAAAA,MAAM,CAAC2K,SAAD,EAAY;AAChBzJ,IAAAA,MAAM,CAACQ,KAAP,CAAa,SAAb,EAAwBiJ,SAAxB,EAAmC,2BAAnC,EAAgE,CAAC,aAAD,EAAgB;AAACA,MAAAA;AAAD,KAAhB,CAAhE;AAEA,SAAKH,OAAL,CAAawC,cAAb,CAA4BrC,SAA5B;AACD;AAED;AACF;AACA;AACA;AACA;AACA;;;AACEE,EAAAA,OAAO,CAACF,SAAD,EAAY;AACjBzJ,IAAAA,MAAM,CAACQ,KAAP,CAAa,SAAb,EAAwBiJ,SAAxB,EAAmC,4BAAnC,EAAiE,CAAC,aAAD,EAAgB;AAACA,MAAAA;AAAD,KAAhB,CAAjE;AACA,UAAMiC,MAAM,GAAG;AACb9K,MAAAA,EAAE,EAAE,KAAKA,EADI;AAEbqB,MAAAA,IAAI,EAAE,QAFO;AAGbgI,MAAAA,KAAK,EAAEC,CAAmB,CAACC,MAHd;AAIbJ,MAAAA,IAAI,EAAE,UAJO;AAKb9I,MAAAA,IAAI,EAAE,UALO;AAMb+I,MAAAA,OAAO,EAAE;AANI,KAAf;AAQA,UAAM2B,QAAQ,GAAG;AACf/K,MAAAA,EAAE,EAAE,KAAKA,EADM;AAEfqB,MAAAA,IAAI,EAAE,QAFS;AAGfgI,MAAAA,KAAK,EAAEC,CAAmB,CAACG,QAHZ;AAIfN,MAAAA,IAAI,EAAE,UAJS;AAKf9I,MAAAA,IAAI,EAAE,UALS;AAMf+I,MAAAA,OAAO,EAAE;AANM,KAAjB;AASA,WAAO,KAAKV,OAAL,CAAaoB,UAAb,CAAwBjB,SAAxB,EAAmC/M,IAAnC,CACLF,GAAG,CAAC;AAAA,UAAC;AAACuP,QAAAA;AAAD,OAAD;AAAA,aAAqBA,YAAY,GAAGL,MAAH,GAAYC,QAA7C;AAAA,KAAD,CADE,EAELb,oBAAoB,EAFf,EAGL1I,GAAG,CAAEuH,OAAD,IAAa3J,MAAM,CAACQ,KAAP,CAAa,SAAb,EAAwBiJ,SAAxB,EAAmC,4BAAnC,EAAiE,CAAC,UAAD,EAAaE,OAAb,CAAjE,CAAd,CAHE,CAAP;AAKD;;AA3CyD;;ACP5D;AACA;AACA;AACA;AACA;AACA;;AAEe,MAAMqC,YAAN,SAA2B3C,cAA3B,CAA0C;AACvD;AACF;AACA;AACA;AACA;AACc,QAANvK,MAAM,CAAC2K,SAAD,EAAY;AACtBzJ,IAAAA,MAAM,CAACQ,KAAP,CAAa,SAAb,EAAwBiJ,SAAxB,EAAmC,wBAAnC,EAA6D,CAAC,aAAD,EAAgB;AAACA,MAAAA;AAAD,KAAhB,CAA7D;AAEA,UAAM,KAAKH,OAAL,CAAa2C,gBAAb,CAA8BxC,SAA9B,CAAN;AACD;AAED;AACF;AACA;AACA;AACA;AACA;;;AACEE,EAAAA,OAAO,CAACF,SAAD,EAAY;AACjBzJ,IAAAA,MAAM,CAACQ,KAAP,CAAa,SAAb,EAAwBiJ,SAAxB,EAAmC,yBAAnC,EAA8D,CAAC,aAAD,EAAgB;AAACA,MAAAA;AAAD,KAAhB,CAA9D;AACA,UAAMkC,QAAQ,GAAG;AACf/K,MAAAA,EAAE,EAAE,KAAKA,EADM;AAEfqB,MAAAA,IAAI,EAAE,QAFS;AAGfgI,MAAAA,KAAK,EAAEC,CAAmB,CAACG,QAHZ;AAIfN,MAAAA,IAAI,EAAE,8BAJS;AAKf9I,MAAAA,IAAI,EAAE,eALS;AAMf+I,MAAAA,OAAO,EAAE;AANM,KAAjB;AAQA,UAAM0B,MAAM,GAAG;AACb9K,MAAAA,EAAE,EAAE,KAAKA,EADI;AAEbqB,MAAAA,IAAI,EAAE,QAFO;AAGbgI,MAAAA,KAAK,EAAEC,CAAmB,CAACC,MAHd;AAIbJ,MAAAA,IAAI,EAAE,8BAJO;AAKb9I,MAAAA,IAAI,EAAE,cALO;AAMb+I,MAAAA,OAAO,EAAE;AANI,KAAf;AASA,WAAO,KAAKV,OAAL,CAAaoB,UAAb,CAAwBjB,SAAxB,EAAmC/M,IAAnC,CACLF,GAAG,CAAC;AAAA,UAAC;AAAC0P,QAAAA,UAAU,EAAE;AAACtB,UAAAA;AAAD;AAAb,OAAD;AAAA,aAA6BA,MAAM,GAAGc,MAAH,GAAYC,QAA/C;AAAA,KAAD,CADE,EAELb,oBAAoB,EAFf,EAGL1I,GAAG,CAAEuH,OAAD,IAAa3J,MAAM,CAACQ,KAAP,CAAa,SAAb,EAAwBiJ,SAAxB,EAAmC,yBAAnC,EAA8D,CAAC,UAAD,EAAaE,OAAb,CAA9D,CAAd,CAHE,CAAP;AAKD;;AA1CsD;;ACRzD;AACA;AACA;AACA;AACA;AACA;;AAEe,MAAMwC,mBAAN,SAAkC9C,cAAlC,CAAiD;AAC9D;AACF;AACA;AACA;AACA;AACA;AACc,QAANvK,MAAM,CAAC2K,SAAD,EAAY2C,QAAZ,EAAsB;AAChCpM,IAAAA,MAAM,CAACQ,KAAP,CAAa,SAAb,EAAwBiJ,SAAxB,EAAmC,+BAAnC,EAAoE,CAAC,aAAD,EAAgB;AAACA,MAAAA;AAAD,KAAhB,CAApE;AAEA,UAAM,KAAKH,OAAL,CAAa+C,YAAb,CAA0B5C,SAA1B,EAAqC2C,QAArC,CAAN;AACD;AAED;AACF;AACA;AACA;AACA;AACA;;;AACEzC,EAAAA,OAAO,CAACF,SAAD,EAAY;AACjBzJ,IAAAA,MAAM,CAACQ,KAAP,CAAa,SAAb,EAAwBiJ,SAAxB,EAAmC,gCAAnC,EAAqE,CAAC,aAAD,EAAgB;AAACA,MAAAA;AAAD,KAAhB,CAArE;AAEA,UAAM6C,SAAS,GAAG,KAAKhD,OAAL,CAAaoB,UAAb,CAAwBjB,SAAxB,EAAmC/M,IAAnC,CAChBF,GAAG,CAAE2O,OAAD,IAAaA,OAAO,CAACiB,QAAtB,CADa,EAEhBtB,oBAAoB,EAFJ,CAAlB;AAKA,UAAMyB,QAAQ,GAAG,KAAKjD,OAAL,CAAakD,mBAAb,CAAiC/C,SAAjC,EAA4C,YAA5C,EAA0D/M,IAA1D,CACfF,GAAG,CAAEiQ,gBAAD,IAAsBA,gBAAgB,CAACjQ,GAAjB,CAAsBkQ,MAAD,KAAa;AAC1D1Q,MAAAA,KAAK,EAAE0Q,MAAM,CAACC,QAD4C;AAE1DC,MAAAA,KAAK,EAAEF,MAAM,CAACE;AAF4C,KAAb,CAArB,CAAvB,CADY,CAAjB;AAOA,WAAOvQ,sBAAsB,CAACiQ,SAAD,EAAYC,QAAZ,CAAtB,CAA4C7P,IAA5C,CACLF,GAAG,CAAC;AAAA,UAAC,CAAC4P,QAAD,EAAWS,OAAX,CAAD;AAAA,aAA0B;AAC5BjM,QAAAA,EAAE,EAAE,KAAKA,EADmB;AAE5BqB,QAAAA,IAAI,EAAE,aAFsB;AAG5B+H,QAAAA,OAAO,EAAE,eAHmB;AAI5B8C,QAAAA,gBAAgB,EAAE,sBAJU;AAK5BD,QAAAA,OAAO,EAAEA,OAAO,IAAI,IALQ;AAM5BE,QAAAA,QAAQ,EAAEX,QAAQ,IAAI,IANM;AAO5BhB,QAAAA,IAAI,EAAE;AAPsB,OAA1B;AAAA,KAAD,CADE,EAULhJ,GAAG,CAAEuH,OAAD,IAAa3J,MAAM,CAACQ,KAAP,CAAa,SAAb,EAAwBiJ,SAAxB,EAAmC,gCAAnC,EAAqE,CAAC,UAAD,EAAaE,OAAb,CAArE,CAAd,CAVE,CAAP;AAYD;;AA9C6D;;ACNhE;AACA;AACA;AACA;AACA;AACA;;AAEe,MAAMqD,uBAAN,SAAsC3D,cAAtC,CAAqD;AAClE;AACF;AACA;AACA;AACA;AACA;AACc,QAANvK,MAAM,CAAC2K,SAAD,EAAYwD,YAAZ,EAA0B;AACpCjN,IAAAA,MAAM,CAACQ,KAAP,CAAa,SAAb,EAAwBiJ,SAAxB,EAAmC,mCAAnC,EAAwE,CAAC,aAAD,EAAgB;AAACA,MAAAA;AAAD,KAAhB,CAAxE;AAEA,UAAM,KAAKH,OAAL,CAAa4D,gBAAb,CAA8BzD,SAA9B,EAAyCwD,YAAzC,CAAN;AACD;AAED;AACF;AACA;AACA;AACA;AACA;;;AACEtD,EAAAA,OAAO,CAACF,SAAD,EAAY;AACjBzJ,IAAAA,MAAM,CAACQ,KAAP,CAAa,SAAb,EAAwBiJ,SAAxB,EAAmC,oCAAnC,EAAyE,CAAC,aAAD,EAAgB;AAACA,MAAAA;AAAD,KAAhB,CAAzE;AAEA,UAAM0D,aAAa,GAAG,KAAK7D,OAAL,CAAaoB,UAAb,CAAwBjB,SAAxB,EAAmC/M,IAAnC,CACpBF,GAAG,CAAE2O,OAAD,IAAaA,OAAO,CAAC8B,YAAtB,CADiB,EAEpBnC,oBAAoB,EAFA,CAAtB;AAKA,UAAMyB,QAAQ,GAAG,KAAKjD,OAAL,CAAakD,mBAAb,CAAiC/C,SAAjC,EAA4C,YAA5C,EAA0D/M,IAA1D,CACfF,GAAG,CAAE4Q,oBAAD,IAA0BA,oBAAoB,CAAC5Q,GAArB,CAA0B6Q,UAAD,KAAiB;AACtErR,MAAAA,KAAK,EAAEqR,UAAU,CAACV,QADoD;AAEtEC,MAAAA,KAAK,EAAES,UAAU,CAACT;AAFoD,KAAjB,CAAzB,CAA3B,CADY,CAAjB;AAOA,WAAOvQ,sBAAsB,CAAC8Q,aAAD,EAAgBZ,QAAhB,CAAtB,CAAgD7P,IAAhD,CACLF,GAAG,CAAC;AAAA,UAAC,CAACyQ,YAAD,EAAeJ,OAAf,CAAD;AAAA,aAA8B;AAChCjM,QAAAA,EAAE,EAAE,KAAKA,EADuB;AAEhCqB,QAAAA,IAAI,EAAE,aAF0B;AAGhC+H,QAAAA,OAAO,EAAE,eAHuB;AAIhC8C,QAAAA,gBAAgB,EAAE,0BAJc;AAKhCD,QAAAA,OAAO,EAAEA,OAAO,IAAI,IALY;AAMhCE,QAAAA,QAAQ,EAAEE,YAAY,IAAI,IANM;AAOhC7B,QAAAA,IAAI,EAAE;AAP0B,OAA9B;AAAA,KAAD,CADE,EAULhJ,GAAG,CAAEuH,OAAD,IAAa3J,MAAM,CAACQ,KAAP,CAAa,SAAb,EAAwBiJ,SAAxB,EAAmC,oCAAnC,EAAyE,CAAC,UAAD,EAAaE,OAAb,CAAzE,CAAd,CAVE,CAAP;AAYD;;AA9CiE;;ACRpE;AACA;AACA;AACA;AACA;AACA;;AAEe,MAAM2D,oBAAN,SAAmCjE,cAAnC,CAAkD;AAC/D;AACF;AACA;AACA;AACA;AACA;AACc,QAANvK,MAAM,CAAC2K,SAAD,EAAY8D,SAAZ,EAAuB;AACjCvN,IAAAA,MAAM,CAACQ,KAAP,CAAa,SAAb,EAAwBiJ,SAAxB,EAAmC,gCAAnC,EAAqE,CAAC,aAAD,EAAgB;AAACA,MAAAA;AAAD,KAAhB,CAArE;AAEA,UAAM,KAAKH,OAAL,CAAakE,aAAb,CAA2B/D,SAA3B,EAAsC8D,SAAtC,CAAN;AACD;AAED;AACF;AACA;AACA;AACA;AACA;;;AACE5D,EAAAA,OAAO,CAACF,SAAD,EAAY;AACjBzJ,IAAAA,MAAM,CAACQ,KAAP,CAAa,SAAb,EAAwBiJ,SAAxB,EAAmC,iCAAnC,EAAsE,CAAC,aAAD,EAAgB;AAACA,MAAAA;AAAD,KAAhB,CAAtE;AAEA,UAAMgE,UAAU,GAAG,KAAKnE,OAAL,CAAaoB,UAAb,CAAwBjB,SAAxB,EAAmC/M,IAAnC,CACjBF,GAAG,CAAE2O,OAAD,IAAaA,OAAO,CAACoC,SAAtB,CADc,EAEjBzC,oBAAoB,EAFH,CAAnB;AAKA,UAAMyB,QAAQ,GAAG,KAAKjD,OAAL,CAAakD,mBAAb,CAAiC/C,SAAjC,EAA4C,aAA5C,EAA2D/M,IAA3D,CACfF,GAAG,CAAEkR,iBAAD,IAAuBA,iBAAiB,CAAClR,GAAlB,CAAuBmR,OAAD,KAAc;AAC7D3R,MAAAA,KAAK,EAAE2R,OAAO,CAAChB,QAD8C;AAE7DC,MAAAA,KAAK,EAAEe,OAAO,CAACf;AAF8C,KAAd,CAAtB,CAAxB,CADY,EAKfpQ,GAAG,CAAEqQ,OAAD,IAAc,CAAC;AAAC7Q,MAAAA,KAAK,EAAE,EAAR;AAAY4Q,MAAAA,KAAK,EAAE;AAAnB,KAAD,EAAwC,GAAGC,OAA3C,CAAf,CALY,CAAjB;AAQA,WAAOxQ,sBAAsB,CAACoR,UAAD,EAAalB,QAAb,CAAtB,CAA6C7P,IAA7C,CACLF,GAAG,CAAC;AAAA,UAAC,CAAC+Q,SAAD,EAAYV,OAAZ,CAAD;AAAA,aAA2B;AAC7BjM,QAAAA,EAAE,EAAE,KAAKA,EADoB;AAE7BqB,QAAAA,IAAI,EAAE,aAFuB;AAG7B;AACA;AACA+H,QAAAA,OAAO,EAAE7L,kBAAkB,GAAG,iBAAH,GAAuB,wDALrB;AAM7B2O,QAAAA,gBAAgB,EAAE,uBANW;AAO7BD,QAAAA,OAAO,EAAEA,OAAO,IAAI,IAPS;AAQ7BE,QAAAA,QAAQ,EAAEQ,SAAS,IAAI,IARM;AAS7BnC,QAAAA,IAAI,EAAE;AATuB,OAA3B;AAAA,KAAD,CADE,EAYLhJ,GAAG,CAAEuH,OAAD,IAAa3J,MAAM,CAACQ,KAAP,CAAa,SAAb,EAAwBiJ,SAAxB,EAAmC,iCAAnC,EAAsE,CAAC,UAAD,EAAaE,OAAb,CAAtE,CAAd,CAZE,CAAP;AAcD;;AAjD8D;;ACNjE;AACA;AACA;AACA;AACA;AACA;;AAEe,MAAMiE,YAAN,SAA2BvE,cAA3B,CAA0C;AACvD;AACF;AACA;AACA;AACA;AACEvK,EAAAA,MAAM,CAAC2K,SAAD,EAAY;AAChBzJ,IAAAA,MAAM,CAACQ,KAAP,CAAa,SAAb,EAAwBiJ,SAAxB,EAAmC,wBAAnC,EAA6D,CAAC,aAAD,EAAgB;AAACA,MAAAA;AAAD,KAAhB,CAA7D;AAEA,WAAO,KAAKH,OAAL,CAAauE,gBAAb,CAA8BpE,SAA9B,CAAP;AACD;AAED;AACF;AACA;AACA;AACA;AACA;;;AACEE,EAAAA,OAAO,CAACF,SAAD,EAAY;AACjBzJ,IAAAA,MAAM,CAACQ,KAAP,CAAa,SAAb,EAAwBiJ,SAAxB,EAAmC,yBAAnC,EAA8D,CAAC,aAAD,EAAgB;AAACA,MAAAA;AAAD,KAAhB,CAA9D;AAEA,UAAMG,MAAM,GAAG;AACbhJ,MAAAA,EAAE,EAAE,KAAKA,EADI;AAEbqB,MAAAA,IAAI,EAAE;AAFO,KAAf;AAKA,UAAM4H,MAAM,GAAG;AACbC,MAAAA,KAAK,EAAE;AACLC,QAAAA,IAAI,EAAE,cADD;AAELC,QAAAA,OAAO,EAAE,aAFJ;AAGLC,QAAAA,KAAK,EAAEC,CAAmB,CAACC,MAHtB;AAILlJ,QAAAA,IAAI,EAAE;AAJD,OADM;AAObmJ,MAAAA,OAAO,EAAE;AACPL,QAAAA,IAAI,EAAE,QADC;AAEPC,QAAAA,OAAO,EAAE,YAFF;AAGPC,QAAAA,KAAK,EAAEC,CAAmB,CAACG,QAHpB;AAIPpJ,QAAAA,IAAI,EAAE;AAJC,OAPI;AAabqJ,MAAAA,MAAM,EAAE;AACNP,QAAAA,IAAI,EAAE,QADA;AAENC,QAAAA,OAAO,EAAE,gBAFH;AAGNC,QAAAA,KAAK,EAAEC,CAAmB,CAACK,QAHrB;AAINtJ,QAAAA,IAAI,EAAE;AAJA,OAbK;AAmBbuJ,MAAAA,QAAQ,EAAE;AACRT,QAAAA,IAAI,EAAE,cADE;AAERC,QAAAA,OAAO,EAAE,gBAFD;AAGRC,QAAAA,KAAK,EAAEC,CAAmB,CAACK,QAHnB;AAIRtJ,QAAAA,IAAI,EAAE;AAJE,OAnBG;AAyBb6M,MAAAA,QAAQ,EAAE;AACR/D,QAAAA,IAAI,EAAE,cADE;AAERC,QAAAA,OAAO,EAAE,qBAFD;AAGRC,QAAAA,KAAK,EAAEC,CAAmB,CAACK,QAHnB;AAIRtJ,QAAAA,IAAI,EAAE;AAJE;AAzBG,KAAf;AAiCA,WAAO,KAAKqI,OAAL,CAAaoB,UAAb,CAAwBjB,SAAxB,EAAmC/M,IAAnC,CACLF,GAAG,CAAC;AAAA,UAAC;AAAC6O,QAAAA,UAAU,EAAE;AAACT,UAAAA,MAAD;AAASN,UAAAA;AAAT,SAAb;AAA+ByD,QAAAA;AAA/B,OAAD;AAAA,aACDzD,MAAM,KAAK,IAAX,IAAmBT,MAAM,CAACS,MAA3B,IACIA,MAAM,KAAK,KAAX,IAAoBT,MAAM,CAACW,QAD/B,IAEII,MAAM,IAAIf,MAAM,CAACO,OAFrB,IAGI2D,kBAAkB,IAAIlE,MAAM,CAACC,KAHjC,IAIGD,MAAM,CAACiE,QALR;AAAA,KAAD,CADE,EAQLhD,oBAAoB,EARf,EASLtO,GAAG,CAAEyN,KAAD,KAAY,EAAC,GAAGL,MAAJ;AAAY,SAAGK;AAAf,KAAZ,CAAD,CATE,EAUL7H,GAAG,CAAEuH,OAAD,IAAa3J,MAAM,CAACQ,KAAP,CAAa,SAAb,EAAwBiJ,SAAxB,EAAmC,yBAAnC,EAA8D,CAAC,UAAD,EAAaE,OAAb,CAA9D,CAAd,CAVE,CAAP;AAYD;;AAvEsD;;ACwBzD;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;;AACA,MAAMqE,iBAAiB,GAAG,aAA1B;AACA,MAAMC,mBAAmB,GAAG,eAA5B;AACA,MAAMC,oBAAoB,GAAG,gBAA7B;AACA,MAAMC,sBAAsB,GAAG,6BAA/B;AACA,MAAMC,uBAAuB,GAAG,6BAAhC;AACA,MAAMC,wBAAwB,GAAG,8BAAjC;AACA,MAAMC,uBAAuB,GAAG,8BAAhC;;AAGA,MAAMC,qBAAqB,GAAG,yBAA9B;AACA,MAAMC,mBAAmB,GAAG,uBAA5B;AACA,MAAMC,uBAAuB,GAAG,2BAAhC;;AAGA,MAAMC,YAAY,GAAG,cAArB;AACA,MAAMC,YAAY,GAAG,eAArB;AACA,MAAMC,aAAa,GAAG,YAAtB;AACA,MAAMC,aAAa,GAAG,YAAtB;AACA,MAAMC,aAAa,GAAG,cAAtB;AACA,MAAMC,cAAc,GAAG,eAAvB;AACA,MAAMC,gBAAgB,GAAG,UAAzB;AACA,MAAMC,qBAAqB,GAAG,eAA9B;AACA,MAAMC,yBAAyB,GAAG,mBAAlC;AACA,MAAMC,sBAAsB,GAAG,gBAA/B;;AAGA,MAAMC,gBAAgB,GAAG,OAAzB;AACA,MAAMC,sBAAsB,GAAG,YAA/B;AACA,MAAMC,uBAAuB,GAAG,aAAhC;AACA,MAAMC,uBAAuB,GAAG,aAAhC;AACA,MAAMC,uBAAuB,GAAG,aAAhC;AACA,MAAMC,iBAAiB,GAAG,CACxBL,gBADwB,EAExBC,sBAFwB,EAGxBC,uBAHwB,EAIxBC,uBAJwB,EAKxBC,uBALwB,CAA1B;AAQA,MAAME,aAAa,GAAG;AACpBC,EAAAA,YAAY,EAAE,IADM;AAEpBC,EAAAA,YAAY,EAAE,IAFM;AAGpBC,EAAAA,YAAY,EAAE,IAHM;AAIpBC,EAAAA,SAAS,EAAE,IAJS;AAKpBC,EAAAA,SAAS,EAAE,IALS;AAMpBC,EAAAA,SAAS,EAAE;AANS,CAAtB;AASA,MAAMC,oBAAoB,GAAG,QAA7B;AACA,MAAMC,kBAAkB,GAAG,MAA3B;AAEA,MAAMC,gBAAgB,GAAG;AACvBC,EAAAA,OAAO,EAAE,gBADc;AAEvBC,EAAAA,IAAI,EAAE,OAFiB;AAGvBC,EAAAA,KAAK,EAAE,WAHgB;AAIvBC,EAAAA,SAAS,EAAE,UAJY;AAKvBC,EAAAA,KAAK,EAAE;AALgB,CAAzB;AAQA,MAAMC,0CAA0C,GAAG;AACjDC,EAAAA,QAAQ,EAAEC,CAAY,CAACC,KAD0B;AAEjDC,EAAAA,UAAU,EAAEF,CAAY,CAACG,MAFwB;AAGjDC,EAAAA,cAAc,EAAEJ,CAAY,CAACK;AAHoB,CAAnD;AAMA;AACA;AACA;AACA;AACA;AACA;;AACe,MAAMC,kBAAN,SAAiCC,CAAjC,CAAiD;AAC9D7T,EAAAA,WAAW,CAAC/C,UAAD,EAAa;AACtB,UAAMA,UAAN;AACA,SAAK6W,qBAAL,GAA6B,EAA7B;AACA,SAAKC,QAAL,GAAgB,EAAhB;AAEA,SAAKC,eAAL,GAAuB;AACrB,OAAC3C,YAAD,GAAgB,IAAIzD,WAAJ,CAAgB,IAAhB,EAAsByD,YAAtB,CADK;AAErB,OAACE,aAAD,GAAiB,IAAIpF,YAAJ,CAAiB,IAAjB,EAAuBoF,aAAvB,CAFI;AAGrB,OAACC,aAAD,GAAiB,IAAIjB,YAAJ,CAAiB,IAAjB,EAAuBiB,aAAvB,CAHI;AAIrB,OAACC,aAAD,GAAiB,IAAI9C,YAAJ,CAAiB,IAAjB,EAAuB8C,aAAvB,CAJI;AAKrB,OAACH,YAAD,GAAgB,IAAI5D,WAAJ,CAAgB,IAAhB,EAAsB4D,YAAtB,CALK;AAMrB,OAACI,cAAD,GAAkB,IAAIvD,aAAJ,CAAkB,IAAlB,EAAwBuD,cAAxB,CANG;AAOrB,OAACC,gBAAD,GAAoB,IAAInD,eAAJ,CAAoB,IAApB,EAA0BmD,gBAA1B,CAPC;AAQrB,OAACC,qBAAD,GAAyB,IAAI9C,mBAAJ,CAAwB,IAAxB,EAA8B8C,qBAA9B,CARJ;AASrB,OAACE,sBAAD,GAA0B,IAAI7B,oBAAJ,CAAyB,IAAzB,EAA+B6B,sBAA/B,CATL;AAUrB,OAACD,yBAAD,GAA6B,IAAIlC,uBAAJ,CAA4B,IAA5B,EAAkCkC,yBAAlC;AAVR,KAAvB;AAYD;AAED;AACF;AACA;AACA;;;AACe,QAAPoC,OAAO,GAAG;AACd,UAAM,KAAKhX,UAAL,CAAgB8W,QAAhB,CAAyBG,QAAzB,EAAN;AACA,UAAM,KAAKjX,UAAL,CAAgB8W,QAAhB,CAAyBI,YAAzB,EAAN;AACD;AAED;AACF;AACA;;;AACkB,QAAVC,UAAU,GAAG;AACjB,UAAM,KAAKnX,UAAL,CAAgB8W,QAAhB,CAAyBM,UAAzB,EAAN;AACD;AAED;AACF;AACA;AACA;AACA;AACA;AACA;;;AACEC,EAAAA,aAAa,CAAC/Q,EAAD,EAAK;AAChBZ,IAAAA,MAAM,CAACQ,KAAP,CAAa,SAAb,EAAwBI,EAAxB,EAA4B,iBAA5B,EAA+C,CAAC,aAAD,EAAgB;AAACA,MAAAA;AAAD,KAAhB,CAA/C;AACA,UAAM;AAACmP,MAAAA,SAAD;AAAYD,MAAAA;AAAZ,QAAyBJ,aAA/B;AAEA,WAAO,KAAKkC,uBAAL,CAA6B7B,SAA7B,EAAwCnP,EAAxC,EAA4C;AAACmP,MAAAA,SAAS,EAAE;AAAZ,KAA5C,EAA+DrT,IAA/D,CACLF,GAAG,CAAC;AAAA,UAAC;AACHqV,QAAAA,UADG;AAEHjH,QAAAA,MAFG;AAGHkH,QAAAA,MAHG;AAIHnF,QAAAA;AAJG,OAAD;AAAA,aAKG;AACLhC,QAAAA,UAAU,EAAE;AACVC,UAAAA,MADU;AAEViH,UAAAA,UAFU;AAGVE,UAAAA,uBAAuB,EAAED;AAHf,SADP;AAMLzG,QAAAA,UAAU,EAAE;AACVT,UAAAA,MAAM,EAAE,IADE;AAEViH,UAAAA,UAAU,EAAE;AAFF,SANP;AAUL5E,QAAAA,YAAY,EAAEN;AAVT,OALH;AAAA,KAAD,CADE,EAkBLnR,SAAS,CAAEwW,KAAD,IAAW,KAAKJ,uBAAL,CAA6B9B,SAA7B,EAAwClP,EAAxC,EAA4C;AAACkP,MAAAA,SAAS,EAAE;AAAZ,KAA5C,EAA+DpT,IAA/D,CACnBF,GAAG,CAAC;AAAA,UAAC;AACHqV,QAAAA,UADG;AAEHjH,QAAAA,MAFG;AAGHkH,QAAAA,MAHG;AAIHnF,QAAAA;AAJG,OAAD;AAAA,aAKG,EACL,GAAGqF,KADE;AAEL3G,QAAAA,UAAU,EAAE;AACVT,UAAAA,MADU;AAEViH,UAAAA,UAFU;AAGVE,UAAAA,uBAAuB,EAAED;AAHf,SAFP;AAOL1F,QAAAA,QAAQ,EAAEO;AAPL,OALH;AAAA,KAAD,CADgB,CAAZ,CAlBJ,CAAP;AAmCD;AAED;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACEsF,EAAAA,SAAS,CAACrR,EAAD,EAAKsR,cAAL,EAAqBC,UAArB,EAAiC;AACxCnS,IAAAA,MAAM,CAACQ,KAAP,CAAa,SAAb,EAAwBI,EAAxB,EAA4B,aAA5B,EAA2C,CAAC,aAAD,EAAgB;AAACA,MAAAA,EAAD;AAAKsR,MAAAA,cAAL;AAAqBC,MAAAA;AAArB,KAAhB,CAA3C;AAEA,WAAO,IAAIxW,UAAJ,CAAe,MAAOC,UAAP,IAAsB;AAC1C,UAAIwW,OAAO,GAAG,KAAd;AACA,UAAIC,QAAJ;;AAEA,UAAI;AACF,cAAMC,UAAU,GAAG,KAAKC,YAAL,CAAkB3R,EAAlB,CAAnB;;AAEA,cAAMkR,MAAM,GAAG,MAAM;AACnBM,UAAAA,OAAO,GAAG,IAAV;AACAxW,UAAAA,UAAU,CAACK,IAAX,CAAgB;AAAC4V,YAAAA,UAAU,EAAE,SAAb;AAAwBjH,YAAAA,MAAM,EAAE;AAAhC,WAAhB;AACAhP,UAAAA,UAAU,CAACO,QAAX;AACD,SAJD,CAHE;;;AAUFkW,QAAAA,QAAQ,GAAG,IAAX;AACAvX,QAAAA,UAAU,CAAC,MAAM;AACf,cAAIuX,QAAJ,EAAc;AACZ;AACAzW,YAAAA,UAAU,CAACK,IAAX,CAAgB;AAAC4V,cAAAA,UAAU,EAAE,QAAb;AAAuBjH,cAAAA,MAAM,EAAE,IAA/B;AAAqCkH,cAAAA;AAArC,aAAhB;AACD;AACF,SALS,EAKP,IALO,CAAV;AAOA,cAAM,CAACU,WAAD,IAAgB,MAAMF,UAAU,CAACG,eAAX,CAA2BP,cAA3B,EAA2CC,UAA3C,CAA5B;AACA,cAAMO,gBAAgB,GAAG,MAAMC,SAAS,CAACC,YAAV,CAAuBC,gBAAvB,EAA/B;AACA,cAAM,CAAC;AAACjG,UAAAA,KAAK,EAAEkG;AAAR,SAAD,IAAyBN,WAAW,CAACrY,SAAZ,EAA/B;AACA,cAAM4Y,WAAW,GAAGL,gBAAgB,CAAChL,IAAjB,CAAuBsL,MAAD,IAAYA,MAAM,CAACpG,KAAP,KAAiBkG,WAAnD,CAApB;AACA,cAAMnG,QAAQ,GAAGoG,WAAW,IAAIA,WAAW,CAACpG,QAA5C;AAEA0F,QAAAA,QAAQ,GAAG,KAAX;;AAEA,aAAK,MAAMlT,KAAX,IAAoBqT,WAAW,CAACrY,SAAZ,EAApB,EAA6C;AAC3C,cAAIgF,KAAK,CAACC,IAAN,KAAe,OAAf,IAA0B,CAAC8S,cAAc,CAACpC,SAA9C,EAAyD;AACvD0C,YAAAA,WAAW,CAACS,WAAZ,CAAwB9T,KAAxB;AACD;;AACD,cAAIA,KAAK,CAACC,IAAN,KAAe,OAAf,IAA0B,CAAC8S,cAAc,CAACnC,SAA9C,EAAyD;AACvDyC,YAAAA,WAAW,CAACS,WAAZ,CAAwB9T,KAAxB;AACD;AACF;;AAED,YAAI,CAACiT,OAAL,EAAc;AACZxW,UAAAA,UAAU,CAACK,IAAX,CAAgB;AAAC4V,YAAAA,UAAU,EAAE,SAAb;AAAwBjH,YAAAA,MAAM,EAAE4H,WAAhC;AAA6C7F,YAAAA;AAA7C,WAAhB;AACA/Q,UAAAA,UAAU,CAACO,QAAX;AACD;AACF,OAvCD,CAuCE,OAAOD,KAAP,EAAc;AACdmW,QAAAA,QAAQ,GAAG,KAAX;;AAEA,YAAI,CAACD,OAAL,EAAc;AACZ,cAAIc,IAAJ;AACA,gBAAMC,EAAE,GAAGjX,KAAK,CAACA,KAAjB;AAEA8D,UAAAA,MAAM,CAAC9D,KAAP,CAAa,SAAb,EAAwB0E,EAAxB,EAA4B,aAA5B,EAA2C,uCAA3C,EAAoFuS,EAAE,IAAIjX,KAA1F;;AAEA,cAAIiX,EAAE,YAAYC,YAAlB,EAAgC;AAC9B,gBAAID,EAAE,CAACE,IAAH,KAAY,iBAAhB,EAAmC;AACjC,kBAAIF,EAAE,CAACjV,OAAH,KAAe,sBAAnB,EAA2C;AACzCgV,gBAAAA,IAAI,GAAG,WAAP;AACD,eAFD,MAEO,IAAIC,EAAE,CAACjV,OAAH,KAAe,6BAAnB,EAAkD;AACvDgV,gBAAAA,IAAI,GAAG,UAAP;AACD,eAFM,MAEA;AACLA,gBAAAA,IAAI,GAAG,QAAP;AACD;AACF,aARD,MAQO,IAAIC,EAAE,CAACE,IAAH,KAAY,kBAAhB,EAAoC;AACzCH,cAAAA,IAAI,GAAG,UAAP;AACD,aAFM,MAEA;AACLA,cAAAA,IAAI,GAAG,OAAP;AACD;AACF,WAdD,MAcO;AACLA,YAAAA,IAAI,GAAG,OAAP;AACD;;AACDtX,UAAAA,UAAU,CAACK,IAAX,CAAgB;AAAC4V,YAAAA,UAAU,EAAEqB,IAAb;AAAmBtI,YAAAA,MAAM,EAAE;AAA3B,WAAhB;AACAhP,UAAAA,UAAU,CAACO,QAAX;AACD;AACF;AACF,KAzEM,CAAP;AA0ED;AAED;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACEyV,EAAAA,uBAAuB,CAAC0B,SAAD,EAAY1S,EAAZ,EAAgBsR,cAAhB,EAAgCC,UAAhC,EAA4C;AACjEnS,IAAAA,MAAM,CAACQ,KAAP,CAAa,SAAb,EAAwBI,EAAxB,EAA4B,2BAA5B,EAAyD,CAAC,0BAAD,EAA6B;AACpF0S,MAAAA,SADoF;AACzE1S,MAAAA,EADyE;AACrEsR,MAAAA,cADqE;AACrDC,MAAAA;AADqD,KAA7B,CAAzD;AAIA,WAAOmB,SAAS,GACZ,KAAKrB,SAAL,CAAerR,EAAf,EAAmBsR,cAAnB,EAAmCC,UAAnC,CADY,GAEZzJ,EAAE,CAAC;AAACmJ,MAAAA,UAAU,EAAE,IAAb;AAAmBjH,MAAAA,MAAM,EAAE;AAA3B,KAAD,CAFN;AAGD;AAED;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACE4B,EAAAA,mBAAmB,CAAC5L,EAAD,EAAKqB,IAAL,EAAW;AAC5BjC,IAAAA,MAAM,CAACQ,KAAP,CAAa,SAAb,EAAwBI,EAAxB,EAA4B,uBAA5B,EAAqD,CAAC,aAAD,EAAgB;AAACA,MAAAA,EAAD;AAAKqB,MAAAA;AAAL,KAAhB,CAArD;;AAEA,UAAMsR,UAAU,GAAG,YAAY;AAC7B,UAAIC,OAAO,GAAG,EAAd;;AAEA,UAAI;AACFA,QAAAA,OAAO,GAAG,MAAM,KAAKjB,YAAL,CAAkB3R,EAAlB,EAAsB2S,UAAtB,EAAhB;AACAC,QAAAA,OAAO,GAAGA,OAAO,CAAClP,MAAR,CAAgB0O,MAAD,IAAY,CAAC/Q,IAAD,IAAU+Q,MAAM,CAAC5T,IAAP,KAAgB6C,IAAhB,IAAwB+Q,MAAM,CAACrG,QAApE,CAAV;AACD,OAHD,CAGE,OAAOzQ,KAAP,EAAc;AACd8D,QAAAA,MAAM,CAAC9D,KAAP,CAAa,SAAb,EAAwB0E,EAAxB,EAA4B,uBAA5B,EAAqD,4BAArD,EAAmF1E,KAAnF;AACD;;AAED,aAAOsX,OAAP;AACD,KAXD;;AAaA,WAAO,KAAK9I,UAAL,CAAgB9J,EAAhB,EAAoBlE,IAApB,CACLF,GAAG,CAAE2O,OAAD,IACDlJ,IAAI,KAAK,YAAT,IAAyBA,IAAI,KAAK,YAAnC,IACCA,IAAI,KAAK,YAAT,IAAyBkJ,OAAO,CAACE,UAAR,CAAmBwG,UAAnB,KAAkC,SAD5D,IAEC5P,IAAI,KAAK,YAAT,IAAyBkJ,OAAO,CAACR,UAAR,CAAmBkH,UAAnB,KAAkC,SAH3D,CADE,EAML/G,oBAAoB,EANf,EAOL2I,SAAS,CAAEC,OAAD,IAAa5R,IAAI,CAAC4R,OAAO,GAAGH,UAAU,EAAb,GAAkB,CAAC,EAAD,CAA1B,CAAlB,CAPJ,EAQLnR,GAAG,CAAEoR,OAAD,IAAaxT,MAAM,CAACQ,KAAP,CAAa,SAAb,EAAwBI,EAAxB,EAA4B,uBAA5B,EAAqD,CAAC,UAAD,EAAa4S,OAAb,CAArD,CAAd,CARE,CAAP;AAUD;AAED;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACEG,EAAAA,WAAW,CAAC/S,EAAD,SAAqB;AAAA,QAAhB;AAACqB,MAAAA,IAAD;AAAO2I,MAAAA;AAAP,KAAgB;AAC9B5K,IAAAA,MAAM,CAACQ,KAAP,CAAa,SAAb,EAAwBI,EAAxB,EAA4B,eAA5B,EAA6C,CAAC,aAAD,EAAgB;AAACA,MAAAA,EAAD;AAAKqB,MAAAA,IAAL;AAAW2I,MAAAA;AAAX,KAAhB,CAA7C;AACA,UAAMO,OAAO,GAAG,EAAC,GAAG,KAAKiG,QAAL,CAAcxQ,EAAd;AAAJ,KAAhB;AACA,UAAMgT,WAAW,GAAIhJ,MAAM,YAAY3Q,WAAlB,IAAiC2Q,MAAM,CAACiJ,cAAP,EAAlC,IAA8D,EAAlF;AACA,UAAMC,WAAW,GAAIlJ,MAAM,YAAY3Q,WAAlB,IAAiC2Q,MAAM,CAACmJ,cAAP,EAAlC,IAA8D,EAAlF;;AAEA,YAAQ9R,IAAR;AACE,WAAKmN,gBAAL;AACE,aAAKgC,QAAL,CAAcxQ,EAAd,IAAoB,EAClB,GAAGuK,OADe;AAElB;AACA;AACAR,UAAAA,UAAU,EAAE,EACV,GAAGQ,OAAO,CAACR,UADD;AAEVC,YAAAA,MAAM,EAAEO,OAAO,CAACN,kBAAR,IAA8B+I,WAAW,CAAC7N,MAAZ,KAAuB,CAArD,GACJ,IADI,GAEJ,IAAI9L,WAAJ,CAAgB2Z,WAAhB;AAJM,WAJM;AAUlBvI,UAAAA,UAAU,EAAE,EACV,GAAGF,OAAO,CAACE,UADD;AAEVT,YAAAA,MAAM,EAAEO,OAAO,CAAC4C,kBAAR,IAA8B+F,WAAW,CAAC/N,MAAZ,KAAuB,CAArD,GACJ,IADI,GAEJ,IAAI9L,WAAJ,CAAgB6Z,WAAhB;AAJM;AAVM,SAApB;AAiBA;;AACF,WAAKxE,uBAAL;AACE,aAAK8B,QAAL,CAAcxQ,EAAd,IAAoB,EAAC,GAAGuK,OAAJ;AAAa6I,UAAAA,WAAW,EAAEpJ;AAA1B,SAApB;AACA;;AACF,WAAK2E,uBAAL;AACE,aAAK6B,QAAL,CAAcxQ,EAAd,IAAoB,EAAC,GAAGuK,OAAJ;AAAa8I,UAAAA,WAAW,EAAErJ;AAA1B,SAApB;AACA;;AACF,WAAKyE,sBAAL;AACE,aAAK+B,QAAL,CAAcxQ,EAAd,IAAoB,EAAC,GAAGuK,OAAJ;AAAae,UAAAA,UAAU,EAAE;AAACtB,YAAAA;AAAD;AAAzB,SAApB;AACA;;AACF,WAAK4E,uBAAL;AACE,aAAK4B,QAAL,CAAcxQ,EAAd,IAAoB,EAClB,GAAGuK,OADe;AAElB+I,UAAAA,iBAAiB,EAAEtJ,MAFD;AAGlBuJ,UAAAA,WAAW,EAAEhJ,OAAO,CAACiJ,aAAR,GAAwBxJ,MAAxB,GAAiC;AAH5B,SAApB;AAKA;;AACF,WAAKyD,wBAAL;AACE;AACA,aAAK+C,QAAL,CAAcxQ,EAAd,IAAoB,EAClB,GAAGuK,OADe;AAElBgJ,UAAAA,WAAW,EAAEhJ,OAAO,CAAC+I,iBAAR,IAA6B,IAFxB;AAGlBE,UAAAA,aAAa,EAAE;AAHG,SAApB;AAKA;;AACF,WAAK9F,uBAAL;AACE;AACA,aAAK8C,QAAL,CAAcxQ,EAAd,IAAoB,EAClB,GAAGuK,OADe;AAElBgJ,UAAAA,WAAW,EAAE,IAFK;AAGlBC,UAAAA,aAAa,EAAE;AAHG,SAApB;AAKA;AAnDJ;AAuDD;AAED;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACE;;;AACAC,EAAAA,UAAU,CAACzJ,MAAD,EAAS;AACjB5K,IAAAA,MAAM,CAACQ,KAAP,CAAa,SAAb,EAAwB5D,SAAxB,EAAmC,cAAnC,EAAmD,QAAnD;;AACA,QAAIgO,MAAM,IAAIA,MAAM,CAACzQ,SAArB,EAAgC;AAC9B,YAAMma,MAAM,GAAG1J,MAAM,CAACzQ,SAAP,EAAf;AAEAma,MAAAA,MAAM,CAACC,OAAP,CAAgBpV,KAAD,IAAWA,KAAK,CAACqV,IAAN,EAA1B;AACD;AACF;AAED;AACF;AACA;AACA;AACA;AACA;;;AACEC,EAAAA,WAAW,CAAC7T,EAAD,EAAK;AACdZ,IAAAA,MAAM,CAACQ,KAAP,CAAa,SAAb,EAAwBI,EAAxB,EAA4B,eAA5B,EAA6C,CAAC,aAAD,EAAgB;AAACA,MAAAA;AAAD,KAAhB,CAA7C;;AACA,QAAI,KAAKwQ,QAAL,IAAiB,KAAKA,QAAL,CAAcxQ,EAAd,CAArB,EAAwC;AACtC,WAAKyT,UAAL,CAAgB,KAAKjD,QAAL,CAAcxQ,EAAd,EAAkB+J,UAAlB,CAA6BC,MAA7C;AACA,WAAKyJ,UAAL,CAAgB,KAAKjD,QAAL,CAAcxQ,EAAd,EAAkByK,UAAlB,CAA6BT,MAA7C;AACA,WAAKyJ,UAAL,CAAgB,KAAKjD,QAAL,CAAcxQ,EAAd,EAAkBsL,UAAlB,CAA6BtB,MAA7C;AACA,WAAKyJ,UAAL,CAAgB,KAAKjD,QAAL,CAAcxQ,EAAd,EAAkBiK,kBAAlC;AACA,WAAKwJ,UAAL,CAAgB,KAAKjD,QAAL,CAAcxQ,EAAd,EAAkBmN,kBAAlC;AACD;;AAED,SAAKqD,QAAL,CAAcxQ,EAAd,IAAoB,EAClB,GAAG,KAAKwQ,QAAL,CAAcxQ,EAAd,CADe;AAElB+J,MAAAA,UAAU,EAAE;AACVC,QAAAA,MAAM,EAAE,IADE;AAEViH,QAAAA,UAAU,EAAE;AAFF,OAFM;AAMlBxG,MAAAA,UAAU,EAAE;AACVT,QAAAA,MAAM,EAAE,IADE;AAEViH,QAAAA,UAAU,EAAE;AAFF,OANM;AAUlB3F,MAAAA,UAAU,EAAE;AACVtB,QAAAA,MAAM,EAAE;AADE,OAVM;AAalBoJ,MAAAA,WAAW,EAAE,IAbK;AAclBC,MAAAA,WAAW,EAAE,IAdK;AAelBE,MAAAA,WAAW,EAAE,IAfK;AAgBlB/H,MAAAA,QAAQ,EAAE,IAhBQ;AAiBlBa,MAAAA,YAAY,EAAE,IAjBI;AAkBlBM,MAAAA,SAAS,EAAE,IAlBO;AAmBlBmH,MAAAA,QAAQ,EAAE;AACRC,QAAAA,OAAO,EAAE,KADD;AAERC,QAAAA,OAAO,EAAE;AACPC,UAAAA,KAAK,EAAE,IADA;AAEP7C,UAAAA,KAAK,EAAE;AAFA;AAFD;AAnBQ,KAApB;AA2BD;AAED;AACF;AACA;AACA;AACA;AACA;AACA;AACA;;;AACyB,QAAjB8C,iBAAiB,CAACC,WAAD,EAAc;AACnC,UAAM;AAAChU,MAAAA,EAAD;AAAKkB,MAAAA;AAAL,QAAaiD,kBAAkB,CAAC6P,WAAD,CAArC;AACA,QAAIC,YAAY,GAAGD,WAAnB;;AAEA,QAAI9S,IAAI,KAAKgO,oBAAb,EAAmC;AACjC,YAAM;AAACjI,QAAAA;AAAD,UAAgB,MAAM,KAAK1N,UAAL,CAAgB+N,MAAhB,CAAuB3H,GAAvB,CAA2BK,EAA3B,CAA5B;AAEAiU,MAAAA,YAAY,GAAGhN,WAAf;AACD,KAJD,MAIO,IAAI/F,IAAI,KAAKiO,kBAAb,EAAiC;AACtC;AACA;AACA,YAAM;AAACvM,QAAAA;AAAD,UAAU,MAAM,KAAKrJ,UAAL,CAAgBuJ,KAAhB,CAAsBnD,GAAtB,CAA0BqU,WAA1B,CAAtB;AAEAC,MAAAA,YAAY,GAAGrR,KAAf;AACD,KANM,MAMA;AACL,UAAI;AACF,cAAM0E,MAAM,GAAG,MAAM,KAAK/N,UAAL,CAAgB+N,MAAhB,CAAuBhD,IAAvB,CAA4B;AAAC4P,UAAAA,KAAK,EAAEF;AAAR,SAA5B,CAArB;;AAEA,YAAI1M,MAAM,CAAC6M,KAAX,EAAkB;AAChB,gBAAM;AAAClN,YAAAA;AAAD,cAAgBK,MAAM,CAAC6M,KAAP,CAAa,CAAb,CAAtB;AAEAF,UAAAA,YAAY,GAAGhN,WAAf;AACD,SAPC;;AASH,OATD,CASE,OAAO9L,KAAP,EAAc;AACjB;;AAED,WAAO8Y,YAAP;AACD;AAED;AACF;AACA;AACA;AACA;AACA;;;AACEG,EAAAA,aAAa,CAACJ,WAAD,EAAc;AACzB,UAAMK,WAAW,GAAGtT,IAAI,CAAC,KAAKxH,UAAL,CAAgB8W,QAAhB,CAAyBpP,MAAzB,CAAgC+S,WAAhC,CAAD,CAAJ,CAAmDrY,IAAnD,CAClBF,GAAG,CAAC;AAAA,UAAC;AAACuE,QAAAA,EAAD;AAAKsU,QAAAA,WAAW,EAAE;AAACC,UAAAA;AAAD;AAAlB,OAAD;AAAA,aAAuC;AACzC1U,QAAAA,EAAE,EAAEG,EADqC;AAEzC4C,QAAAA,KAAK,EAAE2R,WAFkC;AAGzC3K,QAAAA,UAAU,EAAE;AACVC,UAAAA,MAAM,EAAE,IADE;AAEViH,UAAAA,UAAU,EAAE;AAFF,SAH6B;AAOzCxG,QAAAA,UAAU,EAAE;AACVT,UAAAA,MAAM,EAAE,IADE;AAEViH,UAAAA,UAAU,EAAE;AAFF,SAP6B;AAWzC3F,QAAAA,UAAU,EAAE;AACVtB,UAAAA,MAAM,EAAE;AADE,SAX6B;AAczCoJ,QAAAA,WAAW,EAAE,IAd4B;AAezCC,QAAAA,WAAW,EAAE,IAf4B;AAgBzCE,QAAAA,WAAW,EAAE,IAhB4B;AAiBzCvI,QAAAA,UAAU,EAAE,IAjB6B;AAkBzC8I,QAAAA,QAAQ,EAAE;AACRC,UAAAA,OAAO,EAAE,KADD;AAERC,UAAAA,OAAO,EAAE;AACP5C,YAAAA,KAAK,EAAE,IADA;AAEP6C,YAAAA,KAAK,EAAE;AAFA;AAFD,SAlB+B;AAyBzC5K,QAAAA,KAAK,EAAE0G,CAAY,CAAC4E,UAzBqB;AA0BzCnJ,QAAAA,QAAQ,EAAE,IA1B+B;AA2BzCa,QAAAA,YAAY,EAAE,IA3B2B;AA4BzCM,QAAAA,SAAS,EAAE;AA5B8B,OAAvC;AAAA,KAAD,CADe;AAgClBkG,IAAAA,SAAS,CAAEtI,OAAD,IACRA,OAAO,CAACxH,KAAR,GACI+E,EAAE,CAACyC,OAAD,CADN,GAEIrJ,IAAI,CAAC,KAAKgT,iBAAL,CAAuBC,WAAvB,CAAD,CAAJ,CAA0CrY,IAA1C,CACAF,GAAG,CAAEmH,KAAD,KAAY,EAAC,GAAGwH,OAAJ;AAAaxH,MAAAA;AAAb,KAAZ,CAAD,CADH,CAHG,CAhCS,CAApB;AAyCA,WAAOyR,WAAW,CAAC1Y,IAAZ,CACLlB,SAAS,CAAE2P,OAAD,IAAa,KAAKwG,aAAL,CAAmBxG,OAAO,CAACvK,EAA3B,EAA+BlE,IAA/B,CACrBF,GAAG,CAAEgZ,UAAD,KAAiB,EACnB,GAAGrK,OADgB;AAEnB,SAAGqK;AAFgB,KAAjB,CAAD,CADkB,CAAd,CADJ,EAOLpT,GAAG,CAAE+I,OAAD,IAAa;AACf,YAAMmH,UAAU,GAAG,KAAKC,YAAL,CAAkBpH,OAAO,CAACvK,EAA1B,CAAnB;AAEA,WAAKwQ,QAAL,CAAcjG,OAAO,CAACvK,EAAtB,IAA4BuK,OAA5B;AACAmH,MAAAA,UAAU,CAACmD,IAAX,CAAgBlH,qBAAhB,EAAuCpD,OAAvC;AACD,KALE,CAPE,EAaL9I,UAAU,CAAEC,GAAD,IAAS;AAClBtC,MAAAA,MAAM,CAAC9D,KAAP,CAAa,SAAb,EAAwB6Y,WAAxB,EAAqC,iBAArC,EAAyD,oCAAmCA,WAAY,GAAxG,EAA4GzS,GAA5G;AACA,YAAMA,GAAN;AACD,KAHS,CAbL,CAAP;AAkBD;AAED;AACF;AACA;AACA;AACA;AACA;AACA;;;AACEiQ,EAAAA,YAAY,CAAC3R,EAAD,EAAK;AACfZ,IAAAA,MAAM,CAACQ,KAAP,CAAa,SAAb,EAAwBI,EAAxB,EAA4B,gBAA5B,EAA8C,CAAC,aAAD,EAAgB;AAACA,MAAAA;AAAD,KAAhB,CAA9C;AAEA,WAAO,KAAKtG,UAAL,CAAgB8W,QAAhB,CAAyBsE,gBAAzB,CAA0C,IAA1C,EAAgD9U,EAAhD,CAAP;AACD;AAED;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACmB,QAAXsK,WAAW,CAACtK,EAAD,EAAmB;AAAA,QAAdiM,OAAc,uEAAJ,EAAI;AAClC7M,IAAAA,MAAM,CAACQ,KAAP,CAAa,SAAb,EAAwBI,EAAxB,EAA4B,eAA5B,EAA6C,CAAC,aAAD,EAAgB;AAACA,MAAAA,EAAD;AAAKiM,MAAAA;AAAL,KAAhB,CAA7C;;AACA,QAAI;AACF,YAAMyF,UAAU,GAAG,KAAKC,YAAL,CAAkB3R,EAAlB,CAAnB;AAEA0R,MAAAA,UAAU,CAACqD,yBAAX,CAAqCC,KAArC;AACA5V,MAAAA,MAAM,CAACQ,KAAP,CAAa,SAAb,EAAwBI,EAAxB,EAA4B,eAA5B,EAA6C,CAAC,gCAAD,EAAmC;AAACiV,QAAAA,GAAG,EAAEhJ,OAAO,CAACiJ,QAAd;AAAwBC,QAAAA,SAAS,EAAE,KAAnC;AAA0C1C,QAAAA,IAAI,EAAExG,OAAO,CAACwG;AAAxD,OAAnC,CAA7C;AACA,YAAMf,UAAU,CAACjT,IAAX,CAAgB;AACpBwW,QAAAA,GAAG,EAAEhJ,OAAO,CAACmJ,OAAR,IAAmBnJ,OAAO,CAACiJ,QADZ;AAEpBC,QAAAA,SAAS,EAAE,CAAC,CAAElJ,OAAO,CAACmJ,OAFF;AAGpB3C,QAAAA,IAAI,EAAExG,OAAO,CAACwG;AAHM,OAAhB,CAAN;AAKArT,MAAAA,MAAM,CAACmH,IAAP,CAAY,SAAZ,EAAuBvG,EAAvB,EAA2B,MAA3B,EAAmC,iBAAnC;AACD,KAXD,CAWE,OAAO1E,KAAP,EAAc;AACd,UAAIA,KAAK,CAAC+Z,kBAAV,EAA8B;AAC5BjW,QAAAA,MAAM,CAACmH,IAAP,CAAY,SAAZ,EAAuBvG,EAAvB,EAA2B,eAA3B,EAA4C,iCAA5C;AAEA,aAAKsV,aAAL,CAAmBtV,EAAnB,EAAuB,OACrB;AACEuV,UAAAA,gBAAgB,EAAE,IADpB;AAEEC,UAAAA,eAAe,EAAE,CAAC,CAACvJ,OAAO,CAACiJ,QAF7B;AAGEO,UAAAA,cAAc,EAAE,CAAC,CAACxJ,OAAO,CAACmJ;AAH5B,SADqB,CAAvB;AAMD,OATD,MASO;AACLhW,QAAAA,MAAM,CAAC9D,KAAP,CAAa,SAAb,EAAwB0E,EAAxB,EAA4B,eAA5B,EAA6C,gBAA7C,EAA+D1E,KAA/D;AACD;AACF;AACF;AAED;AACF;AACA;AACA;AACA;AACA;;;AACoB,QAAZ8O,YAAY,CAACpK,EAAD,EAAK;AACrBZ,IAAAA,MAAM,CAACQ,KAAP,CAAa,SAAb,EAAwBI,EAAxB,EAA4B,gBAA5B,EAA8C,CAAC,aAAD,EAAgB;AAACA,MAAAA;AAAD,KAAhB,CAA9C;;AACA,QAAI;AACF,YAAM0R,UAAU,GAAG,KAAKC,YAAL,CAAkB3R,EAAlB,CAAnB;AAEA,WAAK6T,WAAL,CAAiB7T,EAAjB;AAEAZ,MAAAA,MAAM,CAACQ,KAAP,CAAa,SAAb,EAAwBI,EAAxB,EAA4B,gBAA5B,EAA8C,4BAA9C;AACA,YAAM0R,UAAU,CAACgE,KAAX,EAAN;AACAtW,MAAAA,MAAM,CAACmH,IAAP,CAAY,SAAZ,EAAuBvG,EAAvB,EAA2B,OAA3B,EAAoC,iBAApC;AACD,KARD,CAQE,OAAO1E,KAAP,EAAc;AACd8D,MAAAA,MAAM,CAAC9D,KAAP,CAAa,SAAb,EAAwB0E,EAAxB,EAA4B,gBAA5B,EAA8C,iBAA9C,EAAiE1E,KAAjE;AACD;AACF;AAED;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACE;;;AACAqa,EAAAA,kBAAkB,CAACf,UAAD,EAAagB,kBAAb,EAAiC;AACjD,WACGhB,UAAU,CAAClL,MAAX,KAAsB,IAAtB,IAA8B;AAACA,MAAAA,MAAM,EAAE;AAAT,KAA/B,IACIkL,UAAU,CAAClL,MAAX,KAAsB,KAAtB,IAA+B;AAACE,MAAAA,QAAQ,EAAE;AAAX,KADnC,IAEIgL,UAAU,CAAC5K,MAAX,IAAqB;AAACR,MAAAA,OAAO,EAAE;AAAV,KAFzB,IAGIoM,kBAAkB,IAAI;AAAC1M,MAAAA,KAAK,EAAE;AAAR,KAH1B,IAIG;AAAC2M,MAAAA,QAAQ,EAAE;AAAX,KALL;AAOD;AAED;AACF;AACA;AACA;AACA;AACA;AACA;;;AACwB,QAAhB/M,gBAAgB,CAAC9I,EAAD,EAAK;AACzBZ,IAAAA,MAAM,CAACQ,KAAP,CAAa,SAAb,EAAwBI,EAAxB,EAA4B,oBAA5B,EAAkD,CAAC,aAAD,EAAgB;AAACA,MAAAA;AAAD,KAAhB,CAAlD;AAEA,QAAIqJ,KAAJ,CAHyB;AAKzB;;AACA,UAAM,KAAKiM,aAAL,CAAmBtV,EAAnB,EAAwBuK,OAAD,IAAa;AACxC,UAAIuL,OAAJ;AAEAzM,MAAAA,KAAK,GAAG,KAAKsM,kBAAL,CAAwBpL,OAAO,CAACR,UAAhC,EAA4CQ,OAAO,CAACN,kBAApD,CAAR;;AAEA,UAAIZ,KAAK,CAACwM,QAAV,EAAoB;AAClB,cAAM,IAAI/b,KAAJ,CAAU,mCAAV,CAAN;AACD,OAFD,MAEO,IAAIuP,KAAK,CAACK,MAAV,EAAkB;AACvB,cAAM,IAAI5P,KAAJ,CAAU,sBAAV,CAAN;AACD,OAFM,MAEA,IAAIuP,KAAK,CAACO,QAAV,EAAoB;AACzB,cAAM,IAAI9P,KAAJ,CAAU,wBAAV,CAAN;AACD,OAFM,MAEA,IAAIuP,KAAK,CAACG,OAAV,EAAmB;AACxBsM,QAAAA,OAAO,GAAG;AAAC/L,UAAAA,UAAU,EAAE;AAACL,YAAAA,MAAM,EAAE;AAAT;AAAb,SAAV;AACD,OAFM,MAEA,IAAIL,KAAK,CAACH,KAAV,EAAiB;AACtB4M,QAAAA,OAAO,GAAG;AAAC/L,UAAAA,UAAU,EAAE;AAACL,YAAAA,MAAM,EAAE;AAAT;AAAb,SAAV;AACD;;AAED,aAAOoM,OAAP;AACD,KAlBK,CAAN;;AAoBA,QAAI;AACF,YAAM,KAAKR,aAAL,CAAmBtV,EAAnB,EAAuB,OAAOuK,OAAP,EAAgBmH,UAAhB,KAA+B;AAC1D,cAAMqE,WAAW,GAAG,CAAC,CAACxL,OAAO,CAAC6I,WAA9B;AACA,YAAI0C,OAAJ;;AAEA,YAAIzM,KAAK,CAACG,OAAV,EAAmB;AACjB;AACA,cAAIuM,WAAJ,EAAiB;AACf3W,YAAAA,MAAM,CAACQ,KAAP,CAAa,SAAb,EAAwBI,EAAxB,EAA4B,oBAA5B,EAAkD,gCAAlD;AACA,kBAAM0R,UAAU,CAACsE,SAAX,EAAN;AACA5W,YAAAA,MAAM,CAACmH,IAAP,CAAY,SAAZ,EAAuBvG,EAAvB,EAA2B,MAA3B,EAAmC,aAAnC;AACD,WANgB;;;AASjB8V,UAAAA,OAAO,GAAG;AACR7L,YAAAA,kBAAkB,EAAEM,OAAO,CAACR,UAAR,CAAmBC,MAD/B;AAERD,YAAAA,UAAU,EAAE;AACVC,cAAAA,MAAM,EAAE,IADE;AAEVN,cAAAA,MAAM,EAAE1N;AAFE;AAFJ,WAAV;AAOD,SAhBD,MAgBO,IAAIqN,KAAK,CAACH,KAAV,EAAiB;AACtB;AACA,cAAI6M,WAAJ,EAAiB;AACf3W,YAAAA,MAAM,CAACQ,KAAP,CAAa,SAAb,EAAwBI,EAAxB,EAA4B,oBAA5B,EAAkD,kCAAlD;AACA,kBAAM0R,UAAU,CAACuE,WAAX,EAAN;AACA7W,YAAAA,MAAM,CAACmH,IAAP,CAAY,SAAZ,EAAuBvG,EAAvB,EAA2B,QAA3B,EAAqC,cAArC;AACD,WANqB;;;AAStB8V,UAAAA,OAAO,GAAG;AACR7L,YAAAA,kBAAkB,EAAE,IADZ;AAERF,YAAAA,UAAU,EAAE;AACVC,cAAAA,MAAM,EAAEO,OAAO,CAACN,kBADN;AAEVP,cAAAA,MAAM,EAAE1N;AAFE;AAFJ,WAAV;AAOD;;AAEDoD,QAAAA,MAAM,CAACQ,KAAP,CAAa,SAAb,EAAwBI,EAAxB,EAA4B,oBAA5B,EAAkD,CAAC,iCAAD,EAAoC;AAAC8V,UAAAA;AAAD,SAApC,CAAlD;AAEA,eAAOA,OAAP;AACD,OAzCK,CAAN;AA0CD,KA3CD,CA2CE,OAAOxa,KAAP,EAAc;AACd8D,MAAAA,MAAM,CAAC9D,KAAP,CAAa,SAAb,EAAwB0E,EAAxB,EAA4B,oBAA5B,EAAkD,uCAAlD,EAA2F1E,KAA3F;AACA,WAAKga,aAAL,CAAmBtV,EAAnB,EAAuB,OAAO;AAAC+J,QAAAA,UAAU,EAAE;AAACL,UAAAA,MAAM,EAAE1N;AAAT;AAAb,OAAP,CAAvB;AACD;AACF;AAED;AACF;AACA;AACA;AACA;AACA;AACA;;;AACwB,QAAhBiR,gBAAgB,CAACjN,EAAD,EAAK;AACzBZ,IAAAA,MAAM,CAACQ,KAAP,CAAa,SAAb,EAAwBI,EAAxB,EAA4B,oBAA5B,EAAkD,CAAC,aAAD,EAAgB;AAACA,MAAAA;AAAD,KAAhB,CAAlD;AAEA,QAAIqJ,KAAJ,CAHyB;AAKzB;;AACA,UAAM,KAAKiM,aAAL,CAAmBtV,EAAnB,EAAwBuK,OAAD,IAAa;AACxC,UAAIuL,OAAJ;AAEAzM,MAAAA,KAAK,GAAG,KAAKsM,kBAAL,CAAwBpL,OAAO,CAACE,UAAhC,EAA4CF,OAAO,CAAC4C,kBAApD,CAAR;;AAEA,UAAI9D,KAAK,CAACwM,QAAV,EAAoB;AAClB,cAAM,IAAI/b,KAAJ,CAAU,mCAAV,CAAN;AACD,OAFD,MAEO,IAAIuP,KAAK,CAACK,MAAV,EAAkB;AACvB,cAAM,IAAI5P,KAAJ,CAAU,sBAAV,CAAN;AACD,OAFM,MAEA,IAAIuP,KAAK,CAACO,QAAV,EAAoB;AACzB,cAAM,IAAI9P,KAAJ,CAAU,wBAAV,CAAN;AACD,OAFM,MAEA,IAAIuP,KAAK,CAACG,OAAV,EAAmB;AACxBsM,QAAAA,OAAO,GAAG;AAACrL,UAAAA,UAAU,EAAE;AAACf,YAAAA,MAAM,EAAE;AAAT;AAAb,SAAV;AACD,OAFM,MAEA,IAAIL,KAAK,CAACH,KAAV,EAAiB;AACtB4M,QAAAA,OAAO,GAAG;AAACrL,UAAAA,UAAU,EAAE;AAACf,YAAAA,MAAM,EAAE;AAAT;AAAb,SAAV;AACD;;AAED,aAAOoM,OAAP;AACD,KAlBK,CAAN;;AAoBA,QAAI;AACF,YAAM,KAAKR,aAAL,CAAmBtV,EAAnB,EAAuB,OAAOuK,OAAP,EAAgBmH,UAAhB,KAA+B;AAC1D,cAAMqE,WAAW,GAAG,CAAC,CAACxL,OAAO,CAAC8I,WAA9B;AACA,YAAIyC,OAAJ;;AAEA,YAAIzM,KAAK,CAACG,OAAV,EAAmB;AACjB;AACA,cAAIuM,WAAJ,EAAiB;AACf3W,YAAAA,MAAM,CAACQ,KAAP,CAAa,SAAb,EAAwBI,EAAxB,EAA4B,oBAA5B,EAAkD,gCAAlD;AACA,kBAAM0R,UAAU,CAACwE,SAAX,EAAN;AACA9W,YAAAA,MAAM,CAACmH,IAAP,CAAY,SAAZ,EAAuBvG,EAAvB,EAA2B,MAA3B,EAAmC,aAAnC;AACD,WANgB;;;AASjB8V,UAAAA,OAAO,GAAG;AACR3I,YAAAA,kBAAkB,EAAE5C,OAAO,CAACE,UAAR,CAAmBT,MAD/B;AAERS,YAAAA,UAAU,EAAE;AACVT,cAAAA,MAAM,EAAE,IADE;AAEVN,cAAAA,MAAM,EAAE1N;AAFE;AAFJ,WAAV;AAOD,SAhBD,MAgBO,IAAIqN,KAAK,CAACH,KAAV,EAAiB;AACtB;AACA,cAAI6M,WAAJ,EAAiB;AACf3W,YAAAA,MAAM,CAACQ,KAAP,CAAa,SAAb,EAAwBI,EAAxB,EAA4B,oBAA5B,EAAkD,kCAAlD;AACA,kBAAM0R,UAAU,CAACyE,WAAX,EAAN;AACA/W,YAAAA,MAAM,CAACmH,IAAP,CAAY,SAAZ,EAAuBvG,EAAvB,EAA2B,QAA3B,EAAqC,cAArC;AACD,WANqB;;;AAStB8V,UAAAA,OAAO,GAAG;AACR3I,YAAAA,kBAAkB,EAAE,IADZ;AAER1C,YAAAA,UAAU,EAAE;AACVT,cAAAA,MAAM,EAAEO,OAAO,CAAC4C,kBADN;AAEVzD,cAAAA,MAAM,EAAE1N;AAFE;AAFJ,WAAV;AAOD;;AAEDoD,QAAAA,MAAM,CAACQ,KAAP,CAAa,SAAb,EAAwBI,EAAxB,EAA4B,oBAA5B,EAAkD,CAAC,iCAAD,EAAoC;AAAC8V,UAAAA;AAAD,SAApC,CAAlD;AAEA,eAAOA,OAAP;AACD,OAzCK,CAAN;AA0CD,KA3CD,CA2CE,OAAOxa,KAAP,EAAc;AACd8D,MAAAA,MAAM,CAAC9D,KAAP,CAAa,SAAb,EAAwB0E,EAAxB,EAA4B,oBAA5B,EAAkD,uCAAlD,EAA2F1E,KAA3F;AACA,WAAKga,aAAL,CAAmBtV,EAAnB,EAAuB,OAAO;AAACyK,QAAAA,UAAU,EAAE;AAACf,UAAAA,MAAM,EAAE1N;AAAT;AAAb,OAAP,CAAvB;AACD;AACF;AAED;AACF;AACA;AACA;AACA;AACA;AACA;;;AACwB,QAAhBqP,gBAAgB,CAACrL,EAAD,EAAK;AACzBZ,IAAAA,MAAM,CAACQ,KAAP,CAAa,SAAb,EAAwBI,EAAxB,EAA4B,oBAA5B,EAAkD,CAAC,aAAD,EAAgB;AAACA,MAAAA;AAAD,KAAhB,CAAlD;AACA,UAAM,KAAKsV,aAAL,CAAmBtV,EAAnB,EAAuB,OAAOuK,OAAP,EAAgBmH,UAAhB,KAA+B;AAC1D,UAAIoE,OAAJ;;AAEA,YAAMM,cAAc,GAAI9a,KAAD,IAAW;AAChC8D,QAAAA,MAAM,CAACoJ,IAAP,CAAY,SAAZ,EAAuBxI,EAAvB,EAA2B,oBAA3B,EAAiD,qCAAjD,EAAwF1E,KAAxF;AAEA,aAAKmY,UAAL,CAAgBlJ,OAAO,CAACe,UAAR,CAAmBtB,MAAnC;AACA8L,QAAAA,OAAO,GAAG;AAACxK,UAAAA,UAAU,EAAE;AAACtB,YAAAA,MAAM,EAAE;AAAT;AAAb,SAAV;AACA,aAAKsL,aAAL,CAAmBtV,EAAnB,EAAuB,aAAa;AAACsL,UAAAA,UAAU,EAAE;AAACtB,YAAAA,MAAM,EAAE;AAAT;AAAb,SAAb,CAAvB;AACD,OAND,CAH0D;AAY1D;AACA;AACA;AACA;;;AACA,UAAI,CAAC0H,UAAU,CAAC2E,cAAX,EAAL,EAAkC;AAChCjX,QAAAA,MAAM,CAAC9D,KAAP,CAAa,SAAb,EAAwB0E,EAAxB,EAA4B,oBAA5B,EAAkD,2DAAlD;AACD,OAFD,MAEO,IAAIuK,OAAO,CAACe,UAAR,CAAmBtB,MAAvB,EAA+B;AACpC,aAAKyJ,UAAL,CAAgBlJ,OAAO,CAACe,UAAR,CAAmBtB,MAAnC;AAEA0H,QAAAA,UAAU,CAAC4E,WAAX,CAAuB;AAAClH,UAAAA,SAAS,EAAE,KAAZ;AAAmBH,UAAAA,YAAY,EAAE;AAAjC,SAAvB,EAA+DsH,KAA/D,CAAqEH,cAArE;AACAhX,QAAAA,MAAM,CAACmH,IAAP,CAAY,SAAZ,EAAuBvG,EAAvB,EAA2B,SAA3B,EAAsC,kBAAtC;AAEA8V,QAAAA,OAAO,GAAG;AAACxK,UAAAA,UAAU,EAAE;AAACtB,YAAAA,MAAM,EAAE;AAAT;AAAb,SAAV;AACD,OAPM,MAOA;AACL,cAAM,GAAGsB,UAAH,IAAiB,MAAMoG,UAAU,CAACG,eAAX,CAA2B;AAACzC,UAAAA,SAAS,EAAE;AAAZ,SAA3B,CAA7B;AAEAsC,QAAAA,UAAU,CAAC4E,WAAX,CAAuB;AACrBtM,UAAAA,MAAM,EAAEsB,UADa;AAErB8D,UAAAA,SAAS,EAAE,IAFU;AAGrBH,UAAAA,YAAY,EAAE;AAHO,SAAvB,EAIGsH,KAJH,CAISH,cAJT;AAMAhX,QAAAA,MAAM,CAACmH,IAAP,CAAY,SAAZ,EAAuBvG,EAAvB,EAA2B,OAA3B,EAAoC,kBAApC;AAEA8V,QAAAA,OAAO,GAAG;AAACxK,UAAAA,UAAU,EAAE;AAACtB,YAAAA,MAAM,EAAEsB;AAAT;AAAb,SAAV;AACD;;AAEDlM,MAAAA,MAAM,CAACQ,KAAP,CAAa,SAAb,EAAwBI,EAAxB,EAA4B,oBAA5B,EAAkD,CAAC,iCAAD,EAAoC;AAAC8V,QAAAA;AAAD,OAApC,CAAlD;AAEA,aAAOA,OAAP;AACD,KA1CK,CAAN;AA2CD;AAED;AACF;AACA;AACA;AACA;AACA;;;AACEjL,EAAAA,YAAY,CAAC7K,EAAD,EAAK;AACfZ,IAAAA,MAAM,CAACQ,KAAP,CAAa,SAAb,EAAwBI,EAAxB,EAA4B,gBAA5B,EAA8C,CAAC,aAAD,EAAgB;AAACA,MAAAA;AAAD,KAAhB,CAA9C;AACAZ,IAAAA,MAAM,CAACmH,IAAP,CAAY,SAAZ,EAAuBvG,EAAvB,EAA2B,eAA3B,EAA4C,oCAA5C;AAEA,WAAO,KAAKsV,aAAL,CAAmBtV,EAAnB,EAAuB;AAAA,UAAC;AAACgL,QAAAA;AAAD,OAAD;AAAA,aAAmB;AAACA,QAAAA,UAAU,EAAE,CAACA;AAAd,OAAnB;AAAA,KAAvB,CAAP;AACD;AAED;AACF;AACA;AACA;AACA;AACA;;;AACsB,QAAdE,cAAc,CAAClL,EAAD,EAAK;AACvBZ,IAAAA,MAAM,CAACQ,KAAP,CAAa,SAAb,EAAwBI,EAAxB,EAA4B,kBAA5B,EAAgD,CAAC,aAAD,EAAgB;AAACA,MAAAA;AAAD,KAAhB,CAAhD;AACA,UAAM,KAAKsV,aAAL,CAAmBtV,EAAnB,EAAuB,OAAOuK,OAAP,EAAgBmH,UAAhB,KAA+B;AAC1D,UAAIoE,OAAJ;AACA,YAAMU,eAAe,GAAG,CAACjM,OAAO,CAACuJ,QAAR,CAAiBC,OAA1C;;AAEA,UAAIyC,eAAJ,EAAqB;AACnBpX,QAAAA,MAAM,CAACmH,IAAP,CAAY,SAAZ,EAAuBvG,EAAvB,EAA2B,iBAA3B,EAA8C,wBAA9C,EADmB;AAGnB;AACA;;AACA,cAAMyW,WAAW,GAAGlM,OAAO,CAACE,UAAR,CAAmBT,MAAnB,IAA6BO,OAAO,CAAC4C,kBAAzD;AACA,cAAMuJ,WAAW,GAAGnM,OAAO,CAACR,UAAR,CAAmBC,MAAnB,IAA6BO,OAAO,CAACN,kBAAzD;AAEA6L,QAAAA,OAAO,GAAG;AACRhC,UAAAA,QAAQ,EAAE;AACRC,YAAAA,OAAO,EAAE,IADD;AAERC,YAAAA,OAAO,EAAE;AACPC,cAAAA,KAAK,EAAEwC,WAAW,IAAIA,WAAW,CAACE,KAAZ,EADf;AAEPvF,cAAAA,KAAK,EAAEsF,WAAW,IAAIA,WAAW,CAACC,KAAZ;AAFf;AAFD;AADF,SAAV;AASD,OAjBD,MAiBO;AACLvX,QAAAA,MAAM,CAACmH,IAAP,CAAY,SAAZ,EAAuBvG,EAAvB,EAA2B,iBAA3B,EAA8C,wBAA9C,EADK;AAGL;;AACA,aAAKyT,UAAL,CAAgBlJ,OAAO,CAACE,UAAR,CAAmBT,MAAnC;AACA,aAAKyJ,UAAL,CAAgBlJ,OAAO,CAACR,UAAR,CAAmBC,MAAnC;AACA8L,QAAAA,OAAO,GAAG;AACRhC,UAAAA,QAAQ,EAAE;AACRC,YAAAA,OAAO,EAAE;AADD,WADF;AAIRtJ,UAAAA,UAAU,EAAE;AACVT,YAAAA,MAAM,EAAEO,OAAO,CAACE,UAAR,CAAmBT,MAAnB,IAA6BO,OAAO,CAACuJ,QAAR,CAAiBE,OAAjB,CAAyBC;AADpD,WAJJ;AAOR9G,UAAAA,kBAAkB,EAAE5C,OAAO,CAAC4C,kBAAR,IAA8B5C,OAAO,CAACuJ,QAAR,CAAiBE,OAAjB,CAAyBC,KAPnE;AAQRlK,UAAAA,UAAU,EAAE;AACVC,YAAAA,MAAM,EAAEO,OAAO,CAACR,UAAR,CAAmBC,MAAnB,IAA6BO,OAAO,CAACuJ,QAAR,CAAiBE,OAAjB,CAAyB5C;AADpD,WARJ;AAWRnH,UAAAA,kBAAkB,EAAEM,OAAO,CAACN,kBAAR,IAA8BM,OAAO,CAACuJ,QAAR,CAAiBE,OAAjB,CAAyB5C;AAXnE,SAAV;;AAcA,YAAI7G,OAAO,CAAClB,KAAR,KAAkB0G,CAAY,CAACG,MAAnC,EAA2C;AACzC,cAAI3F,OAAO,CAACuJ,QAAR,CAAiBE,OAAjB,CAAyBC,KAA7B,EAAoC;AAClC,kBAAMvC,UAAU,CAACkF,WAAX,CAAuB;AAC3B5M,cAAAA,MAAM,EAAEO,OAAO,CAACuJ,QAAR,CAAiBE,OAAjB,CAAyBC,KADN;AAE3BlF,cAAAA,YAAY,EAAED,aAAa,CAACC,YAFD;AAG3BG,cAAAA,SAAS,EAAEJ,aAAa,CAACI;AAHE,aAAvB,CAAN;AAKD;;AAED,cAAI3E,OAAO,CAACuJ,QAAR,CAAiBE,OAAjB,CAAyB5C,KAA7B,EAAoC;AAClC,kBAAMM,UAAU,CAACmF,WAAX,CAAuB;AAC3B7M,cAAAA,MAAM,EAAEO,OAAO,CAACuJ,QAAR,CAAiBE,OAAjB,CAAyB5C,KADN;AAE3BpC,cAAAA,YAAY,EAAEF,aAAa,CAACE,YAFD;AAG3BG,cAAAA,SAAS,EAAEL,aAAa,CAACK;AAHE,aAAvB,CAAN;AAKD;AACF;AACF;;AAED/P,MAAAA,MAAM,CAACQ,KAAP,CAAa,SAAb,EAAwBI,EAAxB,EAA4B,kBAA5B,EAAgD,CAAC,qCAAD,EAAwC;AAAC8V,QAAAA;AAAD,OAAxC,CAAhD;AAEA,aAAOA,OAAP;AACD,KA/DK,CAAN;AAgED;AAED;AACF;AACA;AACA;AACA;AACA;;;AACoB,QAAZrK,YAAY,CAACzL,EAAD,EAAKwL,QAAL,EAAe;AAC/BpM,IAAAA,MAAM,CAACQ,KAAP,CAAa,SAAb,EAAwBI,EAAxB,EAA4B,gBAA5B,EAA8C,CAAC,aAAD,EAAgB;AAACA,MAAAA,EAAD;AAAKwL,MAAAA;AAAL,KAAhB,CAA9C;AACApM,IAAAA,MAAM,CAACmH,IAAP,CAAY,SAAZ,EAAuBvG,EAAvB,EAA2B,eAA3B,EAA6C,+CAA8CwL,QAAS,GAApG;AACA,UAAM,KAAK8J,aAAL,CAAmBtV,EAAnB,EAAuB,MAAOuK,OAAP,IAAmB;AAC9C,UAAIuL,OAAJ;AAEA,WAAKrC,UAAL,CAAgBlJ,OAAO,CAACuJ,QAAR,CAAiBE,OAAjB,CAAyBC,KAAzC;AACA,YAAM;AAACjK,QAAAA,MAAD;AAASiH,QAAAA,UAAT;AAAqBlF,QAAAA;AAArB,UAAiC,MAAM,KAAKsF,SAAL,CAC3CrR,EAD2C,EAE3C;AAACkP,QAAAA,SAAS,EAAE;AAAZ,OAF2C,EAG3C;AAAC+E,QAAAA,KAAK,EAAE;AAAClI,UAAAA,QAAQ,EAAEP;AAAX;AAAR,OAH2C,EAI3CsL,SAJ2C,EAA7C;;AAMA,UAAI9M,MAAJ,EAAY;AACV8L,QAAAA,OAAO,GAAG;AACRhC,UAAAA,QAAQ,EAAE;AACRE,YAAAA,OAAO,EAAE;AACPC,cAAAA,KAAK,EAAEjK;AADA;AADD,WADF;AAMRwB,UAAAA,QAAQ,EAAEO;AANF,SAAV;AAQD,OATD,MASO;AACL,cAAM,IAAIjS,KAAJ,CAAW,oDAAmDmX,UAAW,EAAzE,CAAN;AACD;;AAED7R,MAAAA,MAAM,CAACQ,KAAP,CAAa,SAAb,EAAwBI,EAAxB,EAA4B,gBAA5B,EAA8C,CAAC,kCAAD,EAAqC;AAAC8V,QAAAA;AAAD,OAArC,CAA9C;AAEA,aAAOA,OAAP;AACD,KA1BK,CAAN;AA2BD;AAED;AACF;AACA;AACA;AACA;AACA;;;AACwB,QAAhBxJ,gBAAgB,CAACtM,EAAD,EAAKqM,YAAL,EAAmB;AACvCjN,IAAAA,MAAM,CAACQ,KAAP,CAAa,SAAb,EAAwBI,EAAxB,EAA4B,oBAA5B,EAAkD,CAAC,aAAD,EAAgB;AAACA,MAAAA,EAAD;AAAKqM,MAAAA;AAAL,KAAhB,CAAlD;AACAjN,IAAAA,MAAM,CAACmH,IAAP,CAAY,SAAZ,EAAuBvG,EAAvB,EAA2B,mBAA3B,EAAiD,uDAAsDqM,YAAa,GAApH;AACA,UAAM,KAAKiJ,aAAL,CAAmBtV,EAAnB,EAAuB,MAAOuK,OAAP,IAAmB;AAC9C,UAAIuL,OAAJ;AAEA,WAAKrC,UAAL,CAAgBlJ,OAAO,CAACuJ,QAAR,CAAiBE,OAAjB,CAAyB5C,KAAzC;AACA,YAAM;AAACpH,QAAAA,MAAD;AAASiH,QAAAA,UAAT;AAAqBlF,QAAAA;AAArB,UAAiC,MAAM,KAAKsF,SAAL,CAC3CrR,EAD2C,EAE3C;AAACmP,QAAAA,SAAS,EAAE;AAAZ,OAF2C,EAG3C;AAACiC,QAAAA,KAAK,EAAE;AAACrF,UAAAA,QAAQ,EAAEM;AAAX;AAAR,OAH2C,EAI3CyK,SAJ2C,EAA7C;;AAMA,UAAI9M,MAAJ,EAAY;AACV8L,QAAAA,OAAO,GAAG;AACRhC,UAAAA,QAAQ,EAAE;AACRE,YAAAA,OAAO,EAAE;AACP5C,cAAAA,KAAK,EAAEpH;AADA;AADD,WADF;AAMRqC,UAAAA,YAAY,EAAEN;AANN,SAAV;AAQD,OATD,MASO;AACL,cAAM,IAAIjS,KAAJ,CAAW,wDAAuDmX,UAAW,EAA7E,CAAN;AACD;;AAED7R,MAAAA,MAAM,CAACQ,KAAP,CAAa,SAAb,EAAwBI,EAAxB,EAA4B,oBAA5B,EAAkD,CAAC,sCAAD,EAAyC;AAAC8V,QAAAA;AAAD,OAAzC,CAAlD;AAEA,aAAOA,OAAP;AACD,KA1BK,CAAN;AA2BD;AAED;AACF;AACA;AACA;AACA;AACA;AACA;AACA;;;AACoB,QAAZiB,YAAY,CAAC/W,EAAD,EAAKgX,UAAL,EAAiB;AACjC,UAAMtF,UAAU,GAAG,KAAKC,YAAL,CAAkB3R,EAAlB,CAAnB;AAEA,UAAM0R,UAAU,CAACuF,iBAAX,CAA6B1H,gBAAgB,CAACyH,UAAD,CAA7C,CAAN;AACD;AAED;AACF;AACA;AACA;AACA;AACA;AACA;;;AACqB,QAAbpK,aAAa,CAAC5M,EAAD,EAAK2M,SAAL,EAAgB;AACjCvN,IAAAA,MAAM,CAACQ,KAAP,CAAa,SAAb,EAAwBI,EAAxB,EAA4B,iBAA5B,EAA+C,CAAC,aAAD,EAAgB;AAACA,MAAAA,EAAD;AAAK2M,MAAAA;AAAL,KAAhB,CAA/C;AACAvN,IAAAA,MAAM,CAACmH,IAAP,CAAY,SAAZ,EAAuBvG,EAAvB,EAA2B,gBAA3B,EAA8C,iDAAgD2M,SAAU,GAAxG;AAEA,WAAO,KAAK2I,aAAL,CAAmBtV,EAAnB,EAAuB,OAAO;AAAC2M,MAAAA;AAAD,KAAP,CAAvB,CAAP;AACD;AAED;AACF;AACA;AACA;AACA;;;AACEuK,EAAAA,uBAAuB,CAAClX,EAAD,EAAK;AAC1BZ,IAAAA,MAAM,CAACQ,KAAP,CAAa,SAAb,EAAwBI,EAAxB,EAA4B,2BAA5B,EAAyD,CAAC,aAAD,EAAgB;AAACA,MAAAA;AAAD,KAAhB,CAAzD;AACA,UAAMuK,OAAO,GAAG,KAAKiG,QAAL,CAAcxQ,EAAd,CAAhB;;AAEA,QAAIuK,OAAO,CAACE,UAAR,CAAmB0G,uBAAvB,EAAgD;AAC9C/R,MAAAA,MAAM,CAACmH,IAAP,CAAY,SAAZ,EAAuBvG,EAAvB,EAA2B,wBAA3B,EAAqD,iDAArD;AACAuK,MAAAA,OAAO,CAACE,UAAR,CAAmB0G,uBAAnB;AACD,KAHD,MAGO;AACL/R,MAAAA,MAAM,CAAC9D,KAAP,CAAa,SAAb,EAAwB0E,EAAxB,EAA4B,2BAA5B,EAA0D,kDAAiDuK,OAAO,CAACE,UAAR,CAAmBwG,UAAW,GAAzI;AACD;AACF;AAED;AACF;AACA;AACA;AACA;;;AACEkG,EAAAA,uBAAuB,CAACnX,EAAD,EAAK;AAC1BZ,IAAAA,MAAM,CAACQ,KAAP,CAAa,SAAb,EAAwBI,EAAxB,EAA4B,2BAA5B,EAAyD,CAAC,aAAD,EAAgB;AAACA,MAAAA;AAAD,KAAhB,CAAzD;AACA,UAAMuK,OAAO,GAAG,KAAKiG,QAAL,CAAcxQ,EAAd,CAAhB;;AAEA,QAAIuK,OAAO,CAACR,UAAR,CAAmBoH,uBAAvB,EAAgD;AAC9C/R,MAAAA,MAAM,CAACmH,IAAP,CAAY,SAAZ,EAAuBvG,EAAvB,EAA2B,4BAA3B,EAAyD,qDAAzD;AACAuK,MAAAA,OAAO,CAACR,UAAR,CAAmBoH,uBAAnB;AACD,KAHD,MAGO;AACL/R,MAAAA,MAAM,CAAC9D,KAAP,CAAa,SAAb,EAAwB0E,EAAxB,EAA4B,2BAA5B,EAA0D,kDAAiDuK,OAAO,CAACR,UAAR,CAAmBkH,UAAW,GAAzI;AACD;AACF;AAED;AACF;AACA;AACA;AACA;AACA;AACA;AACA;;;AACgB,QAARmG,QAAQ,CAACpX,EAAD,EAAK;AACjBZ,IAAAA,MAAM,CAACQ,KAAP,CAAa,SAAb,EAAwBI,EAAxB,EAA4B,YAA5B,EAA0C,CAAC,aAAD,EAAgB;AAACA,MAAAA;AAAD,KAAhB,CAA1C;AACA,UAAM0R,UAAU,GAAG,KAAKC,YAAL,CAAkB3R,EAAlB,CAAnB;AACA,UAAM4R,WAAW,GAAG,IAAIvY,WAAJ,EAApB;AACA,UAAM0Q,UAAU,GAAG,KAAKyG,QAAL,CAAcxQ,EAAd,EAAkB+J,UAAlB,CAA6BC,MAA7B,IACd,KAAKwG,QAAL,CAAcxQ,EAAd,EAAkBiK,kBADvB;AAEA,UAAMQ,UAAU,GAAG,KAAK+F,QAAL,CAAcxQ,EAAd,EAAkByK,UAAlB,CAA6BT,MAA7B,IACd,KAAKwG,QAAL,CAAcxQ,EAAd,EAAkBmN,kBADvB;;AAGA,QAAIpD,UAAJ,EAAgB;AACdA,MAAAA,UAAU,CAACkJ,cAAX,GAA4BU,OAA5B,CAAqCpV,KAAD,IAAWqT,WAAW,CAACyF,QAAZ,CAAqB9Y,KAArB,CAA/C;AACD;;AAED,QAAIkM,UAAJ,EAAgB;AACdA,MAAAA,UAAU,CAAC0I,cAAX,GAA4BQ,OAA5B,CAAqCpV,KAAD,IAAWqT,WAAW,CAACyF,QAAZ,CAAqB9Y,KAArB,CAA/C;AACD;;AAEDa,IAAAA,MAAM,CAACQ,KAAP,CAAa,SAAb,EAAwBI,EAAxB,EAA4B,YAA5B,EAA0C,CAAC,+BAAD,EAAkC;AAAC4R,MAAAA,WAAD;AAAc9C,MAAAA;AAAd,KAAlC,CAA1C;AACA,UAAM4C,UAAU,CAAC0F,QAAX,CAAoB;AAACxF,MAAAA,WAAD;AAAc9C,MAAAA;AAAd,KAApB,CAAN;;AAEA,QAAI,CAAC,KAAK0B,QAAL,CAAcxQ,EAAd,EAAkB+J,UAAlB,CAA6BC,MAAlC,EAA0C;AACxC5K,MAAAA,MAAM,CAACQ,KAAP,CAAa,SAAb,EAAwBI,EAAxB,EAA4B,YAA5B,EAA0C,gCAA1C;AACA,YAAM0R,UAAU,CAACsE,SAAX,EAAN;AACD;;AAED,QAAI,CAAC,KAAKxF,QAAL,CAAcxQ,EAAd,EAAkByK,UAAlB,CAA6BT,MAAlC,EAA0C;AACxC5K,MAAAA,MAAM,CAACQ,KAAP,CAAa,SAAb,EAAwBI,EAAxB,EAA4B,YAA5B,EAA0C,gCAA1C;AACA,YAAM0R,UAAU,CAACwE,SAAX,EAAN;AACD;AACF;AAED;AACF;AACA;AACA;AACA;AACA;;;AACEpM,EAAAA,UAAU,CAAC9J,EAAD,EAAK;AACbZ,IAAAA,MAAM,CAACQ,KAAP,CAAa,SAAb,EAAwBI,EAAxB,EAA4B,cAA5B,EAA4C,CAAC,aAAD,EAAgB;AAACA,MAAAA;AAAD,KAAhB,CAA5C;;AACA,QAAI,EAAEA,EAAE,IAAI,KAAKuQ,qBAAb,CAAJ,EAAyC;AACvC,YAAMmB,UAAU,GAAG,KAAKC,YAAL,CAAkB3R,EAAlB,CAAnB;AACA,YAAMsX,WAAW,GAAGvc,UAAU,CAACqG,MAAX,CAAmBmW,QAAD,IAAc;AAClD,YAAI7F,UAAU,IAAI,KAAKlB,QAAL,CAAcxQ,EAAd,CAAlB,EAAqC;AACnCZ,UAAAA,MAAM,CAACQ,KAAP,CAAa,SAAb,EAAwBI,EAAxB,EAA4B,cAA5B,EAA4C,CAAC,wBAAD,EAA2B,KAAKwQ,QAAL,CAAcxQ,EAAd,CAA3B,CAA5C;AACAuX,UAAAA,QAAQ,CAAClc,IAAT,CAAc,KAAKmV,QAAL,CAAcxQ,EAAd,CAAd;AACAuX,UAAAA,QAAQ,CAAChc,QAAT;AACD,SAJD,MAIO;AACL6D,UAAAA,MAAM,CAAC9D,KAAP,CAAa,SAAb,EAAwB0E,EAAxB,EAA4B,cAA5B,EAA6C,mCAAkCA,EAAG,GAAlF;AACAuX,UAAAA,QAAQ,CAACjc,KAAT,CAAe,IAAIxB,KAAJ,CAAW,mCAAkCkG,EAAG,GAAhD,CAAf;AACD;AACF,OATmB,CAApB;AAWA,YAAMwX,mBAAmB,GAAG/T,SAAS,CAACiO,UAAD,EAAa/D,qBAAb,CAAT,CAA6C7R,IAA7C,CAC1B0F,GAAG,CAAC,MAAMpC,MAAM,CAACQ,KAAP,CAAa,SAAb,EAAwBI,EAAxB,EAA4B,cAA5B,EAA4C,CAAC,UAAD,EAAa2N,qBAAb,EAAoC,OAApC,CAA5C,CAAP,CADuB,EAE1BnM,GAAG,CAAE+I,OAAD,IAAa;AACf,aAAKiG,QAAL,CAAcxQ,EAAd,IAAoBuK,OAApB;AACD,OAFE,CAFuB,CAA5B;AAOA,YAAMkN,2BAA2B,GAAGhU,SAAS,CAACiO,UAAD,EAAatE,iBAAb,CAAT,CAAyCtR,IAAzC,CAClC0F,GAAG,CAAC,MAAM;AACRpC,QAAAA,MAAM,CAACQ,KAAP,CAAa,SAAb,EAAwBI,EAAxB,EAA4B,cAA5B,EAA4C,CAAC,UAAD,EAAaoN,iBAAb,EAAgC,OAAhC,CAA5C;AACD,OAFE,CAD+B,EAIlC1J,MAAM,CAAEC,KAAD,IAAWkL,iBAAiB,CAAC6I,QAAlB,CAA2B/T,KAAK,CAACtC,IAAjC,CAAZ,CAJ4B,EAKlCzF,GAAG,CAAE+H,KAAD,IAAW,KAAKoP,WAAL,CAAiB/S,EAAjB,EAAqB2D,KAArB,CAAZ,CAL+B,CAApC;AAQA,YAAMgU,6BAA6B,GAAGlU,SAAS,CAACiO,UAAD,EAAarE,mBAAb,CAAT,CAA2CvR,IAA3C,CACpC0F,GAAG,CAAC,MAAM;AACRpC,QAAAA,MAAM,CAACQ,KAAP,CAAa,SAAb,EAAwBI,EAAxB,EAA4B,cAA5B,EAA4C,CAAC,UAAD,EAAaqN,mBAAb,EAAkC,OAAlC,CAA5C;AACA,aAAKwG,WAAL,CAAiB7T,EAAjB;AACD,OAHE,CADiC,CAAtC;AAOA,YAAM4X,2BAA2B,GAAGnU,SAAS,CAACiO,UAAD,EAAajE,wBAAb,CAAT,CAAgD3R,IAAhD,CAClC0F,GAAG,CAAC,MAAM;AACRpC,QAAAA,MAAM,CAACQ,KAAP,CAAa,SAAb,EAAwBI,EAAxB,EAA4B,cAA5B,EAA4C,CAAC,UAAD,EAAayN,wBAAb,EAAuC,OAAvC,CAA5C;AACA,aAAKsF,WAAL,CAAiB/S,EAAjB,EAAqB;AAACqB,UAAAA,IAAI,EAAEoM;AAAP,SAArB;AACD,OAHE,CAD+B,CAApC;AAOA,YAAMoK,kCAAkC,GAAGpU,SAAS,CAACiO,UAAD,EAAahE,uBAAb,CAAT,CACxC5R,IADwC,CAEvC0F,GAAG,CAAC,MAAM;AACRpC,QAAAA,MAAM,CAACQ,KAAP,CAAa,SAAb,EAAwBI,EAAxB,EAA4B,cAA5B,EAA4C,CAAC,UAAD,EAAa0N,uBAAb,EAAsC,OAAtC,CAA5C;AACA,aAAKqF,WAAL,CAAiB/S,EAAjB,EAAqB;AAACqB,UAAAA,IAAI,EAAEqM;AAAP,SAArB;AACD,OAHE,CAFoC,CAA3C;AAQA,YAAMoK,kCAAkC,GAAGrU,SAAS,CAACiO,UAAD,EAAanE,sBAAb,CAAT,CAA8CzR,IAA9C,CACzC0F,GAAG,CAAC,MAAM;AACRpC,QAAAA,MAAM,CAACQ,KAAP,CAAa,SAAb,EAAwBI,EAAxB,EAA4B,cAA5B,EAA4C,CAAC,UAAD,EAAauN,sBAAb,EAAqC,OAArC,CAA5C;AACA,aAAKkG,UAAL,CAAgB,KAAKjD,QAAL,CAAcxQ,EAAd,EAAkBsL,UAAlB,CAA6BtB,MAA7C;AACA,aAAKwG,QAAL,CAAcxQ,EAAd,EAAkBsL,UAAlB,CAA6BtB,MAA7B,GAAsC,IAAtC;AACD,OAJE,CADsC,CAA3C;AAQA,YAAM+N,kCAAkC,GAAGtU,SAAS,CAACiO,UAAD,EAAalE,uBAAb,CAAT,CACxC1R,IADwC,CAEvC0F,GAAG,CAAC,MAAM;AACRpC,QAAAA,MAAM,CAACQ,KAAP,CAAa,SAAb,EAAwBI,EAAxB,EAA4B,cAA5B,EAA4C,CAAC,UAAD,EAAawN,uBAAb,EAAsC,OAAtC,CAA5C;AACD,OAFE,CAFoC,CAA3C;AAOA,YAAMwK,6BAA6B,GAAGvU,SAAS,CAACiO,UAAD,EAAa9D,mBAAb,CAAT,CAA2C9R,IAA3C,CACpC0F,GAAG,CAAC,MAAM;AACRpC,QAAAA,MAAM,CAACQ,KAAP,CAAa,SAAb,EAAwBI,EAAxB,EAA4B,cAA5B,EAA4C,CAAC,UAAD,EAAa4N,mBAAb,EAAkC,OAAlC,CAA5C;AACD,OAFE,CADiC,CAAtC;AAMA,YAAMqK,iCAAiC,GAAGxU,SAAS,CAACiO,UAAD,EAAa7D,uBAAb,CAAT,CAA+C/R,IAA/C,CACxC0F,GAAG,CAAC,MAAM;AACRpC,QAAAA,MAAM,CAACQ,KAAP,CAAa,SAAb,EAAwBI,EAAxB,EAA4B,cAA5B,EAA4C,CAAC,UAAD,EAAa6N,uBAAb,EAAsC,OAAtC,CAA5C;AACD,OAFE,CADqC,CAA1C;AAMA,YAAMqK,mBAAmB,GAAGzU,SAAS,CAACiO,UAAU,IAAIA,UAAU,CAACyG,OAA1B,EAAmC7K,oBAAnC,CAAT,CACzBxR,IADyB,CAExBF,GAAG,CAAE+H,KAAD,IAAW;AACbvE,QAAAA,MAAM,CAACQ,KAAP,CAAa,SAAb,EAAwBI,EAAxB,EAA4B,cAA5B,EAA4C,CAAC,UAAD,EAAasN,oBAAb,EAAmC,OAAnC,CAA5C;AACA,cAAMtT,IAAI,GAAGuC,MAAM,CAAC6b,MAAP,CAAczU,KAAK,CAAC0U,IAApB,EAA0BvR,IAA1B,CAAgCwR,CAAD,IAAOA,CAAC,CAACC,MAAxC,CAAb;AAEA,eAAO1I,0CAA0C,CAAC7V,IAAI,IAAIA,IAAI,CAAC0M,MAAd,CAA1C,IACFqJ,CAAY,CAAC4E,UADlB;AAED,OANE,CAFqB,EASxBzK,oBAAoB,EATI,EAUxB1I,GAAG,CAAE6H,KAAD,IAAW;AACbjK,QAAAA,MAAM,CAACQ,KAAP,CAAa,SAAb,EAAwBI,EAAxB,EAA4B,cAA5B,EAA4C,CAAC,2BAAD,EAA8BqJ,KAA9B,CAA5C;AACA,aAAKmH,QAAL,CAAcxQ,EAAd,IAAoB,EAAC,GAAG,KAAKwQ,QAAL,CAAcxQ,EAAd,CAAJ;AAAuBqJ,UAAAA;AAAvB,SAApB;;AACA,YAAIA,KAAK,KAAK0G,CAAY,CAACG,MAA3B,EAAmC;AACjC;AACA,eAAKkH,QAAL,CAAcpX,EAAd,EAAkBuW,KAAlB,CAAyBjb,KAAD,IAAW;AACjC8D,YAAAA,MAAM,CAAC9D,KAAP,CAAa,SAAb,EAAwB0E,EAAxB,EAA4B,cAA5B,EAA4C,qBAA5C,EAAmE1E,KAAnE;AACD,WAFD;AAGD;AACF,OATE,CAVqB,CAA5B;AAsBA,YAAMkd,mBAAmB,GAAGC,KAAK,CAC/BjB,mBAD+B,EAE/BC,2BAF+B,EAG/BE,6BAH+B,EAI/BG,kCAJ+B,EAK/BF,2BAL+B,EAM/BC,kCAN+B,EAO/BK,mBAP+B,EAQ/BF,6BAR+B,EAS/BC,iCAT+B,EAU/BF,kCAV+B,CAAL,CAW1Bjc,IAX0B,CAWrBF,GAAG,CAAC,MAAM,KAAK4U,QAAL,CAAcxQ,EAAd,CAAP,CAXkB,CAA5B,CAnGuC;;AAgHvC,YAAM0Y,qBAAqB,GAAG5U,MAAM,CAACwT,WAAD,EAAckB,mBAAd,CAApC,CAhHuC;;AAmHvC,WAAKjI,qBAAL,CAA2BvQ,EAA3B,IAAiC0Y,qBAAqB,CAAC5c,IAAtB,CAC/BmI,aAAa,CAAC,CAAD,CADkB,EAE/BC,QAAQ,EAFuB,EAG/ByU,SAAS,CAAEpO,OAAD,IAAaA,OAAO,CAAClB,KAAR,IAAiBkB,OAAO,CAAClB,KAAR,KAAkB0G,CAAY,CAACK,IAA9D,EAAoE,IAApE,CAHsB,EAI/B5O,GAAG,CAAC,MAAM;AACRpC,QAAAA,MAAM,CAACQ,KAAP,CAAa,SAAb,EAAwBI,EAAxB,EAA4B,cAA5B,EAA4C,CAAC,UAAD,EAAa,KAAKwQ,QAAL,CAAcxQ,EAAd,CAAb,CAA5C;AACD,OAFE,CAJ4B,CAAjC;AAQD;;AAED,WAAO,KAAKuQ,qBAAL,CAA2BvQ,EAA3B,CAAP;AACD;AAED;AACF;AACA;AACA;AACA;AACA;AACA;;AAEE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;;;AAEqB,QAAbsV,aAAa,CAACtV,EAAD,EAAK4Y,OAAL,EAAc;AAC/BxZ,IAAAA,MAAM,CAACQ,KAAP,CAAa,SAAb,EAAwBI,EAAxB,EAA4B,iBAA5B,EAA+C,CAAC,aAAD,EAAgB;AAACA,MAAAA,EAAD;AAAK4Y,MAAAA;AAAL,KAAhB,CAA/C;AACA,UAAMlH,UAAU,GAAG,KAAKC,YAAL,CAAkB3R,EAAlB,CAAnB;AACA,UAAMuK,OAAO,GAAG,KAAKiG,QAAL,CAAcxQ,EAAd,CAAhB;;AAEA,QAAI,CAAC0R,UAAD,IAAe,CAACnH,OAApB,EAA6B;AAC3B,YAAM,IAAIzQ,KAAJ,CAAW,mCAAkCkG,EAAG,GAAhD,CAAN;AACD;;AAED,UAAM8V,OAAO,GAAG,MAAM8C,OAAO,CAACrO,OAAD,EAAUmH,UAAV,CAA7B;AAEAzV,IAAAA,SAAS,CAACsO,OAAD,EAAUuL,OAAV,CAAT;AAEA1W,IAAAA,MAAM,CAACQ,KAAP,CAAa,SAAb,EAAwBI,EAAxB,EAA4B,iBAA5B,EAA+C,CAAC,sBAAD,EAAyB2N,qBAAzB,EAAgD,OAAhD,EAAyD,gBAAzD,EAA2E;AAACpD,MAAAA;AAAD,KAA3E,CAA/C;AACAmH,IAAAA,UAAU,CAACmD,IAAX,CAAgBlH,qBAAhB,EAAuCpD,OAAvC;AACD;AAED;AACF;AACA;AACA;AACA;;;AACEsO,EAAAA,iBAAiB,GAAG;AAClB,WAAOtc,MAAM,CAACqK,IAAP,CAAY,KAAK6J,eAAjB,CAAP;AACD;AAED;AACF;AACA;AACA;AACA;AACE;;;AACAqI,EAAAA,cAAc,GAAG;AACf,WAAOvc,MAAM,CAACqK,IAAP,CAAY2I,gBAAZ,CAAP;AACD;AAED;AACF;AACA;AACA;AACA;AACA;;;AACiC,QAAzBwJ,yBAAyB,CAAC/Y,EAAD,EAAK;AAClCZ,IAAAA,MAAM,CAACQ,KAAP,CAAa,SAAb,EAAwBI,EAAxB,EAA4B,6BAA5B,EAA2D,CAAC,aAAD,EAAgB;AAACA,MAAAA;AAAD,KAAhB,CAA3D;AACA,UAAM,KAAKsV,aAAL,CAAmBtV,EAAnB,EAAuB,aAAa;AAACuV,MAAAA,gBAAgB,EAAE;AAAnB,KAAb,CAAvB,CAAN;AACD;AAED;AACF;AACA;AACA;AACA;AACA;;;AACgC,QAAxByD,wBAAwB,CAAChZ,EAAD,EAAK;AACjCZ,IAAAA,MAAM,CAACQ,KAAP,CAAa,SAAb,EAAwBI,EAAxB,EAA4B,4BAA5B,EAA0D,CAAC,aAAD,EAAgB;AAACA,MAAAA;AAAD,KAAhB,CAA1D;AACA,UAAM,KAAKsV,aAAL,CAAmBtV,EAAnB,EAAuB,aAAa;AAACwV,MAAAA,eAAe,EAAE;AAAlB,KAAb,CAAvB,CAAN;AACD;AAED;AACF;AACA;AACA;AACA;AACA;;;AAC+B,QAAvByD,uBAAuB,CAACjZ,EAAD,EAAK;AAChC,UAAM,KAAKsV,aAAL,CAAmBtV,EAAnB,EAAuB,aAAa;AAACyV,MAAAA,cAAc,EAAE;AAAjB,KAAb,CAAvB,CAAN;AACD;;AAzvC6D;;;;;;AC5HhE,IAAI1b,QAAM,GAAGmf,eAAA,GAAiB,OAAOjf,MAAP,IAAiB,WAAjB,IAAgCA,MAAM,CAACkf,IAAP,IAAeA,IAA/C,GAC1Blf,MAD0B,GACjB,OAAOD,IAAP,IAAe,WAAf,IAA8BA,IAAI,CAACmf,IAAL,IAAaA,IAA3C,GAAkDnf,IAAlD;AAAA,EAETof,QAAQ,CAAC,aAAD,CAAR,EAHJ;AAIA,IAAI,OAAOC,GAAP,IAAc,QAAlB,EAA4BA,GAAG,GAAGtf,QAAN;;;;ACL5B,IAAIuf,MAAI,GAAGC,aAAA,GAAiB;AAAEC,EAAAA,OAAO,EAAE;AAAX,CAA5B;AACA,IAAI,OAAOC,GAAP,IAAc,QAAlB,EAA4BA,GAAG,GAAGH,MAAN;;ICD5BI,UAAc,GAAG,UAAUC,EAAV,EAAc;AAC7B,MAAI,OAAOA,EAAP,IAAa,UAAjB,EAA6B,MAAMC,SAAS,CAACD,EAAE,GAAG,qBAAN,CAAf;AAC7B,SAAOA,EAAP;AACD;;ACFD,IAAIE,SAAS,GAAGC,UAAhB;;IACAC,IAAc,GAAG,UAAUC,EAAV,EAAcC,IAAd,EAAoB9U,MAApB,EAA4B;AAC3C0U,EAAAA,SAAS,CAACG,EAAD,CAAT;AACA,MAAIC,IAAI,KAAKje,SAAb,EAAwB,OAAOge,EAAP;;AACxB,UAAQ7U,MAAR;AACE,SAAK,CAAL;AAAQ,aAAO,UAAUlD,CAAV,EAAa;AAC1B,eAAO+X,EAAE,CAACE,IAAH,CAAQD,IAAR,EAAchY,CAAd,CAAP;AACD,OAFO;;AAGR,SAAK,CAAL;AAAQ,aAAO,UAAUA,CAAV,EAAaC,CAAb,EAAgB;AAC7B,eAAO8X,EAAE,CAACE,IAAH,CAAQD,IAAR,EAAchY,CAAd,EAAiBC,CAAjB,CAAP;AACD,OAFO;;AAGR,SAAK,CAAL;AAAQ,aAAO,UAAUD,CAAV,EAAaC,CAAb,EAAgBiY,CAAhB,EAAmB;AAChC,eAAOH,EAAE,CAACE,IAAH,CAAQD,IAAR,EAAchY,CAAd,EAAiBC,CAAjB,EAAoBiY,CAApB,CAAP;AACD,OAFO;AAPV;;AAWA,SAAO;;AAAA,KAAyB;AAC9B,WAAOH,EAAE,CAACI,KAAH,CAASH,IAAT,EAAeI,SAAf,CAAP;AACD,GAFD;AAGD;;;;ICnBDC,SAAc,GAAG,UAAUX,EAAV,EAAc;AAC7B,SAAO,OAAOA,EAAP,KAAc,QAAd,GAAyBA,EAAE,KAAK,IAAhC,GAAuC,OAAOA,EAAP,KAAc,UAA5D;AACD;;ACFD,IAAIY,UAAQ,GAAGT,SAAf;;IACAU,SAAc,GAAG,UAAUb,EAAV,EAAc;AAC7B,MAAI,CAACY,UAAQ,CAACZ,EAAD,CAAb,EAAmB,MAAMC,SAAS,CAACD,EAAE,GAAG,oBAAN,CAAf;AACnB,SAAOA,EAAP;AACD;;ICJDc,MAAc,GAAG,UAAUC,IAAV,EAAgB;AAC/B,MAAI;AACF,WAAO,CAAC,CAACA,IAAI,EAAb;AACD,GAFD,CAEE,OAAOC,CAAP,EAAU;AACV,WAAO,IAAP;AACD;AACF;;ICLDC,YAAc,GAAG,CAACd,MAAmB,CAAC,YAAY;AAChD,SAAOvd,MAAM,CAACse,cAAP,CAAsB,EAAtB,EAA0B,GAA1B,EAA+B;AAAE/a,IAAAA,GAAG,EAAE,YAAY;AAAE,aAAO,CAAP;AAAW;AAAhC,GAA/B,EAAmEmC,CAAnE,IAAwE,CAA/E;AACD,CAFoC;;ACDrC,IAAIsY,UAAQ,GAAGT,SAAf;AACA,IAAItc,UAAQ,GAAGsd,eAAoB,CAACtd,QAApC;;AAEA,IAAIud,EAAE,GAAGR,UAAQ,CAAC/c,UAAD,CAAR,IAAsB+c,UAAQ,CAAC/c,UAAQ,CAACC,aAAV,CAAvC;;IACAud,UAAc,GAAG,UAAUrB,EAAV,EAAc;AAC7B,SAAOoB,EAAE,GAAGvd,UAAQ,CAACC,aAAT,CAAuBkc,EAAvB,CAAH,GAAgC,EAAzC;AACD;;ICNDsB,aAAc,GAAG,CAACnB,YAAD,IAA8B,CAACgB,MAAmB,CAAC,YAAY;AAC9E,SAAOve,MAAM,CAACse,cAAP,CAAsBK,UAAwB,CAAC,KAAD,CAA9C,EAAuD,GAAvD,EAA4D;AAAEpb,IAAAA,GAAG,EAAE,YAAY;AAAE,aAAO,CAAP;AAAW;AAAhC,GAA5D,EAAgGmC,CAAhG,IAAqG,CAA5G;AACD,CAFkE;;ACCnE,IAAIsY,QAAQ,GAAGT,SAAf;AAEA;;IACAqB,YAAc,GAAG,UAAUxB,EAAV,EAAcyB,CAAd,EAAiB;AAChC,MAAI,CAACb,QAAQ,CAACZ,EAAD,CAAb,EAAmB,OAAOA,EAAP;AACnB,MAAIK,EAAJ,EAAQ1d,GAAR;AACA,MAAI8e,CAAC,IAAI,QAAQpB,EAAE,GAAGL,EAAE,CAAC0B,QAAhB,KAA6B,UAAlC,IAAgD,CAACd,QAAQ,CAACje,GAAG,GAAG0d,EAAE,CAACE,IAAH,CAAQP,EAAR,CAAP,CAA7D,EAAkF,OAAOrd,GAAP;AAClF,MAAI,QAAQ0d,EAAE,GAAGL,EAAE,CAAC2B,OAAhB,KAA4B,UAA5B,IAA0C,CAACf,QAAQ,CAACje,GAAG,GAAG0d,EAAE,CAACE,IAAH,CAAQP,EAAR,CAAP,CAAvD,EAA4E,OAAOrd,GAAP;AAC5E,MAAI,CAAC8e,CAAD,IAAM,QAAQpB,EAAE,GAAGL,EAAE,CAAC0B,QAAhB,KAA6B,UAAnC,IAAiD,CAACd,QAAQ,CAACje,GAAG,GAAG0d,EAAE,CAACE,IAAH,CAAQP,EAAR,CAAP,CAA9D,EAAmF,OAAOrd,GAAP;AACnF,QAAMsd,SAAS,CAAC,yCAAD,CAAf;AACD;;ACXD,IAAI2B,QAAQ,GAAGzB,SAAf;AACA,IAAI0B,cAAc,GAAGV,aAArB;AACA,IAAIW,WAAW,GAAGP,YAAlB;AACA,IAAIQ,IAAE,GAAGnf,MAAM,CAACse,cAAhB;cAEYc,YAAyB,GAAGpf,MAAM,CAACse,cAAV,GAA2B,SAASA,cAAT,CAAwBe,CAAxB,EAA2BC,CAA3B,EAA8BC,UAA9B,EAA0C;AACxGP,EAAAA,QAAQ,CAACK,CAAD,CAAR;AACAC,EAAAA,CAAC,GAAGJ,WAAW,CAACI,CAAD,EAAI,IAAJ,CAAf;AACAN,EAAAA,QAAQ,CAACO,UAAD,CAAR;AACA,MAAIN,cAAJ,EAAoB,IAAI;AACtB,WAAOE,IAAE,CAACE,CAAD,EAAIC,CAAJ,EAAOC,UAAP,CAAT;AACD,GAFmB,CAElB,OAAOnB,CAAP,EAAU;;AAAe;AAC3B,MAAI,SAASmB,UAAT,IAAuB,SAASA,UAApC,EAAgD,MAAMlC,SAAS,CAAC,0BAAD,CAAf;AAChD,MAAI,WAAWkC,UAAf,EAA2BF,CAAC,CAACC,CAAD,CAAD,GAAOC,UAAU,CAAC1gB,KAAlB;AAC3B,SAAOwgB,CAAP;AACD;;ICfDG,aAAc,GAAG,UAAUC,MAAV,EAAkB5gB,KAAlB,EAAyB;AACxC,SAAO;AACL6gB,IAAAA,UAAU,EAAE,EAAED,MAAM,GAAG,CAAX,CADP;AAELE,IAAAA,YAAY,EAAE,EAAEF,MAAM,GAAG,CAAX,CAFT;AAGLG,IAAAA,QAAQ,EAAE,EAAEH,MAAM,GAAG,CAAX,CAHL;AAIL5gB,IAAAA,KAAK,EAAEA;AAJF,GAAP;AAMD;;ACPD,IAAIsgB,EAAE,GAAG5B,SAAT;AACA,IAAIsC,UAAU,GAAGtB,aAAjB;;IACAuB,KAAc,GAAGnB,YAAyB,GAAG,UAAU/U,MAAV,EAAkB9J,GAAlB,EAAuBjB,KAAvB,EAA8B;AACzE,SAAOsgB,EAAE,CAACY,CAAH,CAAKnW,MAAL,EAAa9J,GAAb,EAAkB+f,UAAU,CAAC,CAAD,EAAIhhB,KAAJ,CAA5B,CAAP;AACD,CAFyC,GAEtC,UAAU+K,MAAV,EAAkB9J,GAAlB,EAAuBjB,KAAvB,EAA8B;AAChC+K,EAAAA,MAAM,CAAC9J,GAAD,CAAN,GAAcjB,KAAd;AACA,SAAO+K,MAAP;AACD;;ACPD,IAAIoW,cAAc,GAAG,GAAGA,cAAxB;;IACAC,IAAc,GAAG,UAAU7C,EAAV,EAActd,GAAd,EAAmB;AAClC,SAAOkgB,cAAc,CAACrC,IAAf,CAAoBP,EAApB,EAAwBtd,GAAxB,CAAP;AACD;;ACHD,IAAItC,QAAM,GAAG+f,eAAb;AACA,IAAIR,IAAI,GAAGwB,aAAX;AACA,IAAI2B,GAAG,GAAGvB,IAAV;AACA,IAAIwB,IAAI,GAAGf,KAAX;AACA,IAAIve,GAAG,GAAGuf,IAAV;AACA,IAAIC,SAAS,GAAG,WAAhB;;AAEA,IAAIC,SAAO,GAAG,UAAUxb,IAAV,EAAgBoR,IAAhB,EAAsB3X,MAAtB,EAA8B;AAC1C,MAAIgiB,SAAS,GAAGzb,IAAI,GAAGwb,SAAO,CAACE,CAA/B;AACA,MAAIC,SAAS,GAAG3b,IAAI,GAAGwb,SAAO,CAACI,CAA/B;AACA,MAAIC,SAAS,GAAG7b,IAAI,GAAGwb,SAAO,CAACzB,CAA/B;AACA,MAAI+B,QAAQ,GAAG9b,IAAI,GAAGwb,SAAO,CAAChB,CAA9B;AACA,MAAIuB,OAAO,GAAG/b,IAAI,GAAGwb,SAAO,CAACQ,CAA7B;AACA,MAAIC,OAAO,GAAGjc,IAAI,GAAGwb,SAAO,CAACU,CAA7B;AACA,MAAIC,OAAO,GAAGR,SAAS,GAAG1D,IAAH,GAAUA,IAAI,CAAC7G,IAAD,CAAJ,KAAe6G,IAAI,CAAC7G,IAAD,CAAJ,GAAa,EAA5B,CAAjC;AACA,MAAIgL,QAAQ,GAAGD,OAAO,CAACZ,SAAD,CAAtB;AACA,MAAI1W,MAAM,GAAG8W,SAAS,GAAGjjB,QAAH,GAAYmjB,SAAS,GAAGnjB,QAAM,CAAC0Y,IAAD,CAAT,GAAkB,CAAC1Y,QAAM,CAAC0Y,IAAD,CAAN,IAAgB,EAAjB,EAAqBmK,SAArB,CAA7D;AACA,MAAIvgB,GAAJ,EAASqhB,GAAT,EAAcC,GAAd;AACA,MAAIX,SAAJ,EAAeliB,MAAM,GAAG2X,IAAT;;AACf,OAAKpW,GAAL,IAAYvB,MAAZ,EAAoB;;AAElB4iB,IAAAA,GAAG,GAAG,CAACZ,SAAD,IAAc5W,MAAd,IAAwBA,MAAM,CAAC7J,GAAD,CAAN,KAAgBL,SAA9C;AACA,QAAI0hB,GAAG,IAAItgB,GAAG,CAACogB,OAAD,EAAUnhB,GAAV,CAAd,EAA8B,SAHZ;;AAKlBshB,IAAAA,GAAG,GAAGD,GAAG,GAAGxX,MAAM,CAAC7J,GAAD,CAAT,GAAiBvB,MAAM,CAACuB,GAAD,CAAhC,CALkB;;AAOlBmhB,IAAAA,OAAO,CAACnhB,GAAD,CAAP,GAAe2gB,SAAS,IAAI,OAAO9W,MAAM,CAAC7J,GAAD,CAAb,IAAsB,UAAnC,GAAgDvB,MAAM,CAACuB,GAAD,CAAtD;AAAA,MAEb+gB,OAAO,IAAIM,GAAX,GAAiBjB,GAAG,CAACkB,GAAD,EAAM5jB,QAAN,CAApB;AAAA,MAEAujB,OAAO,IAAIpX,MAAM,CAAC7J,GAAD,CAAN,IAAeshB,GAA1B,GAAiC,UAAUC,CAAV,EAAa;AAC9C,UAAIb,CAAC,GAAG,UAAU9a,CAAV,EAAaC,CAAb,EAAgBiY,CAAhB,EAAmB;AACzB,YAAI,gBAAgByD,CAApB,EAAuB;AACrB,kBAAQvD,SAAS,CAAClV,MAAlB;AACE,iBAAK,CAAL;AAAQ,qBAAO,IAAIyY,CAAJ,EAAP;;AACR,iBAAK,CAAL;AAAQ,qBAAO,IAAIA,CAAJ,CAAM3b,CAAN,CAAP;;AACR,iBAAK,CAAL;AAAQ,qBAAO,IAAI2b,CAAJ,CAAM3b,CAAN,EAASC,CAAT,CAAP;AAHV;;AAIE,iBAAO,IAAI0b,CAAJ,CAAM3b,CAAN,EAASC,CAAT,EAAYiY,CAAZ,CAAP;AACH;;AAAC,eAAOyD,CAAC,CAACxD,KAAF,CAAQ,IAAR,EAAcC,SAAd,CAAP;AACH,OARD;;AASA0C,MAAAA,CAAC,CAACH,SAAD,CAAD,GAAegB,CAAC,CAAChB,SAAD,CAAhB;AACA,aAAOG,CAAP,CAX8C;AAa/C,KAbiC,CAa/BY,GAb+B,CAAhC,GAaQR,QAAQ,IAAI,OAAOQ,GAAP,IAAc,UAA1B,GAAuClB,GAAG,CAACrD,QAAQ,CAACc,IAAV,EAAgByD,GAAhB,CAA1C,GAAiEA,GAjB3E,CAPkB;;AA0BlB,QAAIR,QAAJ,EAAc;AACZ,OAACK,OAAO,CAACK,OAAR,KAAoBL,OAAO,CAACK,OAAR,GAAkB,EAAtC,CAAD,EAA4CxhB,GAA5C,IAAmDshB,GAAnD,CADY;;AAGZ,UAAItc,IAAI,GAAGwb,SAAO,CAACiB,CAAf,IAAoBL,QAApB,IAAgC,CAACA,QAAQ,CAACphB,GAAD,CAA7C,EAAoDqgB,IAAI,CAACe,QAAD,EAAWphB,GAAX,EAAgBshB,GAAhB,CAAJ;AACrD;AACF;AACF,CA5CD;;;AA8CAd,SAAO,CAACE,CAAR,GAAY,CAAZ;;AACAF,SAAO,CAACI,CAAR,GAAY,CAAZ;;AACAJ,SAAO,CAACzB,CAAR,GAAY,CAAZ;;AACAyB,SAAO,CAAChB,CAAR,GAAY,CAAZ;;AACAgB,SAAO,CAACQ,CAAR,GAAY,EAAZ;;AACAR,SAAO,CAACU,CAAR,GAAY,EAAZ;;AACAV,SAAO,CAACkB,CAAR,GAAY,EAAZ;;AACAlB,SAAO,CAACiB,CAAR,GAAY,GAAZ;;IACAE,OAAc,GAAGnB;;AC7DjB,IAAIA,OAAO,GAAG/C,OAAd;;AAEA+C,OAAO,CAACA,OAAO,CAACzB,CAAR,GAAYyB,OAAO,CAACE,CAAR,GAAY,CAACjC,YAA1B,EAAqD,QAArD,EAA+D;AAAED,EAAAA,cAAc,EAAEK,SAAuB,CAACoB;AAA1C,CAA/D,CAAP;;ACDA,IAAI2B,OAAO,GAAGnE,aAA8B,CAACvd,MAA7C;;IACAse,gBAAc,GAAG,SAASA,cAAT,CAAwBlB,EAAxB,EAA4Btd,GAA5B,EAAiC6hB,IAAjC,EAAuC;AACtD,SAAOD,OAAO,CAACpD,cAAR,CAAuBlB,EAAvB,EAA2Btd,GAA3B,EAAgC6hB,IAAhC,CAAP;AACD;;ICJDrD,cAAc,GAAGf;;;;;;;;;;;eCAL;;AAERqE,MAAAA;;;;;;;;;;;AAWEC,QAAAA;AACAC,QAAAA,MAAM;AACNC,QAAAA,GAAAA;;;;AAIAC,QAAAA,IAAAA;AACAC,QAAAA,MAAAA;AACAC,QAAAA,IAAAA,EAAM;;;;;AAKNC,QAAAA;AACAC,QAAAA,MAAAA;;;;;;;;;;;;;;AAcAC,MAAAA,MAAAA;;;;;;AAMAC,QAAAA,OAAO;;;;;;;;;;;;;;;;;;;;;AAqBXC,IAAAA;;;;;;;;;;;;;;;;;;ACxCF,MAAMC,UAAQ,GAAG,CAAC,iBAAD,EAAqB,GAAEtM,IAAK,IAAG+G,OAAQ,EAAvC,CAAjB;;AAGA,MAAMwF,eAAe,GAAG,IAAxB;;AAGA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AACA,SAASC,kBAAT,CAA4B9G,OAA5B,EAAqC;AACnC/Y,EAAAA,MAAM,CAACQ,KAAP,CAAa,GAAGmf,UAAhB,EAA0B,sBAA1B,EAAkD,CAAC,aAAD,EAAgB;AAAC5G,IAAAA;AAAD,GAAhB,CAAlD;AAEA,SAAOA,OAAO,CAACnW,IAAR,CAAa,CAACkd,OAAD,EAAUC,OAAV;AAClB;AACAD,EAAAA,OAAO,CAAC3G,MAAR,GAAiB,CAAC,CAAlB;AAAA,IACE4G,OAAO,CAAC5G,MAAR,GAAiB,CAAC,CAAlB,GACA,CAAC2G,OAAO,CAACzM,IAAT,GAAgB,CAAC,CAAjB;AAAA,IACA,CAAC0M,OAAO,CAAC1M,IAAT,GAAgB,CAAC,CAAjB,GACAyM,OAAO,CAACzM,IAAR,CAAa2M,aAAb,CAA2BD,OAAO,CAAC1M,IAAnC,CANG,CAAP,CAHmC;;AAUjC;AACH;AAED;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACA,SAAS4M,eAAT,CAAyBC,WAAzB,EAAsCC,IAAtC,EAA4C;AAC1CngB,EAAAA,MAAM,CAACQ,KAAP,CAAa,GAAGmf,UAAhB,EAA0B,mBAA1B,EAA+C,CAAC,aAAD,EAAgB;AAACO,IAAAA,WAAD;AAAcC,IAAAA;AAAd,GAAhB,CAA/C;AAEA,SAAOD,WAAW,CAACtd,IAAZ,CAAiB,CAACwd,EAAD,EAAKC,EAAL;AACtB;AACAD,EAAAA,EAAE,CAAClf,QAAH,KAAgBif,IAAhB,GAAuB,CAAC,CAAxB;AAAA,IACEE,EAAE,CAACnf,QAAH,KAAgBif,IAAhB,GAAuB,CAAvB,GACA,CAACE,EAAE,CAACC,iBAAJ,GAAwB,CAAC,CAAzB;AAAA,IACA,CAACF,EAAE,CAACE,iBAAJ,GAAwB,CAAxB,GACAF,EAAE,CAACE,iBAAH,CAAqBN,aAArB,CAAmCK,EAAE,CAACC,iBAAtC,CANG,CAAP,CAH0C;;AAUxC;AACH;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACA,SAASC,UAAT,CAAoBC,UAApB,EAAgCrV,OAAhC,EAAyC;AACvCnL,EAAAA,MAAM,CAACQ,KAAP,CAAa,GAAGmf,UAAhB,EAA0B,cAA1B,EAA0C,CAAC,aAAD,EAAgB;AAACa,IAAAA,UAAD;AAAarV,IAAAA;AAAb,GAAhB,CAA1C;AACA,MAAI4N,OAAO,GAAG5b,MAAM,CAAC6b,MAAP,CAAcwH,UAAU,IAAI,EAA5B,CAAd;AAEAzH,EAAAA,OAAO,GAAG8G,kBAAkB,CAAC9G,OAAD,CAA5B;AAEA,SAAOA,OAAO,CAACvc,GAAR,CAAaikB,MAAD,KAAa;AAC9B7f,IAAAA,EAAE,EACA6f,MAAM,CAACC,WAAP,IACGD,MAAM,CAACC,WAAP,CAAmBlY,MADtB,IAEGmY,gBAAgB,CAACC,oBAAU,CAACC,MAAZ,EAAoBJ,MAAM,CAACC,WAAP,CAAmBlY,MAAnB,CAA0BzH,EAA9C,CAJS;AAK9BuH,IAAAA,KAAK,EACHmY,MAAM,CAACC,WAAP,IACGD,MAAM,CAACC,WAAP,CAAmBlY,MADtB,IAEGiY,MAAM,CAACC,WAAP,CAAmBlY,MAAnB,CAA0BJ,KAF7B,IAGGuY,gBAAgB,CAACC,oBAAU,CAACE,YAAZ,EAA0BL,MAAM,CAACC,WAAP,CAAmBlY,MAAnB,CAA0BJ,KAApD,CATS;AAU9B2Y,IAAAA,SAAS,EAAEN,MAAM,CAACO,WAVY;AAW9BlX,IAAAA,KAAK,EAAE2W,MAAM,CAACQ,YAXgB;AAY9BC,IAAAA,OAAO,EAAET,MAAM,CAACU,gBAZc;AAa9BC,IAAAA,IAAI,EAAE,CAAC,CAACjW,OAAO,CAACkK,WAAR,CAAoBgM,gBAAtB,IAA0CZ,MAAM,CAACa,WAbzB;AAc9BC,IAAAA,KAAK,EAAEd,MAAM,CAACe;AAdgB,GAAb,CAAZ,CAAP;AAgBD;AAED;AACA;AACA;AACA;AACA;AACA;;;AACe,MAAMC,qBAAN,SAAoCC,CAApC,CAAuD;AACpErkB,EAAAA,WAAW,CAAC/C,UAAD,EAAa;AACtB,UAAMA,UAAN;AAEA0F,IAAAA,MAAM,CAACQ,KAAP,CAAa,GAAGmf,UAAhB,EAA0B,eAA1B,EAA2C,sCAA3C;AAEA,SAAKgC,QAAL,GAAgB,EAAhB,CALsB;;AAMtB,SAAKte,aAAL,GAAqB,CAArB;AACD;AAED;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACEue,EAAAA,kCAAkC,GAAG;AACnC5hB,IAAAA,MAAM,CAACQ,KAAP,CAAa,GAAGmf,UAAhB,EAA0B,sCAA1B,EAAkE,QAAlE;;AACA,QAAI,KAAKtc,aAAL,KAAuB,CAA3B,EAA8B;AAC5B;AACA,WAAK/I,UAAL,CAAgB4lB,WAAhB,CAA4Bnc,MAA5B;AACD;;AACD,SAAKV,aAAL,IAAsB,CAAtB;AACD;AAED;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACEwe,EAAAA,iCAAiC,GAAG;AAClC7hB,IAAAA,MAAM,CAACQ,KAAP,CAAa,GAAGmf,UAAhB,EAA0B,qCAA1B,EAAiE,QAAjE;AACA,SAAKtc,aAAL,IAAsB,CAAtB;;AAEA,QAAI,KAAKA,aAAL,IAAsB,CAA1B,EAA6B;AAC3B;AACA,WAAK/I,UAAL,CAAgB4lB,WAAhB,CAA4Bjc,aAA5B;AACD;AACF;AAED;AACF;AACA;AACA;AACA;AACA;AACA;;;AACE6d,EAAAA,cAAc,CAACzgB,MAAD,EAAS;AACrBrB,IAAAA,MAAM,CAACQ,KAAP,CAAa,YAAb,EAA4B,QAAOa,MAAO,EAA1C,EAA6C,kBAA7C,EAAiE,CAAC,aAAD,EAAgB;AAACA,MAAAA;AAAD,KAAhB,CAAjE;AACA,SAAKugB,kCAAL;;AAEA,UAAMG,kBAAkB,GAAIC,UAAD,KAAiB;AAC1CphB,MAAAA,EAAE,EAAEsE,kBAAkB,CAAC8c,UAAU,CAAC9gB,QAAZ,CAAlB,CAAwCH,EADF;AAE1CuH,MAAAA,KAAK,EAAEpD,kBAAkB,CAAC8c,UAAU,CAACC,WAAZ,CAAlB,CAA2ClhB,EAFR;AAG1C+I,MAAAA,KAAK,EAAE,IAHmC;AAI1CoX,MAAAA,OAAO,EAAE,IAJiC;AAK1CH,MAAAA,SAAS,EAAE,IAL+B;AAM1CK,MAAAA,IAAI,EAAE,IANoC;AAO1CG,MAAAA,KAAK,EAAE;AAPmC,KAAjB,CAA3B;;AAUA,UAAMW,GAAG,GAAGpgB,IAAI,CAAC,KAAKxH,UAAL,CAAgB+N,MAAhB,CAAuB3H,GAAvB,CAA2B,IAA3B,CAAD,CAAhB;AAEA,UAAMyhB,YAAY,GAAGrhB,KAAK,CAAC,MAAM,KAAKxG,UAAL,CAAgB4lB,WAAhB,CAA4B7a,IAA5B,CAAiC;AAChErE,MAAAA,MAAM,EAAEK,MADwD;AAEhE+gB,MAAAA,GAAG,EAAExC;AAF2D,KAAjC,CAAP,CAAL,CAGjBljB,IAHiB,CAInBF,GAAG,CAAE6lB,IAAD,IAAUA,IAAI,CAACnN,KAAhB,CAJgB,CAArB;AAOA,UAAMyM,QAAQ,GAAGplB,aAAa,CAAC,CAAC2lB,GAAD,EAAMC,YAAN,CAAD,CAAb,CAAmCzlB,IAAnC,CACfF,GAAG,CAAC;AAAA,UAAC,CAAC8lB,EAAD,EAAKpC,WAAL,CAAD;AAAA,aAAuBD,eAAe,CAACC,WAAD,EAAcoC,EAAE,CAACvhB,EAAjB,CAAf,CAAoCvE,GAApC,CAAwCulB,kBAAxC,CAAvB;AAAA,KAAD,CADY,CAAjB;AAIA,UAAMQ,aAAa,GAAGle,SAAS,CAC7B,KAAK/J,UAAL,CAAgB4lB,WADa,EAE7BsC,SAAS,CAACC,QAAV,CAAmBC,UAAnB,CAA8BpD,OAFD,CAAT,CAGpB5iB,IAHoB,CAIpB0F,GAAG,CAAC,MAAM;AACRpC,MAAAA,MAAM,CAACQ,KAAP,CAAa,YAAb,EAA4B,QAAOa,MAAO,EAA1C,EAA6C,kBAA7C,EAAiE,CAAC,UAAD,EAAamhB,SAAS,CAACC,QAAV,CAAmBC,UAAnB,CAA8BpD,OAA3C,EAAoD,OAApD,CAAjE;AACD,KAFE,CAJiB,CAAtB;AASA,UAAMqD,aAAa,GAAGte,SAAS,CAC7B,KAAK/J,UAAL,CAAgB4lB,WADa,EAE7BsC,SAAS,CAACC,QAAV,CAAmBC,UAAnB,CAA8BnD,OAFD,CAA/B;AAKA,UAAMqD,MAAM,GAAGvJ,KAAK,CAACkJ,aAAD,EAAgBI,aAAhB,CAAL,CACZjmB,IADY,CAEX4H,MAAM,CAAEC,KAAD,IAAWA,KAAK,CAAChH,IAAN,CAAWyD,MAAX,KAAsBK,MAAlC,CAFK,EAGXwhB,QAAQ,CAAC,MAAMlB,QAAP,CAHG,CAAf;AAMA,WAAOjd,MAAM,CAACid,QAAD,EAAWiB,MAAX,CAAN,CAAyBlmB,IAAzB,CACLmI,aAAa,CAAC,CAAD,CADR,EAELC,QAAQ,EAFH,EAGL1C,GAAG,CAAE2W,OAAD,IAAa;AACf/Y,MAAAA,MAAM,CAACQ,KAAP,CAAa,YAAb,EAA4B,QAAOa,MAAO,EAA1C,EAA6C,kBAA7C,EAAiE,CAAC,4BAAD,EAA+B0X,OAA/B,CAAjE;AACD,KAFE,CAHE,EAMLnU,QAAQ,CAAC,MAAM;AACb,WAAKid,iCAAL;AACD,KAFO,CANH,CAAP;AAUD;AAED;AACF;AACA;AACA;AACA;AACA;AACA;;;AACEiB,EAAAA,iBAAiB,CAACrZ,SAAD,EAAY;AAC3BzJ,IAAAA,MAAM,CAACQ,KAAP,CAAa,YAAb,EAA4B,WAAUiJ,SAAU,EAAhD,EAAmD,qBAAnD,EAA0E,CAAC,aAAD,EAAgB;AAACA,MAAAA;AAAD,KAAhB,CAA1E;AACA,UAAM0B,OAAO,GAAG,KAAK7Q,UAAL,CAAgB8W,QAAhB,CAAyBsE,gBAAzB,CAA0C,IAA1C,EAAgDjM,SAAhD,CAAhB;AACA,QAAIkY,QAAJ;;AAEA,QAAI,CAACxW,OAAL,EAAc;AACZwW,MAAAA,QAAQ,GAAGrb,UAAU,CAAC,IAAI5L,KAAJ,CAAW,WAAU+O,SAAU,aAA/B,CAAD,CAArB;AACD,KAFD,MAEO;AACL,YAAMsP,OAAO,GAAG5N,OAAO,CAAC4N,OAAR,IACX5N,OAAO,CAAC4N,OAAR,CAAgBgK,iBADL,IAEX5X,OAAO,CAAC4N,OAAR,CAAgBgK,iBAAhB,CAAkChK,OAFvC,CADK;AAML;;AACA4I,MAAAA,QAAQ,GAAG,IAAIlb,eAAJ,CAAoB8Z,UAAU,CAACxH,OAAD,EAAU5N,OAAV,CAA9B,CAAX,CAPK;;AAULA,MAAAA,OAAO,CAAC4N,OAAR,CAAgBpS,EAAhB,CAAmB,gBAAnB,EAAsCqc,OAAD,IAAa;AAChDhjB,QAAAA,MAAM,CAACQ,KAAP,CAAa,GAAGmf,UAAhB,EAA0B,qBAA1B,EAAiD,CAAC,iCAAD,EAAoC;AAACqD,UAAAA;AAAD,SAApC,CAAjD;;AACA,YAAIA,OAAO,IAAIA,OAAO,CAAC/J,IAAvB,EAA6B;AAC3B0I,UAAAA,QAAQ,CAAC1lB,IAAT,CAAcskB,UAAU,CAACyC,OAAO,CAAC/J,IAAT,EAAe9N,OAAf,CAAxB;AACD;AACF,OALD;AAMD;;AAED,WAAOwW,QAAQ,CAACjlB,IAAT,CACL0F,GAAG,CAAE2W,OAAD,IAAa;AACf/Y,MAAAA,MAAM,CAACQ,KAAP,CAAa,YAAb,EAA4B,WAAUiJ,SAAU,EAAhD,EAAmD,qBAAnD,EAA0E,CAAC,4BAAD,EAA+BsP,OAA/B,CAA1E;AACD,KAFE,CADE,CAAP;AAKD;AAED;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACEkK,EAAAA,yBAAyB,CAACC,aAAD,EAAgBC,eAAhB,EAAiC;AACxDnjB,IAAAA,MAAM,CAACQ,KAAP,CAAa,YAAb,EAA4B,GAAE2iB,eAAgB,IAAGD,aAAc,EAA/D,EAAkE,6BAAlE,EAAiG,CAAC,aAAD,EAAgB;AAACA,MAAAA,aAAD;AAAgBC,MAAAA;AAAhB,KAAhB,CAAjG;AACA,UAAMC,YAAY,GAAI,GAAED,eAAgB,IAAGD,aAAc,EAAzD;AACA,QAAIvB,QAAQ,GAAG,KAAKA,QAAL,CAAcyB,YAAd,CAAf;;AAEA,QAAI,CAACzB,QAAL,EAAe;AACb,cAAQwB,eAAR;AACE,aAAKE,CAAe,CAACC,IAArB;AACE3B,UAAAA,QAAQ,GAAG,KAAKG,cAAL,CAAoBoB,aAApB,CAAX;AACA;;AACF,aAAKG,CAAe,CAACE,OAArB;AACE5B,UAAAA,QAAQ,GAAG,KAAKmB,iBAAL,CAAuBI,aAAvB,CAAX;AACA;;AACF;AACEvB,UAAAA,QAAQ,GAAGrb,UAAU,CAAC,IAAI5L,KAAJ,CAAW,iCAAgCyoB,eAAgB,8BAA3D,CAAD,CAArB;AARJ,OADa;;;AAab,WAAKxB,QAAL,CAAcyB,YAAd,IAA8BzB,QAA9B;AACD;;AAED,WAAOA,QAAP;AACD;;AAvLmE;;ACvHtE;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AACe,MAAM6B,uBAAN,SAAsCC,CAAtC,CAA2D;AACxEpmB,EAAAA,WAAW,CAAC/C,UAAD,EAAa;AACtB,UAAMA,UAAN;AAEA,SAAKopB,uBAAL,GAA+B,EAA/B;AACD;AAED;AACF;AACA;AACA;AACA;AACA;AACA;AACA;;;AACEC,EAAAA,iBAAiB,CAACrb,KAAD,EAAQ;AACvBtI,IAAAA,MAAM,CAACQ,KAAP,CAAa,cAAb,EAA6B8H,KAA7B,EAAoC,qBAApC,EAA2D,CAAC,aAAD,EAAgB;AAACA,MAAAA;AAAD,KAAhB,CAA3D;AAEA,WAAO,KAAKhO,UAAL,CAAgBspB,OAAhB,CAAwB;AAC7BC,MAAAA,OAAO,EAAE,OADoB;AAE7BC,MAAAA,QAAQ,EAAG,iBAAgBxb,KAAM;AAFJ,KAAxB,EAGJyb,IAHI,CAGEC,GAAD,IAASA,GAAG,CAACC,IAHd,CAAP;AAID;AAED;AACF;AACA;AACA;AACA;AACA;;;AACEC,EAAAA,MAAM,CAACtjB,EAAD,EAAK;AACTZ,IAAAA,MAAM,CAACQ,KAAP,CAAa,cAAb,EAA6BI,EAA7B,EAAiC,UAAjC,EAA6C,CAAC,aAAD,EAAgB;AAACA,MAAAA;AAAD,KAAhB,CAA7C;;AAEA,QAAI,EAAEA,EAAE,IAAI,KAAK8iB,uBAAb,CAAJ,EAA2C;AACzC;AACA,WAAKA,uBAAL,CAA6B9iB,EAA7B,IAAmC,IAAIC,aAAJ,CAAkB,CAAlB,CAAnC;AAEAC,MAAAA,KAAK,CAAC,MAAM,KAAK6iB,iBAAL,CAAuB/iB,EAAvB,CAAP,CAAL,CAAwClE,IAAxC,CACEF,GAAG,CAAE2nB,QAAD,KAAe;AACjBvjB,QAAAA,EAAE,EAAEujB,QAAQ,CAACpjB,EADI;AAEjBsS,QAAAA,IAAI,EAAE8Q,QAAQ,CAACnc;AAFE,OAAf,CAAD,CADL,EAKEjM,SALF,CAMGqoB,YAAD,IAAkB;AAChBpkB,QAAAA,MAAM,CAACQ,KAAP,CAAa,cAAb,EAA6BI,EAA7B,EAAiC,UAAjC,EAA6C,CAAC,8BAAD,EAAiCwjB,YAAjC,CAA7C;AACA,aAAKV,uBAAL,CAA6B9iB,EAA7B,EAAiC3E,IAAjC,CAAsCmoB,YAAtC;AACD,OATH,EAUGloB,KAAD,IAAW;AACT8D,QAAAA,MAAM,CAAC9D,KAAP,CAAa,cAAb,EAA6B0E,EAA7B,EAAiC,UAAjC,EAA6C,6BAA7C,EAA4E1E,KAA5E;AACA,aAAKwnB,uBAAL,CAA6B9iB,EAA7B,EAAiC1E,KAAjC,CAAuC,IAAIxB,KAAJ,CAAW,sCAAqCkG,EAAG,GAAnD,CAAvC;AACD,OAbH;AAeD;;AAED,WAAO,KAAK8iB,uBAAL,CAA6B9iB,EAA7B,CAAP;AACD;;AAvDuE;;ACT1E,MAAM+e,QAAQ,GAAG,CAAC,KAAD,EAAS,GAAEtM,IAAK,IAAG+G,OAAQ,EAA3B,CAAjB;AAEe,MAAMiK,eAAN,SAA8BjqB,CAA9B,CAA2C;AACxD;AACF;AACA;AACA;AACA;AACA;AACA;AACEiD,EAAAA,WAAW,CAACinB,GAAD,EAAM;AACf,UAAMA,GAAN;AAEAtkB,IAAAA,MAAM,CAACQ,KAAP,CAAa,GAAGmf,QAAhB,EAA0B,eAA1B,EAA2C,qCAA3C;AAEA,SAAK4E,iBAAL,GAAyB,IAAIpkB,oBAAJ,CAAyBmkB,GAAzB,CAAzB;AACA,SAAKE,aAAL,GAAqB,IAAI7c,gBAAJ,CAAqB2c,GAArB,CAArB;AACA,SAAKG,YAAL,GAAoB,IAAIxhB,eAAJ,CAAoBqhB,GAApB,CAApB;AACA,SAAKI,eAAL,GAAuB,IAAIzT,kBAAJ,CAAuBqT,GAAvB,CAAvB;AACA,SAAKK,kBAAL,GAA0B,IAAIlD,qBAAJ,CAA0B6C,GAA1B,CAA1B;AACA,SAAKM,oBAAL,GAA4B,IAAIpB,uBAAJ,CAA4Bc,GAA5B,CAA5B;AACA,SAAKA,GAAL,GAAWA,GAAX;AACD;AAED;AACF;AACA;;;AACe,QAAPhT,OAAO,GAAG;AACdtR,IAAAA,MAAM,CAACQ,KAAP,CAAa,GAAGmf,QAAhB,EAA0B,WAA1B,EAAuC,QAAvC;AACA3f,IAAAA,MAAM,CAACQ,KAAP,CAAa,GAAGmf,QAAhB,EAA0B,WAA1B,EAAuC,wCAAvC;AACA,UAAM,KAAK2E,GAAL,CAASnf,QAAT,CAAkB6N,MAAlB,CAAyBzB,QAAzB,EAAN;AACAvR,IAAAA,MAAM,CAACQ,KAAP,CAAa,GAAGmf,QAAhB,EAA0B,WAA1B,EAAuC,wCAAvC;AACA,UAAM,KAAK2E,GAAL,CAASnf,QAAT,CAAkBuB,OAAlB,CAA0B4K,OAA1B,EAAN;AACAtR,IAAAA,MAAM,CAACQ,KAAP,CAAa,GAAGmf,QAAhB,EAA0B,WAA1B,EAAuC,mCAAvC;AACA,UAAM,KAAK+E,eAAL,CAAqBpT,OAArB,EAAN;AACD;AAED;AACF;AACA;;;AACkB,QAAVG,UAAU,GAAG;AACjBzR,IAAAA,MAAM,CAACQ,KAAP,CAAa,GAAGmf,QAAhB,EAA0B,cAA1B,EAA0C,QAA1C;AACA3f,IAAAA,MAAM,CAACQ,KAAP,CAAa,GAAGmf,QAAhB,EAA0B,cAA1B,EAA0C,sCAA1C;AACA,UAAM,KAAK+E,eAAL,CAAqBjT,UAArB,EAAN;AACAzR,IAAAA,MAAM,CAACQ,KAAP,CAAa,GAAGmf,QAAhB,EAA0B,cAA1B,EAA0C,2CAA1C;AACA,UAAM,KAAK2E,GAAL,CAASnf,QAAT,CAAkBuB,OAAlB,CAA0B+K,UAA1B,EAAN;AACAzR,IAAAA,MAAM,CAACQ,KAAP,CAAa,GAAGmf,QAAhB,EAA0B,cAA1B,EAA0C,sCAA1C;AACA,UAAM,KAAK2E,GAAL,CAASnf,QAAT,CAAkB6N,MAAlB,CAAyBtB,UAAzB,EAAN;AACD;;AA9CuD;;;;"}